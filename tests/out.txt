time="2022-05-11T13:07:35-04:00" level=info msg="Running command oc new-project istio-system"
time="2022-05-11T13:07:35-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply429954120.yaml"
time="2022-05-11T13:07:39-04:00" level=info msg="Command output: \nI0511 13:07:37.456245   11998 request.go:655] Throttling request took 1.151737137s, request: GET:https://api.openupi.noiro.local:6443/apis/metal3.io/v1alpha1?timeout=32s\nservicemeshcontrolplane.maistra.io/istio-system unchanged"
time="2022-05-11T13:07:39-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply203499271.yaml"
time="2022-05-11T13:07:39-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default unchanged"
=== RUN   A1
=== RUN   A1/smcp_test_install_2.1
time="2022-05-11T13:08:12-04:00" level=info msg="Create SMCP v2.1 in istio-system"
time="2022-05-11T13:08:12-04:00" level=info msg="Running command oc new-project istio-system"
time="2022-05-11T13:08:12-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply286732474.yaml"
time="2022-05-11T13:08:13-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system unchanged"
time="2022-05-11T13:08:13-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply273888977.yaml"
time="2022-05-11T13:08:14-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default unchanged"
time="2022-05-11T13:08:14-04:00" level=info msg="Waiting for mesh installation to complete"
time="2022-05-11T13:08:14-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 300s"
time="2022-05-11T13:08:14-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T13:08:14-04:00" level=info msg="Verify SMCP status and pods"
time="2022-05-11T13:08:14-04:00" level=info msg="Running command oc get -n istio-system smcp/istio-system -o wide"
time="2022-05-11T13:08:14-04:00" level=info msg="Command output: \nNAME           READY   STATUS            PROFILES      VERSION   AGE   IMAGE REGISTRY\nistio-system   10/10   ComponentsReady   [\"default\"]   2.1.2     10h   "
time="2022-05-11T13:08:14-04:00" level=info msg="Running command oc get -n istio-system pods"
time="2022-05-11T13:08:15-04:00" level=info msg="Command output: \nNAME                                        READY   STATUS    RESTARTS   AGE\ngrafana-797bdb99db-mgwqr                    2/2     Running   0          10h\nistio-egressgateway-76888d7857-bn5x8        1/1     Running   0          8h\nistio-ingressgateway-67f766474c-69z6m       1/1     Running   0          8h\nistiod-istio-system-6f4f46cf9c-wmzjw        1/1     Running   0          8h\njaeger-6b5b565d5c-wjkqz                     2/2     Running   0          10h\nkiali-587d78487d-9qdp6                      1/1     Running   0          9h\nprometheus-565c449c44-qg7j7                 2/2     Running   0          10h\nwasm-cacher-istio-system-6fdf689cf9-7xxhr   1/1     Running   0          10h"
=== RUN   A1/smcp_test_uninstall_2.1
time="2022-05-11T13:08:15-04:00" level=info msg="Delete SMCP v2.1 in istio-system"
time="2022-05-11T13:08:15-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete838777852.yaml"
time="2022-05-11T13:08:15-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete238627115.yaml"
=== RUN   A1/smcp_test_install_2.0
time="2022-05-11T13:09:00-04:00" level=info msg="Create SMCP v2.0 in namespace istio-system"
time="2022-05-11T13:09:00-04:00" level=info msg="Running command oc new-project istio-system"
time="2022-05-11T13:09:00-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply236965518.yaml"
time="2022-05-11T13:09:01-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system created"
time="2022-05-11T13:09:01-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply339724949.yaml"
time="2022-05-11T13:09:01-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default created"
time="2022-05-11T13:09:01-04:00" level=info msg="Waiting for mesh installation to complete"
time="2022-05-11T13:09:01-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 300s"
time="2022-05-11T13:09:49-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T13:09:49-04:00" level=info msg="Verify SMCP status and pods"
time="2022-05-11T13:09:49-04:00" level=info msg="Running command oc get -n istio-system smcp/istio-system -o wide"
time="2022-05-11T13:09:49-04:00" level=info msg="Command output: \nNAME           READY   STATUS            PROFILES      VERSION   AGE   IMAGE REGISTRY\nistio-system   9/9     ComponentsReady   [\"default\"]   2.0.9     48s   "
time="2022-05-11T13:09:49-04:00" level=info msg="Running command oc get -n istio-system pods"
time="2022-05-11T13:09:49-04:00" level=info msg="Command output: \nNAME                                    READY   STATUS    RESTARTS   AGE\ngrafana-7c5fbdcd7d-pmfz8                2/2     Running   0          18s\nistio-egressgateway-5b86ccdf5f-z9n6b    1/1     Running   0          19s\nistio-ingressgateway-7795d955fd-mcmjl   1/1     Running   0          20s\nistiod-istio-system-7466cb569f-6pgsq    1/1     Running   0          47s\njaeger-75c7757c9-srsmq                  2/2     Running   0          20s\nprometheus-67cc587694-7k6bt             3/3     Running   0          35s"
=== RUN   A1/smcp_test_uninstall_2.0
time="2022-05-11T13:09:49-04:00" level=info msg="Delete SMCP v2.0 in istio-system"
time="2022-05-11T13:09:49-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete995479792.yaml"
time="2022-05-11T13:09:49-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete171419535.yaml"
=== RUN   A1/smcp_test_install_1.1
time="2022-05-11T13:10:54-04:00" level=info msg="Create SMCP v1.1 in namespace istio-system"
time="2022-05-11T13:10:54-04:00" level=info msg="Running command oc new-project istio-system"
time="2022-05-11T13:10:54-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply092558242.yaml"
time="2022-05-11T13:10:55-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system created"
time="2022-05-11T13:10:55-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply958328985.yaml"
time="2022-05-11T13:10:55-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default created"
time="2022-05-11T13:10:55-04:00" level=info msg="Waiting for mesh installation to complete"
time="2022-05-11T13:10:55-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 300s"
time="2022-05-11T13:15:56-04:00" level=info msg="Command output: \nerror: timed out waiting for the condition on servicemeshmemberrolls/default"
time="2022-05-11T13:15:56-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T13:15:56-04:00" level=info msg="Verify SMCP status and pods"
time="2022-05-11T13:15:56-04:00" level=info msg="Running command oc get -n istio-system smcp/istio-system -o wide"
time="2022-05-11T13:15:56-04:00" level=info msg="Command output: \nNAME           READY   STATUS           PROFILES      VERSION   AGE     IMAGE REGISTRY\nistio-system   8/11    PausingInstall   [\"default\"]             5m29s   "
time="2022-05-11T13:15:56-04:00" level=error msg="SMCP not Ready"
    smcp_install.go:128: SMCP not Ready
time="2022-05-11T13:15:56-04:00" level=info msg="Running command oc get -n istio-system pods"
time="2022-05-11T13:15:56-04:00" level=info msg="Command output: \nNAME                                      READY   STATUS    RESTARTS   AGE\nistio-citadel-5c869dd668-lvjd4            1/1     Running   0          4m59s\nistio-egressgateway-97fdc65-nsfw6         0/1     Running   0          4m26s\nistio-galley-6d99b55697-tfpsb             1/1     Running   0          4m41s\nistio-ingressgateway-86cfb9f68f-9h66d     0/1     Running   0          4m25s\nistio-pilot-84b6958759-z7zv2              2/2     Running   0          4m28s\nistio-policy-85cffdc568-d8bjg             2/2     Running   0          4m29s\nistio-sidecar-injector-65c697fcf4-fqqcf   1/1     Running   0          4m24s\nistio-telemetry-76c79b988b-sdpxt          2/2     Running   0          4m29s\njaeger-94cd65448-fbm6d                    2/2     Running   0          4m41s\nprometheus-76f549777f-nbccd               2/2     Running   0          4m55s"
=== RUN   A1/smcp_test_uninstall_1.1
time="2022-05-11T13:15:56-04:00" level=info msg="Delete SMCP v1,1 in istio-system"
time="2022-05-11T13:15:56-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete498026276.yaml"
time="2022-05-11T13:15:56-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete476729395.yaml"
=== RUN   A1/smcp_test_upgrade_2.0_to_2.1
time="2022-05-11T13:16:42-04:00" level=info msg="Create SMCP v2.0 in namespace istio-system"
time="2022-05-11T13:16:42-04:00" level=info msg="Running command oc new-project istio-system"
time="2022-05-11T13:16:42-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply650976758.yaml"
time="2022-05-11T13:16:43-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system created"
time="2022-05-11T13:16:43-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply687808221.yaml"
time="2022-05-11T13:16:44-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default created"
time="2022-05-11T13:16:44-04:00" level=info msg="Waiting for mesh installation to complete"
time="2022-05-11T13:16:44-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 300s"
time="2022-05-11T13:19:04-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T13:19:04-04:00" level=info msg="Verify SMCP status and pods"
time="2022-05-11T13:19:04-04:00" level=info msg="Running command oc get -n istio-system smcp/istio-system -o wide"
time="2022-05-11T13:19:08-04:00" level=info msg="Command output: \nNAME           READY   STATUS            PROFILES      VERSION   AGE     IMAGE REGISTRY\nistio-system   9/9     ComponentsReady   [\"default\"]   2.0.9     2m24s   "
time="2022-05-11T13:19:08-04:00" level=info msg="Running command oc get -n istio-system pods"
time="2022-05-11T13:19:08-04:00" level=info msg="Command output: \nNAME                                    READY   STATUS    RESTARTS   AGE\ngrafana-7c5fbdcd7d-m5bfx                2/2     Running   0          18s\nistio-egressgateway-5b86ccdf5f-2kpr4    1/1     Running   0          18s\nistio-ingressgateway-7795d955fd-lhpvx   1/1     Running   0          19s\nistiod-istio-system-7466cb569f-gjr7c    1/1     Running   0          2m24s\njaeger-657bd6b6f5-9rzcp                 2/2     Running   0          19s\nprometheus-67cc587694-vtf75             3/3     Running   0          2m14s"
time="2022-05-11T13:19:08-04:00" level=info msg="Upgrade SMCP to v2.1"
time="2022-05-11T13:19:08-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply129142424.yaml"
time="2022-05-11T13:19:09-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system configured"
time="2022-05-11T13:19:09-04:00" level=info msg="Waiting for mesh installation to complete"
time="2022-05-11T13:19:19-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 360s"
time="2022-05-11T13:19:58-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T13:19:58-04:00" level=info msg="Verify SMCP status and pods"
time="2022-05-11T13:19:58-04:00" level=info msg="Running command oc get -n istio-system smcp/istio-system -o wide"
time="2022-05-11T13:19:58-04:00" level=info msg="Command output: \nNAME           READY   STATUS            PROFILES      VERSION   AGE     IMAGE REGISTRY\nistio-system   10/10   ComponentsReady   [\"default\"]   2.1.2     3m43s   "
time="2022-05-11T13:19:58-04:00" level=info msg="Running command oc get -n istio-system pods"
time="2022-05-11T13:19:58-04:00" level=info msg="Command output: \nNAME                                        READY   STATUS        RESTARTS   AGE\ngrafana-797bdb99db-qscbz                    2/2     Running       0          48s\nistio-egressgateway-54f5696846-ngt7c        1/1     Running       0          49s\nistio-egressgateway-5b86ccdf5f-2kpr4        0/1     Terminating   0          96s\nistio-ingressgateway-56f66fff5f-p79jw       1/1     Running       0          50s\nistio-ingressgateway-7795d955fd-lhpvx       0/1     Terminating   0          97s\nistiod-istio-system-c77c8589f-kv5jr         1/1     Running       0          72s\njaeger-657bd6b6f5-9rzcp                     2/2     Running       0          97s\nprometheus-565c449c44-xrlzd                 2/2     Running       0          62s\nwasm-cacher-istio-system-6fdf689cf9-7648z   1/1     Running       0          34s"
time="2022-05-11T13:19:58-04:00" level=info msg="Create SMCP v2.1 in istio-system"
time="2022-05-11T13:19:58-04:00" level=info msg="Running command oc new-project istio-system"
time="2022-05-11T13:19:59-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply528548631.yaml"
time="2022-05-11T13:19:59-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system unchanged"
time="2022-05-11T13:19:59-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply323006858.yaml"
time="2022-05-11T13:20:00-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default unchanged"
time="2022-05-11T13:20:00-04:00" level=info msg="Waiting for mesh installation to complete"
time="2022-05-11T13:20:00-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 300s"
time="2022-05-11T13:20:01-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
--- FAIL: A1 (728.32s)
    --- PASS: A1/smcp_test_install_2.1 (2.34s)
    --- PASS: A1/smcp_test_uninstall_2.1 (45.21s)
    --- PASS: A1/smcp_test_install_2.0 (49.31s)
    --- PASS: A1/smcp_test_uninstall_2.0 (64.51s)
    --- FAIL: A1/smcp_test_install_1.1 (302.59s)
    --- PASS: A1/smcp_test_uninstall_1.1 (45.78s)
    --- PASS: A1/smcp_test_upgrade_2.0_to_2.1 (196.36s)
=== RUN   A2
time="2022-05-11T13:20:21-04:00" level=info msg="Test Bookinfo Installation"
time="2022-05-11T13:20:21-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T13:20:21-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T13:20:22-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T13:20:27-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:20:28-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-phm8p"
time="2022-05-11T13:20:28-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-phm8p"
time="2022-05-11T13:20:28-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-phm8p --no-headers"
time="2022-05-11T13:20:28-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-phm8p   0/2   ContainerCreating   0     6s"
time="2022-05-11T13:20:28-04:00" level=info msg="details-v1-6cd699df8c-phm8p in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:20:58-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:20:58-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-phm8p"
time="2022-05-11T13:20:58-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-phm8p"
time="2022-05-11T13:20:58-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-phm8p --no-headers"
time="2022-05-11T13:20:58-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-phm8p   2/2   Running   0     64s"
time="2022-05-11T13:20:58-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T13:20:58-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:20:59-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-gqzzm"
time="2022-05-11T13:20:59-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-gqzzm"
time="2022-05-11T13:20:59-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-gqzzm --no-headers"
time="2022-05-11T13:20:59-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-gqzzm   2/2   Running   0     37s"
time="2022-05-11T13:20:59-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T13:20:59-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:20:59-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-cx8cg"
time="2022-05-11T13:20:59-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-cx8cg"
time="2022-05-11T13:20:59-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-cx8cg --no-headers"
time="2022-05-11T13:21:00-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-cx8cg   2/2   Running   0     64s"
time="2022-05-11T13:21:00-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T13:21:00-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:21:00-04:00" level=info msg="Command output: \nreviews-v2-675679877f-2px95"
time="2022-05-11T13:21:00-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-2px95"
time="2022-05-11T13:21:00-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-2px95 --no-headers"
time="2022-05-11T13:21:00-04:00" level=info msg="Command output: \nreviews-v2-675679877f-2px95   2/2   Running   0     66s"
time="2022-05-11T13:21:00-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T13:21:00-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:21:00-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-qgjjj"
time="2022-05-11T13:21:00-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-qgjjj"
time="2022-05-11T13:21:00-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-qgjjj --no-headers"
time="2022-05-11T13:21:01-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-qgjjj   2/2   Running   0     66s"
time="2022-05-11T13:21:01-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T13:21:01-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:21:01-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-jkqqg"
time="2022-05-11T13:21:01-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-jkqqg"
time="2022-05-11T13:21:01-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-jkqqg --no-headers"
time="2022-05-11T13:21:01-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-jkqqg   2/2   Running   0     38s"
time="2022-05-11T13:21:01-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T13:21:01-04:00" level=info msg="Creating Gateway"
time="2022-05-11T13:21:01-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:21:02-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T13:21:02-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T13:21:02-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:21:03-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
time="2022-05-11T13:21:13-04:00" level=info msg="Check pods running 2/2 ready"
time="2022-05-11T13:21:13-04:00" level=info msg="Running command oc get pods -n bookinfo"
time="2022-05-11T13:21:13-04:00" level=info msg="Command output: \nNAME                              READY   STATUS    RESTARTS   AGE\ndetails-v1-6cd699df8c-phm8p       2/2     Running   0          51s\nproductpage-v1-5ddcb4b84f-jkqqg   2/2     Running   0          50s\nratings-v1-bdbcc68bc-gqzzm        2/2     Running   0          51s\nreviews-v1-754ddd7b6f-cx8cg       2/2     Running   0          50s\nreviews-v2-675679877f-2px95       2/2     Running   0          51s\nreviews-v3-79d7549c7-qgjjj        2/2     Running   0          51s"
time="2022-05-11T13:21:13-04:00" level=info msg="Success. proxy container is running."
time="2022-05-11T13:21:13-04:00" level=info msg="Check istiod pod is ready and print istiod logs"
time="2022-05-11T13:21:13-04:00" level=info msg="Running command oc get pods -n istio-system | grep istiod"
time="2022-05-11T13:21:13-04:00" level=info msg="Command output: \nistiod-istio-system-c77c8589f-kv5jr         1/1     Running   0          119s"
time="2022-05-11T13:21:13-04:00" level=info msg="Success. istiod pod is running with below logs:"
time="2022-05-11T13:21:13-04:00" level=info msg="Running command oc logs -n istio-system -l app=istiod | grep info"
time="2022-05-11T13:21:14-04:00" level=info msg="Command output: \n2022-05-11T17:16:17.435002Z\tinfo\tads\tEDS: PUSH for node:reviews-v3-79d7549c7-qgjjj.bookinfo resources:38 size:6.7kB empty:0 cached:38/38\n2022-05-11T17:16:17.478717Z\tinfo\tads\tEDS: PUSH for node:reviews-v2-675679877f-2px95.bookinfo resources:38 size:6.7kB empty:0 cached:38/38\n2022-05-11T17:16:23.107082Z\tinfo\tads\tPush Status: {\n        \"outbound|9080|v2-mysql-vm|ratings.bookinfo.svc.cluster.local\": {},\n        \"outbound|9080|v2-mysql|ratings.bookinfo.svc.cluster.local\": {},\n        \"outbound|9080|v2|details.bookinfo.svc.cluster.local\": {},\n        \"outbound|9080|v2|ratings.bookinfo.svc.cluster.local\": {}"
time="2022-05-11T13:21:14-04:00" level=info msg="Check if bookinfo productpage is running"
time="2022-05-11T13:21:14-04:00" level=info msg="Running command oc -n istio-system get route istio-ingressgateway -o jsonpath='{.spec.host}'"
time="2022-05-11T13:21:14-04:00" level=info msg="Command output: \nistio-ingressgateway-istio-system.apps.openupi.noiro.local"
time="2022-05-11T13:21:14-04:00" level=info msg="Running command curl -o /dev/null -s -w \"%{http_code}\\n\" http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/productpage"
time="2022-05-11T13:23:25-04:00" level=info msg="Command output: \n000"
time="2022-05-11T13:23:25-04:00" level=info msg="Command error: exit status 7"
    smoketest.go:63: Error. bookinfo productpage is not running.
time="2022-05-11T13:23:25-04:00" level=error msg="Error. bookinfo productpage is not running."
--- FAIL: A2 (184.42s)
=== RUN   T1
time="2022-05-11T13:23:25-04:00" level=info msg=TestRequestRouting
time="2022-05-11T13:23:25-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T13:23:25-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T13:23:26-04:00" level=info msg="Command output: \nservice/details unchanged\nserviceaccount/bookinfo-details unchanged\ndeployment.apps/details-v1 unchanged\nservice/ratings unchanged\nserviceaccount/bookinfo-ratings unchanged\ndeployment.apps/ratings-v1 unchanged\nservice/reviews unchanged\nserviceaccount/bookinfo-reviews unchanged\ndeployment.apps/reviews-v1 unchanged\ndeployment.apps/reviews-v2 unchanged\ndeployment.apps/reviews-v3 unchanged\nservice/productpage unchanged\nserviceaccount/bookinfo-productpage unchanged\ndeployment.apps/productpage-v1 unchanged"
time="2022-05-11T13:23:31-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:23:31-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-phm8p"
time="2022-05-11T13:23:31-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-phm8p"
time="2022-05-11T13:23:31-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-phm8p --no-headers"
time="2022-05-11T13:23:31-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-phm8p   2/2   Running   0     3m9s"
time="2022-05-11T13:23:31-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T13:23:31-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:23:32-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-gqzzm"
time="2022-05-11T13:23:32-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-gqzzm"
time="2022-05-11T13:23:32-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-gqzzm --no-headers"
time="2022-05-11T13:23:32-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-gqzzm   2/2   Running   0     3m10s"
time="2022-05-11T13:23:32-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T13:23:32-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:23:32-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-cx8cg"
time="2022-05-11T13:23:32-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-cx8cg"
time="2022-05-11T13:23:32-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-cx8cg --no-headers"
time="2022-05-11T13:23:33-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-cx8cg   2/2   Running   0     3m37s"
time="2022-05-11T13:23:33-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T13:23:33-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:23:33-04:00" level=info msg="Command output: \nreviews-v2-675679877f-2px95"
time="2022-05-11T13:23:33-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-2px95"
time="2022-05-11T13:23:33-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-2px95 --no-headers"
time="2022-05-11T13:23:33-04:00" level=info msg="Command output: \nreviews-v2-675679877f-2px95   2/2   Running   0     3m11s"
time="2022-05-11T13:23:33-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T13:23:33-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:23:33-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-qgjjj"
time="2022-05-11T13:23:33-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-qgjjj"
time="2022-05-11T13:23:33-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-qgjjj --no-headers"
time="2022-05-11T13:23:34-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-qgjjj   2/2   Running   0     3m39s"
time="2022-05-11T13:23:34-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T13:23:34-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:23:34-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-jkqqg"
time="2022-05-11T13:23:34-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-jkqqg"
time="2022-05-11T13:23:34-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-jkqqg --no-headers"
time="2022-05-11T13:23:34-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-jkqqg   2/2   Running   0     3m11s"
time="2022-05-11T13:23:34-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T13:23:34-04:00" level=info msg="Creating Gateway"
time="2022-05-11T13:23:34-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:23:35-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway unchanged\nvirtualservice.networking.istio.io/bookinfo unchanged"
time="2022-05-11T13:23:35-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T13:23:35-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:23:35-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage unchanged\ndestinationrule.networking.istio.io/reviews unchanged\ndestinationrule.networking.istio.io/ratings unchanged\ndestinationrule.networking.istio.io/details unchanged"
time="2022-05-11T13:24:15-04:00" level=error msg="failed to get login user cookiejar: failed login for user 'jason': Post \"http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/login\": dial tcp 151.9.1.21:80: i/o timeout"
=== RUN   T1/TrafficManagement_test_the_new_routing_configuration
time="2022-05-11T13:24:15-04:00" level=info msg="Routing traffic to all v1"
time="2022-05-11T13:24:15-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:24:16-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/productpage created\nvirtualservice.networking.istio.io/reviews created\nvirtualservice.networking.istio.io/ratings created\nvirtualservice.networking.istio.io/details created"
    common.go:37: Failed to get HTTP Response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/productpage": dial tcp 151.9.1.21:80: i/o timeout
=== RUN   T1/TrafficManagement_route_based_on_user_identity
time="2022-05-11T13:25:06-04:00" level=info msg="Traffic routing based on user identity"
time="2022-05-11T13:25:06-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-reviews-test-v2.yaml"
time="2022-05-11T13:25:07-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/reviews configured"
    common.go:37: Failed to get HTTP Response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/productpage": dial tcp 151.9.1.21:80: i/o timeout
time="2022-05-11T13:25:57-04:00" level=info msg=Cleanup
time="2022-05-11T13:25:57-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:25:58-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T13:25:58-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:25:58-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:25:58-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
--- FAIL: T1 (184.86s)
    --- FAIL: T1/TrafficManagement_test_the_new_routing_configuration (51.03s)
    --- FAIL: T1/TrafficManagement_route_based_on_user_identity (50.85s)
=== RUN   T2
time="2022-05-11T13:26:30-04:00" level=info msg=TestFaultInjection
time="2022-05-11T13:26:30-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T13:26:30-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T13:26:31-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T13:26:36-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:26:37-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-swdz5"
time="2022-05-11T13:26:37-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-swdz5"
time="2022-05-11T13:26:37-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-swdz5 --no-headers"
time="2022-05-11T13:26:37-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-swdz5   0/2   ContainerCreating   0     5s"
time="2022-05-11T13:26:37-04:00" level=info msg="details-v1-6cd699df8c-swdz5 in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:27:07-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:27:07-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-swdz5"
time="2022-05-11T13:27:07-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-swdz5"
time="2022-05-11T13:27:07-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-swdz5 --no-headers"
time="2022-05-11T13:27:07-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-swdz5   2/2   Running   0     35s"
time="2022-05-11T13:27:07-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T13:27:07-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:27:08-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-lt597"
time="2022-05-11T13:27:08-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-lt597"
time="2022-05-11T13:27:08-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-lt597 --no-headers"
time="2022-05-11T13:27:08-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-lt597   2/2   Running   0     36s"
time="2022-05-11T13:27:08-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T13:27:08-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:27:08-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-p8c4t"
time="2022-05-11T13:27:08-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-p8c4t"
time="2022-05-11T13:27:08-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-p8c4t --no-headers"
time="2022-05-11T13:27:09-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-p8c4t   2/2   Running   0     36s"
time="2022-05-11T13:27:09-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T13:27:09-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:27:09-04:00" level=info msg="Command output: \nreviews-v2-675679877f-4h75b"
time="2022-05-11T13:27:09-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-4h75b"
time="2022-05-11T13:27:09-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-4h75b --no-headers"
time="2022-05-11T13:27:09-04:00" level=info msg="Command output: \nreviews-v2-675679877f-4h75b   2/2   Running   0     65s"
time="2022-05-11T13:27:09-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T13:27:09-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:27:10-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-wqgzq"
time="2022-05-11T13:27:10-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-wqgzq"
time="2022-05-11T13:27:10-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-wqgzq --no-headers"
time="2022-05-11T13:27:10-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-wqgzq   2/2   Running   0     37s"
time="2022-05-11T13:27:10-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T13:27:10-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:27:10-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-6bs4w"
time="2022-05-11T13:27:10-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-6bs4w"
time="2022-05-11T13:27:10-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-6bs4w --no-headers"
time="2022-05-11T13:27:10-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-6bs4w   2/2   Running   0     38s"
time="2022-05-11T13:27:10-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T13:27:10-04:00" level=info msg="Creating Gateway"
time="2022-05-11T13:27:10-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:27:11-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T13:27:11-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T13:27:11-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:27:12-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
time="2022-05-11T13:27:52-04:00" level=error msg="failed to get login user cookiejar: failed login for user 'jason': Post \"http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/login\": dial tcp 151.9.1.21:80: i/o timeout"
time="2022-05-11T13:27:52-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:27:53-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/productpage created\nvirtualservice.networking.istio.io/reviews created\nvirtualservice.networking.istio.io/ratings created\nvirtualservice.networking.istio.io/details created"
time="2022-05-11T13:27:53-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-reviews-test-v2.yaml"
time="2022-05-11T13:27:54-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/reviews configured"
=== RUN   T2/TrafficManagement_injecting_an_HTTP_delay_fault
time="2022-05-11T13:27:59-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-ratings-test-delay.yaml"
time="2022-05-11T13:28:00-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/ratings configured"
time="2022-05-11T13:28:35-04:00" level=info msg="bookinfo productpage returned in 30000 ms"
    testUtil.go:62: Test panic: runtime error: invalid memory address or nil pointer dereference
=== RUN   T2/TrafficManagement_injecting_an_HTTP_abort_fault
time="2022-05-11T13:28:35-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-ratings-test-abort.yaml"
time="2022-05-11T13:28:36-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/ratings configured"
time="2022-05-11T13:29:11-04:00" level=info msg="bookinfo productpage returned in 30000 ms"
    testUtil.go:62: Test panic: runtime error: invalid memory address or nil pointer dereference
time="2022-05-11T13:29:11-04:00" level=info msg=Cleanup
time="2022-05-11T13:29:11-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:29:14-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T13:29:14-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:29:14-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:29:14-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
--- FAIL: T2 (196.05s)
    --- FAIL: T2/TrafficManagement_injecting_an_HTTP_delay_fault (35.79s)
    --- FAIL: T2/TrafficManagement_injecting_an_HTTP_abort_fault (35.82s)
=== RUN   T3
time="2022-05-11T13:29:46-04:00" level=info msg=TestTrafficShifting
time="2022-05-11T13:29:46-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T13:29:46-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T13:29:47-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T13:29:52-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:29:53-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-2xzlp"
time="2022-05-11T13:29:53-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-2xzlp"
time="2022-05-11T13:29:53-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-2xzlp --no-headers"
time="2022-05-11T13:29:53-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-2xzlp   2/2   Running   0     33s"
time="2022-05-11T13:29:53-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T13:29:53-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:29:53-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-xf57f"
time="2022-05-11T13:29:53-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-xf57f"
time="2022-05-11T13:29:53-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-xf57f --no-headers"
time="2022-05-11T13:29:54-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-xf57f   0/2   ContainerCreating   0     33s"
time="2022-05-11T13:29:54-04:00" level=info msg="ratings-v1-bdbcc68bc-xf57f in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:30:24-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:30:24-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-xf57f"
time="2022-05-11T13:30:24-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-xf57f"
time="2022-05-11T13:30:24-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-xf57f --no-headers"
time="2022-05-11T13:30:24-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-xf57f   2/2   Running   0     36s"
time="2022-05-11T13:30:24-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T13:30:24-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:30:25-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-w8xhh"
time="2022-05-11T13:30:25-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-w8xhh"
time="2022-05-11T13:30:25-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-w8xhh --no-headers"
time="2022-05-11T13:30:25-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-w8xhh   2/2   Running   0     65s"
time="2022-05-11T13:30:25-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T13:30:25-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:30:25-04:00" level=info msg="Command output: \nreviews-v2-675679877f-w4fmm"
time="2022-05-11T13:30:25-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-w4fmm"
time="2022-05-11T13:30:25-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-w4fmm --no-headers"
time="2022-05-11T13:30:25-04:00" level=info msg="Command output: \nreviews-v2-675679877f-w4fmm   2/2   Running   0     66s"
time="2022-05-11T13:30:25-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T13:30:25-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:30:26-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-skj6j"
time="2022-05-11T13:30:26-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-skj6j"
time="2022-05-11T13:30:26-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-skj6j --no-headers"
time="2022-05-11T13:30:26-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-skj6j   2/2   Running   0     39s"
time="2022-05-11T13:30:26-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T13:30:26-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:30:26-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-hg2b4"
time="2022-05-11T13:30:26-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-hg2b4"
time="2022-05-11T13:30:26-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-hg2b4 --no-headers"
time="2022-05-11T13:30:26-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-hg2b4   2/2   Running   0     38s"
time="2022-05-11T13:30:26-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T13:30:26-04:00" level=info msg="Creating Gateway"
time="2022-05-11T13:30:26-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:30:27-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T13:30:27-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T13:30:27-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:30:28-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
time="2022-05-11T13:30:38-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:30:39-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/productpage created\nvirtualservice.networking.istio.io/reviews created\nvirtualservice.networking.istio.io/ratings created\nvirtualservice.networking.istio.io/details created"
=== RUN   T3/TrafficManagement_shift_50_percent_v3_traffic
time="2022-05-11T13:30:44-04:00" level=info msg="# Traffic shifting 50 percent v1 and 50 percent v3, tolerance 10 percent"
time="2022-05-11T13:30:44-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-reviews-50-v3.yaml"
time="2022-05-11T13:30:45-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/reviews configured"
    common.go:37: Failed to get response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/productpage": dial tcp 151.9.1.21:80: i/o timeout
=== RUN   T3/TrafficManagement_shift_100_percent_v3_traffic
time="2022-05-11T13:31:20-04:00" level=info msg="# Traffic shifting 100 percent v3, tolerance 0 percent"
time="2022-05-11T13:31:20-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-reviews-v3.yaml"
time="2022-05-11T13:31:20-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/reviews configured"
    common.go:37: Failed to get response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/productpage": dial tcp 151.9.1.21:80: i/o timeout
time="2022-05-11T13:31:56-04:00" level=info msg=Cleanup
time="2022-05-11T13:31:56-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:31:57-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T13:31:57-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:31:57-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:31:57-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
--- FAIL: T3 (163.26s)
    --- FAIL: T3/TrafficManagement_shift_50_percent_v3_traffic (35.84s)
    --- FAIL: T3/TrafficManagement_shift_100_percent_v3_traffic (36.64s)
=== RUN   T4
time="2022-05-11T13:32:29-04:00" level=info msg=TestTCPShifting
time="2022-05-11T13:32:29-04:00" level=info msg="Deploy Echo"
time="2022-05-11T13:32:29-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/tcp-echo/tcp-echo-services.yaml"
time="2022-05-11T13:32:30-04:00" level=info msg="Command output: \nservice/tcp-echo created\ndeployment.apps/tcp-echo-v1 created\ndeployment.apps/tcp-echo-v2 created"
time="2022-05-11T13:32:35-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=tcp-echo,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:32:35-04:00" level=info msg="Command output: \ntcp-echo-v1-bffddfc7-27j9b"
time="2022-05-11T13:32:35-04:00" level=info msg="app=tcp-echo,version=v1 pod name: tcp-echo-v1-bffddfc7-27j9b"
time="2022-05-11T13:32:35-04:00" level=info msg="Running command kubectl -n bookinfo get pods tcp-echo-v1-bffddfc7-27j9b --no-headers"
time="2022-05-11T13:32:35-04:00" level=info msg="Command output: \ntcp-echo-v1-bffddfc7-27j9b   1/1   Running   0     33s"
time="2022-05-11T13:32:35-04:00" level=info msg="Got the pod name=app=tcp-echo,version=v1 running!"
time="2022-05-11T13:32:35-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=tcp-echo,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:32:36-04:00" level=info msg="Command output: \ntcp-echo-v2-655fc6584d-9m9bf"
time="2022-05-11T13:32:36-04:00" level=info msg="app=tcp-echo,version=v2 pod name: tcp-echo-v2-655fc6584d-9m9bf"
time="2022-05-11T13:32:36-04:00" level=info msg="Running command kubectl -n bookinfo get pods tcp-echo-v2-655fc6584d-9m9bf --no-headers"
time="2022-05-11T13:32:36-04:00" level=info msg="Command output: \ntcp-echo-v2-655fc6584d-9m9bf   1/1   Running   0     6s"
time="2022-05-11T13:32:36-04:00" level=info msg="Got the pod name=app=tcp-echo,version=v2 running!"
time="2022-05-11T13:32:46-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T13:32:46-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:32:47-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T13:32:47-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T13:32:51-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
=== RUN   T4/TrafficManagement_100_percent_v1_tcp_shift_test
time="2022-05-11T13:32:51-04:00" level=info msg="Shifting all TCP traffic to v1"
time="2022-05-11T13:32:51-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/tcp-echo/tcp-echo-all-v1.yaml"
time="2022-05-11T13:32:52-04:00" level=info msg="Command output: \ngateway.networking.istio.io/tcp-echo-gateway created\ndestinationrule.networking.istio.io/tcp-echo-destination created\nvirtualservice.networking.istio.io/tcp-echo created"
time="2022-05-11T13:32:52-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:32:52-04:00" level=info msg="Command output: \nsleep-6d646957b7-k54v9"
time="2022-05-11T13:32:52-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-k54v9"
time="2022-05-11T13:32:54-04:00" level=info msg="one Wed May 11 17:28:06 UTC 2022\n"
time="2022-05-11T13:32:55-04:00" level=info msg="one Wed May 11 17:28:08 UTC 2022\n"
time="2022-05-11T13:32:56-04:00" level=info msg="one Wed May 11 17:28:09 UTC 2022\n"
time="2022-05-11T13:32:58-04:00" level=info msg="one Wed May 11 17:28:10 UTC 2022\n"
time="2022-05-11T13:32:59-04:00" level=info msg="one Wed May 11 17:28:12 UTC 2022\n"
time="2022-05-11T13:33:01-04:00" level=info msg="one Wed May 11 17:28:13 UTC 2022\n"
time="2022-05-11T13:33:02-04:00" level=info msg="one Wed May 11 17:28:15 UTC 2022\n"
time="2022-05-11T13:33:04-04:00" level=info msg="one Wed May 11 17:28:16 UTC 2022\n"
time="2022-05-11T13:33:05-04:00" level=info msg="one Wed May 11 17:28:18 UTC 2022\n"
time="2022-05-11T13:33:06-04:00" level=info msg="one Wed May 11 17:28:19 UTC 2022\n"
time="2022-05-11T13:33:08-04:00" level=info msg="one Wed May 11 17:28:20 UTC 2022\n"
time="2022-05-11T13:33:09-04:00" level=info msg="one Wed May 11 17:28:22 UTC 2022\n"
time="2022-05-11T13:33:11-04:00" level=info msg="one Wed May 11 17:28:23 UTC 2022\n"
time="2022-05-11T13:33:12-04:00" level=info msg="one Wed May 11 17:28:25 UTC 2022\n"
time="2022-05-11T13:33:13-04:00" level=info msg="one Wed May 11 17:28:26 UTC 2022\n"
time="2022-05-11T13:33:15-04:00" level=info msg="one Wed May 11 17:28:27 UTC 2022\n"
time="2022-05-11T13:33:16-04:00" level=info msg="one Wed May 11 17:28:29 UTC 2022\n"
time="2022-05-11T13:33:18-04:00" level=info msg="one Wed May 11 17:28:30 UTC 2022\n"
time="2022-05-11T13:33:19-04:00" level=info msg="one Wed May 11 17:28:32 UTC 2022\n"
time="2022-05-11T13:33:20-04:00" level=info msg="one Wed May 11 17:28:33 UTC 2022\n"
=== RUN   T4/TrafficManagement_20_percent_v2_tcp_shift_test
time="2022-05-11T13:33:20-04:00" level=info msg="Shifting 20%% TCP traffic to v2 tolerance 15%%"
time="2022-05-11T13:33:20-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/tcp-echo/tcp-echo-20-v2.yaml"
time="2022-05-11T13:33:21-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/tcp-echo configured"
time="2022-05-11T13:33:21-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:33:21-04:00" level=info msg="Command output: \nsleep-6d646957b7-k54v9"
time="2022-05-11T13:33:21-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-k54v9"
time="2022-05-11T13:34:49-04:00" level=info msg="Success. Traffic shifting acts as expected. v1 version hit 42, v2 version hit 18"
time="2022-05-11T13:34:49-04:00" level=info msg=Cleanup
time="2022-05-11T13:34:49-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/tcp-echo/tcp-echo-all-v1.yaml"
time="2022-05-11T13:34:50-04:00" level=info msg="Cleanup Echo"
time="2022-05-11T13:34:50-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/tcp-echo/tcp-echo-services.yaml"
time="2022-05-11T13:35:00-04:00" level=info msg="Removing Sleep on namespace bookinfo"
time="2022-05-11T13:35:00-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:35:00-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T13:35:01-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T13:35:01-04:00" level=info msg="Command error: exit status 1"
--- PASS: T4 (171.57s)
    --- PASS: T4/TrafficManagement_100_percent_v1_tcp_shift_test (29.22s)
    --- PASS: T4/TrafficManagement_20_percent_v2_tcp_shift_test (89.04s)
=== RUN   T5
time="2022-05-11T13:35:21-04:00" level=info msg=TestRequestTimeouts
time="2022-05-11T13:35:21-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T13:35:21-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T13:35:22-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T13:35:27-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:35:28-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-nrwfp"
time="2022-05-11T13:35:28-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-nrwfp"
time="2022-05-11T13:35:28-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-nrwfp --no-headers"
time="2022-05-11T13:35:28-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-nrwfp   0/2   ContainerCreating   0     33s"
time="2022-05-11T13:35:28-04:00" level=info msg="details-v1-6cd699df8c-nrwfp in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:35:58-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:35:58-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-nrwfp"
time="2022-05-11T13:35:58-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-nrwfp"
time="2022-05-11T13:35:58-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-nrwfp --no-headers"
time="2022-05-11T13:35:58-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-nrwfp   2/2   Running   0     64s"
time="2022-05-11T13:35:58-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T13:35:58-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:35:59-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-pcfc7"
time="2022-05-11T13:35:59-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-pcfc7"
time="2022-05-11T13:35:59-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-pcfc7 --no-headers"
time="2022-05-11T13:35:59-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-pcfc7   2/2   Running   0     64s"
time="2022-05-11T13:35:59-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T13:35:59-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:35:59-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-g4588"
time="2022-05-11T13:35:59-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-g4588"
time="2022-05-11T13:35:59-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-g4588 --no-headers"
time="2022-05-11T13:36:00-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-g4588   2/2   Running   0     64s"
time="2022-05-11T13:36:00-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T13:36:00-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:36:00-04:00" level=info msg="Command output: \nreviews-v2-675679877f-559vh"
time="2022-05-11T13:36:00-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-559vh"
time="2022-05-11T13:36:00-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-559vh --no-headers"
time="2022-05-11T13:36:00-04:00" level=info msg="Command output: \nreviews-v2-675679877f-559vh   2/2   Running   0     66s"
time="2022-05-11T13:36:00-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T13:36:00-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:36:00-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-4tmkb"
time="2022-05-11T13:36:00-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-4tmkb"
time="2022-05-11T13:36:00-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-4tmkb --no-headers"
time="2022-05-11T13:36:01-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-4tmkb   2/2   Running   0     38s"
time="2022-05-11T13:36:01-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T13:36:01-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:36:01-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-flxz5"
time="2022-05-11T13:36:01-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-flxz5"
time="2022-05-11T13:36:01-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-flxz5 --no-headers"
time="2022-05-11T13:36:01-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-flxz5   2/2   Running   0     67s"
time="2022-05-11T13:36:01-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T13:36:01-04:00" level=info msg="Creating Gateway"
time="2022-05-11T13:36:01-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:36:02-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T13:36:02-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T13:36:02-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:36:03-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
time="2022-05-11T13:36:13-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:36:14-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/productpage created\nvirtualservice.networking.istio.io/reviews created\nvirtualservice.networking.istio.io/ratings created\nvirtualservice.networking.istio.io/details created"
=== RUN   T5/TrafficManagement_request_delay
time="2022-05-11T13:36:14-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply782202721.yaml"
time="2022-05-11T13:36:14-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/ratings configured"
=== RUN   T5/TrafficManagement_request_timeouts
time="2022-05-11T13:36:19-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply432098124.yaml"
time="2022-05-11T13:36:20-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/reviews configured"
time="2022-05-11T13:36:55-04:00" level=info msg="bookinfo productpage returned in 30000 ms"
    testUtil.go:62: Test panic: runtime error: invalid memory address or nil pointer dereference
time="2022-05-11T13:36:55-04:00" level=info msg=Cleanup
time="2022-05-11T13:36:55-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/virtual-service-all-v1.yaml"
time="2022-05-11T13:36:55-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T13:36:55-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T13:36:56-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T13:36:56-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
--- FAIL: T5 (127.04s)
    --- PASS: T5/TrafficManagement_request_delay (5.59s)
    --- FAIL: T5/TrafficManagement_request_timeouts (35.93s)
=== RUN   T6
time="2022-05-11T13:37:28-04:00" level=info msg=TestCircuitBreaking
time="2022-05-11T13:37:28-04:00" level=info msg="Deploying Httpbin on namespace bookinfo"
time="2022-05-11T13:37:28-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T13:37:29-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T13:37:29-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T13:37:34-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T13:37:34-04:00" level=info msg="Deploy Fortio"
time="2022-05-11T13:37:34-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/httpbin/sample-client/fortio-deploy.yaml"
time="2022-05-11T13:37:35-04:00" level=info msg="Command output: \nservice/fortio created\ndeployment.apps/fortio-deploy created"
time="2022-05-11T13:37:40-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=fortio -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:37:40-04:00" level=info msg="Command output: \nfortio-deploy-55f5755f6c-c7ljp"
time="2022-05-11T13:37:40-04:00" level=info msg="app=fortio pod name: fortio-deploy-55f5755f6c-c7ljp"
time="2022-05-11T13:37:40-04:00" level=info msg="Running command kubectl -n bookinfo get pods fortio-deploy-55f5755f6c-c7ljp --no-headers"
time="2022-05-11T13:37:40-04:00" level=info msg="Command output: \nfortio-deploy-55f5755f6c-c7ljp   1/2   Running   0     33s"
time="2022-05-11T13:37:40-04:00" level=info msg="Got the pod name=app=fortio running!"
=== RUN   T6/TrafficManagement_tripping_circuit_breaker
time="2022-05-11T13:37:50-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply833934395.yaml"
time="2022-05-11T13:37:51-04:00" level=info msg="Command output: \nWarning: outlier detection consecutive errors is deprecated, use consecutiveGatewayErrors or consecutive5xxErrors instead\ndestinationrule.networking.istio.io/httpbin created"
time="2022-05-11T13:38:01-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=fortio -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:38:01-04:00" level=info msg="Command output: \nfortio-deploy-55f5755f6c-c7ljp"
time="2022-05-11T13:38:01-04:00" level=info msg="app=fortio pod name: fortio-deploy-55f5755f6c-c7ljp"
time="2022-05-11T13:38:01-04:00" level=info msg="Running command kubectl exec fortio-deploy-55f5755f6c-c7ljp -n bookinfo -c fortio -- /usr/bin/fortio curl -quiet http://httpbin:8000/get "
time="2022-05-11T13:38:02-04:00" level=info msg="Command output: \nHTTP/1.1 200 OK\r\nserver: envoy\r\ndate: Wed, 11 May 2022 17:33:16 GMT\r\ncontent-type: application/json\r\ncontent-length: 624\r\naccess-control-allow-origin: *\r\naccess-control-allow-credentials: true\r\nx-envoy-upstream-service-time: 33\r\n\r\n{\n  \"args\": {}, \n  \"headers\": {\n    \"Content-Length\": \"0\", \n    \"Host\": \"httpbin:8000\", \n    \"User-Agent\": \"fortio.org/fortio-1.11.3\", \n    \"X-B3-Parentspanid\": \"badb65df7e8b8998\", \n    \"X-B3-Sampled\": \"1\", \n    \"X-B3-Spanid\": \"7f55c3e1b3c5b4b5\", \n    \"X-B3-Traceid\": \"36ca829731405782badb65df7e8b8998\", \n    \"X-Envoy-Attempt-Count\": \"1\", \n    \"X-Forwarded-Client-Cert\": \"By=spiffe://cluster.local/ns/bookinfo/sa/httpbin;Hash=deec5fd6b634ae2e383a1259dfd29a64c2c389d9d18bdb5a7fd657de8b0e57ec;Subject=\\\"\\\";URI=spiffe://cluster.local/ns/bookinfo/sa/default\"\n  }, \n  \"origin\": \"127.0.0.1\", \n  \"url\": \"http://httpbin:8000/get\"\n}"
time="2022-05-11T13:38:02-04:00" level=info msg="Success. Get correct response"
time="2022-05-11T13:38:02-04:00" level=info msg="Tripping the circuit breaker"
time="2022-05-11T13:38:02-04:00" level=info msg="Running command kubectl exec fortio-deploy-55f5755f6c-c7ljp -n bookinfo -c fortio -- /usr/bin/fortio load -c 2 -qps 0 -n 50 -loglevel Warning http://httpbin:8000/get "
time="2022-05-11T13:38:03-04:00" level=info msg="Command output: \n17:33:16 I logger.go:127> Log level is now 3 Warning (was 2 Info)\nFortio 1.11.3 running at 0 queries per second, 4->4 procs, for 50 calls: http://httpbin:8000/get\nStarting at max qps with 2 thread(s) [gomax 4] for exactly 50 calls (25 per thread + 0)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\n17:33:16 W http_client.go:693> Parsed non ok code 503 (HTTP/1.1 503)\nEnded after 337.180071ms : 50 calls. qps=148.29\nAggregated Function Time : count 50 avg 0.009328946 +/- 0.007048 min 0.000683184 max 0.024499938 sum 0.466447302\n# range, mid point, percentile, count\n>= 0.000683184 <= 0.001 , 0.000841592 , 16.00, 8\n> 0.001 <= 0.002 , 0.0015 , 24.00, 4\n> 0.002 <= 0.003 , 0.0025 , 32.00, 4\n> 0.003 <= 0.004 , 0.0035 , 36.00, 2\n> 0.004 <= 0.005 , 0.0045 , 38.00, 1\n> 0.006 <= 0.007 , 0.0065 , 40.00, 1\n> 0.007 <= 0.008 , 0.0075 , 42.00, 1\n> 0.008 <= 0.009 , 0.0085 , 48.00, 3\n> 0.009 <= 0.01 , 0.0095 , 54.00, 3\n> 0.01 <= 0.011 , 0.0105 , 58.00, 2\n> 0.011 <= 0.012 , 0.0115 , 60.00, 1\n> 0.012 <= 0.014 , 0.013 , 70.00, 5\n> 0.014 <= 0.016 , 0.015 , 82.00, 6\n> 0.016 <= 0.018 , 0.017 , 88.00, 3\n> 0.018 <= 0.02 , 0.019 , 90.00, 1\n> 0.02 <= 0.0244999 , 0.02225 , 100.00, 5\n# target 50% 0.00933333\n# target 75% 0.0148333\n# target 90% 0.02\n# target 99% 0.0240499\n# target 99.9% 0.0244549\nSockets used: 23 (for perfect keepalive, would be 2)\nJitter: false\nCode 200 : 29 (58.0 %)\nCode 503 : 21 (42.0 %)\nResponse Header Sizes : count 50 avg 133.76 +/- 113.8 min 0 max 231 sum 6688\nResponse Body/Total Sizes : count 50 avg 596.9 +/- 302.9 min 241 max 855 sum 29845\nAll done 50 calls (plus 0 warmup) 9.329 ms avg, 148.3 qps"
time="2022-05-11T13:38:03-04:00" level=info msg="Success. Circuit breaking acts as expected. Code 200 hit 29 of 50, Code 503 hit 21 of 50"
time="2022-05-11T13:38:03-04:00" level=info msg="Query the istio-proxy stats"
time="2022-05-11T13:38:03-04:00" level=info msg="Running command kubectl exec fortio-deploy-55f5755f6c-c7ljp -n bookinfo -c istio-proxy -- pilot-agent request GET stats | grep httpbin | grep pending "
time="2022-05-11T13:38:03-04:00" level=info msg="Command output: \ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.circuit_breakers.default.rq_pending_open: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.circuit_breakers.high.rq_pending_open: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_active: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_failure_eject: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_overflow: 21\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_total: 30"
time="2022-05-11T13:38:03-04:00" level=info msg="cluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.circuit_breakers.default.rq_pending_open: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.circuit_breakers.high.rq_pending_open: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_active: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_failure_eject: 0\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_overflow: 21\ncluster.outbound|8000||httpbin.bookinfo.svc.cluster.local.upstream_rq_pending_total: 30\n"
time="2022-05-11T13:38:03-04:00" level=info msg=Cleanup
time="2022-05-11T13:38:03-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete297445470.yaml"
time="2022-05-11T13:38:04-04:00" level=info msg="Cleanup Fortio"
time="2022-05-11T13:38:04-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/httpbin/sample-client/fortio-deploy.yaml"
time="2022-05-11T13:38:14-04:00" level=info msg="Removing Httpbin on namespace bookinfo"
time="2022-05-11T13:38:14-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T13:38:14-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T13:38:32-04:00" level=info msg="Command output: \npod/httpbin-599849d486-rzj9m condition met"
--- PASS: T6 (84.57s)
    --- PASS: T6/TrafficManagement_tripping_circuit_breaker (13.05s)
=== RUN   T7
time="2022-05-11T13:38:52-04:00" level=info msg=TestMirroring
time="2022-05-11T13:38:52-04:00" level=info msg="Deploy Httpbin-v1"
time="2022-05-11T13:38:52-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/httpbin/httpbinv1.yaml"
time="2022-05-11T13:38:53-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin-v1 created"
time="2022-05-11T13:38:58-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:38:59-04:00" level=info msg="Command output: \nhttpbin-v1-675748d54c-4cnft"
time="2022-05-11T13:38:59-04:00" level=info msg="app=httpbin,version=v1 pod name: httpbin-v1-675748d54c-4cnft"
time="2022-05-11T13:38:59-04:00" level=info msg="Running command kubectl -n bookinfo get pods httpbin-v1-675748d54c-4cnft --no-headers"
time="2022-05-11T13:38:59-04:00" level=info msg="Command output: \nhttpbin-v1-675748d54c-4cnft   1/2   Running   0     33s"
time="2022-05-11T13:38:59-04:00" level=info msg="Got the pod name=app=httpbin,version=v1 running!"
time="2022-05-11T13:39:09-04:00" level=info msg="Deploy Httpbin-v2"
time="2022-05-11T13:39:09-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/httpbin/httpbinv2.yaml"
time="2022-05-11T13:39:10-04:00" level=info msg="Command output: \nserviceaccount/httpbin unchanged\nservice/httpbin unchanged\ndeployment.apps/httpbin-v2 created"
time="2022-05-11T13:39:15-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:39:18-04:00" level=info msg="Command output: \nI0511 13:39:16.651183   14137 request.go:655] Throttling request took 1.129577849s, request: GET:https://api.openupi.noiro.local:6443/apis/jaegertracing.io/v1?timeout=32s\nhttpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:39:18-04:00" level=info msg="app=httpbin,version=v2 pod name: I0511 13:39:16.651183   14137 request.go:655] Throttling request took 1.129577849s, request: GET:https://api.openupi.noiro.local:6443/apis/jaegertracing.io/v1?timeout=32s\nhttpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:39:18-04:00" level=info msg="Running command kubectl -n bookinfo get pods I0511 13:39:16.651183   14137 request.go:655] Throttling request took 1.129577849s, request: GET:https://api.openupi.noiro.local:6443/apis/jaegertracing.io/v1?timeout=32s\nhttpbin-v2-57b8494cdb-plcnc --no-headers"
time="2022-05-11T13:39:18-04:00" level=info msg="Command output: \nerror: there is no need to specify a resource type as a separate argument when passing arguments in resource/name form (e.g. 'kubectl get resource/<resource_name>' instead of 'kubectl get resource resource/<resource_name>'\nbash: line 1: httpbin-v2-57b8494cdb-plcnc: command not found"
time="2022-05-11T13:39:18-04:00" level=info msg="Command error: exit status 127"
time="2022-05-11T13:39:18-04:00" level=info msg="Failed to get status of pod I0511 13:39:16.651183   14137 request.go:655] Throttling request took 1.129577849s, request: GET:https://api.openupi.noiro.local:6443/apis/jaegertracing.io/v1?timeout=32s\nhttpbin-v2-57b8494cdb-plcnc in namespace bookinfo: command failed: \"error: there is no need to specify a resource type as a separate argument when passing arguments in resource/name form (e.g. 'kubectl get resource/<resource_name>' instead of 'kubectl get resource resource/<resource_name>'\\nbash: line 1: httpbin-v2-57b8494cdb-plcnc: command not found\\n\" exit status 127"
time="2022-05-11T13:39:18-04:00" level=info msg="I0511 13:39:16.651183   14137 request.go:655] Throttling request took 1.129577849s, request: GET:https://api.openupi.noiro.local:6443/apis/jaegertracing.io/v1?timeout=32s\nhttpbin-v2-57b8494cdb-plcnc in namespace bookinfo is not running: "
time="2022-05-11T13:39:48-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:39:49-04:00" level=info msg="Command output: \nhttpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:39:49-04:00" level=info msg="app=httpbin,version=v2 pod name: httpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:39:49-04:00" level=info msg="Running command kubectl -n bookinfo get pods httpbin-v2-57b8494cdb-plcnc --no-headers"
time="2022-05-11T13:39:49-04:00" level=info msg="Command output: \nhttpbin-v2-57b8494cdb-plcnc   2/2   Running   0     66s"
time="2022-05-11T13:39:49-04:00" level=info msg="Got the pod name=app=httpbin,version=v2 running!"
time="2022-05-11T13:39:59-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T13:39:59-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:40:00-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T13:40:00-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T13:40:06-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
=== RUN   T7/TrafficManagement_creating_a_default_routing_policy
time="2022-05-11T13:40:06-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply453843493.yaml"
time="2022-05-11T13:40:07-04:00" level=info msg="Command output: \nvirtualservice.networking.istio.io/httpbin created\ndestinationrule.networking.istio.io/httpbin created"
time="2022-05-11T13:40:17-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:40:17-04:00" level=info msg="Command output: \nsleep-6d646957b7-jmgsh"
time="2022-05-11T13:40:17-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-jmgsh"
time="2022-05-11T13:40:17-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-jmgsh -n bookinfo -c sleep -- curl -sS http://httpbin:8000/headers "
time="2022-05-11T13:40:18-04:00" level=info msg="Command output: \n{\n  \"headers\": {\n    \"Accept\": \"*/*\", \n    \"Content-Length\": \"0\", \n    \"Host\": \"httpbin:8000\", \n    \"User-Agent\": \"curl/7.83.0-DEV\", \n    \"X-B3-Parentspanid\": \"09924c148b0f2e79\", \n    \"X-B3-Sampled\": \"1\", \n    \"X-B3-Spanid\": \"02856ebd0cf365e0\", \n    \"X-B3-Traceid\": \"b8c204b716c1f46909924c148b0f2e79\", \n    \"X-Envoy-Attempt-Count\": \"1\", \n    \"X-Forwarded-Client-Cert\": \"By=spiffe://cluster.local/ns/bookinfo/sa/default;Hash=7d21c4aa72014985d821549dc758d87de2db90ba36fb498171c0d7892e3a40a7;Subject=\\\"\\\";URI=spiffe://cluster.local/ns/bookinfo/sa/sleep\"\n  }\n}"
time="2022-05-11T13:40:18-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:40:18-04:00" level=info msg="Command output: \nhttpbin-v1-675748d54c-4cnft"
time="2022-05-11T13:40:18-04:00" level=info msg="app=httpbin,version=v1 pod name: httpbin-v1-675748d54c-4cnft"
time="2022-05-11T13:40:18-04:00" level=info msg="Running command kubectl logs -n bookinfo --follow=false httpbin-v1-675748d54c-4cnft -c httpbin"
time="2022-05-11T13:40:18-04:00" level=info msg="Command output: \n[2022-05-11 17:34:11 +0000] [1] [INFO] Starting gunicorn 19.9.0\n[2022-05-11 17:34:11 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)\n[2022-05-11 17:34:11 +0000] [1] [INFO] Using worker: sync\n[2022-05-11 17:34:11 +0000] [9] [INFO] Booting worker with pid: 9\n127.0.0.1 - - [11/May/2022:17:35:31 +0000] \"GET /headers HTTP/1.1\" 200 557 \"-\" \"curl/7.83.0-DEV\""
time="2022-05-11T13:40:18-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:40:19-04:00" level=info msg="Command output: \nhttpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:40:19-04:00" level=info msg="app=httpbin,version=v2 pod name: httpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:40:19-04:00" level=info msg="Running command kubectl logs -n bookinfo --follow=false httpbin-v2-57b8494cdb-plcnc -c httpbin"
time="2022-05-11T13:40:19-04:00" level=info msg="Command output: \n[2022-05-11 17:34:26 +0000] [1] [INFO] Starting gunicorn 19.9.0\n[2022-05-11 17:34:26 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)\n[2022-05-11 17:34:26 +0000] [1] [INFO] Using worker: sync\n[2022-05-11 17:34:26 +0000] [9] [INFO] Booting worker with pid: 9"
time="2022-05-11T13:40:19-04:00" level=info msg="Success. v1 an v2 logs are expected"
=== RUN   T7/TrafficManagement_mirroring_traffic_to_v2
time="2022-05-11T13:40:19-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply854865728.yaml"
time="2022-05-11T13:40:20-04:00" level=info msg="Command output: \nWarning: using deprecated setting \"mirrorPercent\", use \"mirrorPercentage\" instead\nvirtualservice.networking.istio.io/httpbin configured"
time="2022-05-11T13:40:30-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:40:30-04:00" level=info msg="Command output: \nsleep-6d646957b7-jmgsh"
time="2022-05-11T13:40:30-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-jmgsh"
time="2022-05-11T13:40:30-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-jmgsh -n bookinfo -c sleep -- curl -sS http://httpbin:8000/headers "
time="2022-05-11T13:40:30-04:00" level=info msg="Command output: \n{\n  \"headers\": {\n    \"Accept\": \"*/*\", \n    \"Content-Length\": \"0\", \n    \"Host\": \"httpbin:8000\", \n    \"User-Agent\": \"curl/7.83.0-DEV\", \n    \"X-B3-Parentspanid\": \"8b47f3025dba90bc\", \n    \"X-B3-Sampled\": \"1\", \n    \"X-B3-Spanid\": \"07a81d9f43a1c9d0\", \n    \"X-B3-Traceid\": \"3ec9eb43828bd7288b47f3025dba90bc\", \n    \"X-Envoy-Attempt-Count\": \"1\", \n    \"X-Forwarded-Client-Cert\": \"By=spiffe://cluster.local/ns/bookinfo/sa/default;Hash=7d21c4aa72014985d821549dc758d87de2db90ba36fb498171c0d7892e3a40a7;Subject=\\\"\\\";URI=spiffe://cluster.local/ns/bookinfo/sa/sleep\"\n  }\n}"
time="2022-05-11T13:40:30-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:40:31-04:00" level=info msg="Command output: \nhttpbin-v1-675748d54c-4cnft"
time="2022-05-11T13:40:31-04:00" level=info msg="app=httpbin,version=v1 pod name: httpbin-v1-675748d54c-4cnft"
time="2022-05-11T13:40:31-04:00" level=info msg="Running command kubectl logs -n bookinfo --follow=false httpbin-v1-675748d54c-4cnft -c httpbin"
time="2022-05-11T13:40:31-04:00" level=info msg="Command output: \n[2022-05-11 17:34:11 +0000] [1] [INFO] Starting gunicorn 19.9.0\n[2022-05-11 17:34:11 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)\n[2022-05-11 17:34:11 +0000] [1] [INFO] Using worker: sync\n[2022-05-11 17:34:11 +0000] [9] [INFO] Booting worker with pid: 9\n127.0.0.1 - - [11/May/2022:17:35:31 +0000] \"GET /headers HTTP/1.1\" 200 557 \"-\" \"curl/7.83.0-DEV\"\n127.0.0.1 - - [11/May/2022:17:35:44 +0000] \"GET /headers HTTP/1.1\" 200 557 \"-\" \"curl/7.83.0-DEV\""
time="2022-05-11T13:40:31-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:40:31-04:00" level=info msg="Command output: \nhttpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:40:31-04:00" level=info msg="app=httpbin,version=v2 pod name: httpbin-v2-57b8494cdb-plcnc"
time="2022-05-11T13:40:31-04:00" level=info msg="Running command kubectl logs -n bookinfo --follow=false httpbin-v2-57b8494cdb-plcnc -c httpbin"
time="2022-05-11T13:40:32-04:00" level=info msg="Command output: \n[2022-05-11 17:34:26 +0000] [1] [INFO] Starting gunicorn 19.9.0\n[2022-05-11 17:34:26 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)\n[2022-05-11 17:34:26 +0000] [1] [INFO] Using worker: sync\n[2022-05-11 17:34:26 +0000] [9] [INFO] Booting worker with pid: 9\n127.0.0.1 - - [11/May/2022:17:35:44 +0000] \"GET /headers HTTP/1.1\" 200 564 \"-\" \"curl/7.83.0-DEV\""
time="2022-05-11T13:40:32-04:00" level=info msg="Success. v1 an v2 logs are expected"
time="2022-05-11T13:40:32-04:00" level=info msg=Cleanup
time="2022-05-11T13:40:32-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete623836063.yaml"
time="2022-05-11T13:40:32-04:00" level=info msg="Cleanup Httpbin-v1"
time="2022-05-11T13:40:32-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/httpbin/httpbinv1.yaml"
time="2022-05-11T13:40:42-04:00" level=info msg="Cleanup Httpbin-v2"
time="2022-05-11T13:40:42-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/httpbin/httpbinv2.yaml"
time="2022-05-11T13:40:52-04:00" level=info msg="Removing Sleep on namespace bookinfo"
time="2022-05-11T13:40:52-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:40:53-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T13:40:53-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T13:40:53-04:00" level=info msg="Command error: exit status 1"
--- PASS: T7 (140.63s)
    --- PASS: T7/TrafficManagement_creating_a_default_routing_policy (12.77s)
    --- PASS: T7/TrafficManagement_mirroring_traffic_to_v2 (12.59s)
=== RUN   T8
time="2022-05-11T13:41:13-04:00" level=info msg=TestIngressGateways
time="2022-05-11T13:41:13-04:00" level=info msg="Deploying Httpbin on namespace bookinfo"
time="2022-05-11T13:41:13-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T13:41:14-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T13:41:14-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T13:41:21-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
=== RUN   T8/TrafficManagement_ingress_status_200_test
time="2022-05-11T13:41:21-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply622983282.yaml"
time="2022-05-11T13:41:22-04:00" level=info msg="Command output: \ngateway.networking.istio.io/httpbin-gateway created\nvirtualservice.networking.istio.io/httpbin created"
    common.go:37: Failed to get response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/status/200": dial tcp 151.9.1.21:80: i/o timeout
=== RUN   T8/TrafficManagement_ingress_headers_test
time="2022-05-11T13:42:12-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply860930857.yaml"
time="2022-05-11T13:42:13-04:00" level=info msg="Command output: \ngateway.networking.istio.io/httpbin-gateway configured\nvirtualservice.networking.istio.io/httpbin configured"
    common.go:37: Failed to get HTTP Response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/headers": dial tcp 151.9.1.21:80: i/o timeout
time="2022-05-11T13:42:53-04:00" level=info msg=Cleanup
time="2022-05-11T13:42:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete340537972.yaml"
time="2022-05-11T13:42:53-04:00" level=info msg="Removing Httpbin on namespace bookinfo"
time="2022-05-11T13:42:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T13:42:54-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T13:43:12-04:00" level=info msg="Command output: \npod/httpbin-599849d486-gmvj8 condition met"
--- FAIL: T8 (139.39s)
    --- FAIL: T8/TrafficManagement_ingress_status_200_test (50.84s)
    --- FAIL: T8/TrafficManagement_ingress_headers_test (41.04s)
=== RUN   T9
time="2022-05-11T13:43:32-04:00" level=info msg="Test Secure Gateways"
time="2022-05-11T13:43:32-04:00" level=info msg="Deploying Httpbin on namespace bookinfo"
time="2022-05-11T13:43:32-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T13:43:33-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T13:43:33-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T13:43:40-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T13:43:40-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply377890627.yaml"
time="2022-05-11T13:43:40-04:00" level=info msg="Command output: \nservice/helloworld-v1 created\ndeployment.apps/helloworld-v1 created"
time="2022-05-11T13:43:40-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=helloworld-v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:43:41-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:43:41-04:00" level=info msg="app=helloworld-v1 pod name: helloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:43:41-04:00" level=info msg="Running command kubectl -n bookinfo get pods helloworld-v1-fc9cdf5c9-ck76r --no-headers"
time="2022-05-11T13:43:41-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r   0/2   ContainerCreating   0     28s"
time="2022-05-11T13:43:41-04:00" level=info msg="helloworld-v1-fc9cdf5c9-ck76r in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:44:11-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=helloworld-v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:44:11-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:44:11-04:00" level=info msg="app=helloworld-v1 pod name: helloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:44:11-04:00" level=info msg="Running command kubectl -n bookinfo get pods helloworld-v1-fc9cdf5c9-ck76r --no-headers"
time="2022-05-11T13:44:12-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r   0/2   ContainerCreating   0     59s"
time="2022-05-11T13:44:12-04:00" level=info msg="helloworld-v1-fc9cdf5c9-ck76r in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:44:42-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=helloworld-v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:44:42-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:44:42-04:00" level=info msg="app=helloworld-v1 pod name: helloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:44:42-04:00" level=info msg="Running command kubectl -n bookinfo get pods helloworld-v1-fc9cdf5c9-ck76r --no-headers"
time="2022-05-11T13:44:42-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r   0/2   ContainerCreating   0     90s"
time="2022-05-11T13:44:42-04:00" level=info msg="helloworld-v1-fc9cdf5c9-ck76r in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:45:12-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=helloworld-v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:45:12-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:45:12-04:00" level=info msg="app=helloworld-v1 pod name: helloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:45:12-04:00" level=info msg="Running command kubectl -n bookinfo get pods helloworld-v1-fc9cdf5c9-ck76r --no-headers"
time="2022-05-11T13:45:13-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r   1/2   ImagePullBackOff   0     2m"
time="2022-05-11T13:45:13-04:00" level=info msg="helloworld-v1-fc9cdf5c9-ck76r in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T13:45:43-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=helloworld-v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:45:43-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:45:43-04:00" level=info msg="app=helloworld-v1 pod name: helloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:45:43-04:00" level=info msg="Running command kubectl -n bookinfo get pods helloworld-v1-fc9cdf5c9-ck76r --no-headers"
time="2022-05-11T13:45:43-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r   1/2   ImagePullBackOff   0     2m31s"
time="2022-05-11T13:45:43-04:00" level=info msg="helloworld-v1-fc9cdf5c9-ck76r in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T13:46:13-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=helloworld-v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:46:14-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:46:14-04:00" level=info msg="app=helloworld-v1 pod name: helloworld-v1-fc9cdf5c9-ck76r"
time="2022-05-11T13:46:14-04:00" level=info msg="Running command kubectl -n bookinfo get pods helloworld-v1-fc9cdf5c9-ck76r --no-headers"
time="2022-05-11T13:46:14-04:00" level=info msg="Command output: \nhelloworld-v1-fc9cdf5c9-ck76r   1/2   ImagePullBackOff   0     2m33s"
time="2022-05-11T13:46:14-04:00" level=info msg="helloworld-v1-fc9cdf5c9-ck76r in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T13:46:54-04:00" level=info msg="Create TLS secrets"
time="2022-05-11T13:46:54-04:00" level=info msg="Running command kubectl create secret tls httpbin-credential -n istio-system --key ../sampleCerts/httpbin.example.com/httpbin.example.com.key --cert ../sampleCerts/httpbin.example.com/httpbin.example.com.crt"
time="2022-05-11T13:46:54-04:00" level=info msg="Command output: \nsecret/httpbin-credential created"
time="2022-05-11T13:46:54-04:00" level=info msg="Running command kubectl create secret tls helloworld-credential -n istio-system --key ../sampleCerts/helloworldv1/helloworld-v1.example.com.key --cert ../sampleCerts/helloworldv1/helloworld-v1.example.com.crt"
time="2022-05-11T13:46:54-04:00" level=info msg="Command output: \nsecret/helloworld-credential created"
=== RUN   T9/TrafficManagement_ingress_single_host_tls_test
time="2022-05-11T13:47:04-04:00" level=info msg="Configure a TLS ingress gateway for a single host"
time="2022-05-11T13:47:04-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply233411526.yaml"
time="2022-05-11T13:47:05-04:00" level=info msg="Command output: \ngateway.networking.istio.io/mygateway created\nvirtualservice.networking.istio.io/httpbin created"
    common.go:37: Failed to get response. Error Get "https://httpbin.example.com:443/status/418": dial tcp 151.9.1.21:443: i/o timeout
=== RUN   T9/TrafficManagement_ingress_multiple_hosts_tls_test
time="2022-05-11T13:48:05-04:00" level=info msg="Configure multiple hosts Gateway"
time="2022-05-11T13:48:05-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply261624429.yaml"
time="2022-05-11T13:48:06-04:00" level=info msg="Command output: \ngateway.networking.istio.io/mygateway configured\nvirtualservice.networking.istio.io/helloworld-v1 created"
time="2022-05-11T13:48:36-04:00" level=info msg="Check helloworld"
    common.go:37: Failed to get response. Error Get "https://helloworld-v1.example.com:443/hello": dial tcp 151.9.1.21:443: i/o timeout
=== RUN   T9/TrafficManagement_ingress_mutual_tls_test
time="2022-05-11T13:49:06-04:00" level=info msg="Configure Mutual TLS Gateway"
time="2022-05-11T13:49:06-04:00" level=info msg="Running command kubectl delete secret httpbin-credential -n istio-system"
time="2022-05-11T13:49:06-04:00" level=info msg="Running command kubectl create secret generic httpbin-credential --from-file=tls.key=../sampleCerts/httpbin.example.com/httpbin.example.com.key --from-file=tls.crt=../sampleCerts/httpbin.example.com/httpbin.example.com.crt --from-file=ca.crt=../sampleCerts/httpbin.example.com/example.com.crt -n istio-system"
time="2022-05-11T13:49:16-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply632042728.yaml"
time="2022-05-11T13:49:18-04:00" level=info msg="Command output: \ngateway.networking.istio.io/mygateway configured"
time="2022-05-11T13:49:48-04:00" level=info msg="Check SSL handshake failure as expected"
time="2022-05-11T13:50:18-04:00" level=info msg="Expected failure: Get \"https://httpbin.example.com:443/status/418\": dial tcp 151.9.1.21:443: i/o timeout"
time="2022-05-11T13:50:18-04:00" level=info msg="Check SSL return a teapot again"
    common.go:37: Failed to get response. Error Get "https://httpbin.example.com:443/status/418": dial tcp 151.9.1.21:443: i/o timeout
time="2022-05-11T13:50:48-04:00" level=info msg=Cleanup
time="2022-05-11T13:50:48-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete905107751.yaml"
time="2022-05-11T13:50:50-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete044915802.yaml"
time="2022-05-11T13:50:50-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete741574641.yaml"
time="2022-05-11T13:50:51-04:00" level=info msg="Running command kubectl delete secret httpbin-credential -n istio-system"
time="2022-05-11T13:50:51-04:00" level=info msg="Running command kubectl delete secret helloworld-credential -n istio-system"
time="2022-05-11T13:50:51-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete237311644.yaml"
time="2022-05-11T13:50:52-04:00" level=info msg="Removing Httpbin on namespace bookinfo"
time="2022-05-11T13:50:52-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T13:50:52-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T13:51:02-04:00" level=info msg="Command output: \npod/httpbin-599849d486-9kmjt condition met"
--- FAIL: T9 (470.06s)
    --- FAIL: T9/TrafficManagement_ingress_single_host_tls_test (60.71s)
    --- FAIL: T9/TrafficManagement_ingress_multiple_hosts_tls_test (60.86s)
    --- FAIL: T9/TrafficManagement_ingress_mutual_tls_test (102.57s)
=== RUN   T10
time="2022-05-11T13:51:22-04:00" level=info msg="TestIngressWithOutTLS Termination"
time="2022-05-11T13:51:22-04:00" level=info msg="Create Secret"
time="2022-05-11T13:51:22-04:00" level=info msg="Running command kubectl create secret tls nginx-server-certs -n bookinfo --key ../sampleCerts/nginx.example.com/nginx.example.com.key --cert ../sampleCerts/nginx.example.com/nginx.example.com.crt"
time="2022-05-11T13:51:23-04:00" level=info msg="Command output: \nsecret/nginx-server-certs created"
time="2022-05-11T13:51:23-04:00" level=info msg="Running command kubectl create -n bookinfo secret generic nginx-ca-certs --from-file=../sampleCerts/nginx.example.com/example.com.crt"
time="2022-05-11T13:51:23-04:00" level=info msg="Command output: \nsecret/nginx-ca-certs created"
time="2022-05-11T13:51:23-04:00" level=info msg="Create ConfigMap"
time="2022-05-11T13:51:23-04:00" level=info msg="Running command kubectl create configmap nginx-configmap --from-file=nginx.conf=../testdata/examples/x86/nginx/nginx.conf -n bookinfo"
time="2022-05-11T13:51:23-04:00" level=info msg="Command output: \nconfigmap/nginx-configmap created"
time="2022-05-11T13:51:28-04:00" level=info msg="Deploy Nginx"
time="2022-05-11T13:51:28-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/nginx/nginx.yaml"
time="2022-05-11T13:51:29-04:00" level=info msg="Command output: \nservice/my-nginx created\ndeployment.apps/my-nginx created"
time="2022-05-11T13:51:34-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:51:34-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57"
time="2022-05-11T13:51:34-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-x4s57"
time="2022-05-11T13:51:34-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-x4s57 --no-headers"
time="2022-05-11T13:51:35-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57   0/2   ContainerCreating   0     5s"
time="2022-05-11T13:51:35-04:00" level=info msg="my-nginx-788f55df6d-x4s57 in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:52:05-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:52:05-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57"
time="2022-05-11T13:52:05-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-x4s57"
time="2022-05-11T13:52:05-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-x4s57 --no-headers"
time="2022-05-11T13:52:05-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57   0/2   ContainerCreating   0     63s"
time="2022-05-11T13:52:05-04:00" level=info msg="my-nginx-788f55df6d-x4s57 in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T13:52:35-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:52:35-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57"
time="2022-05-11T13:52:35-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-x4s57"
time="2022-05-11T13:52:35-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-x4s57 --no-headers"
time="2022-05-11T13:52:36-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57   1/2   ImagePullBackOff   0     94s"
time="2022-05-11T13:52:36-04:00" level=info msg="my-nginx-788f55df6d-x4s57 in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T13:53:06-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:53:06-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57"
time="2022-05-11T13:53:06-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-x4s57"
time="2022-05-11T13:53:06-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-x4s57 --no-headers"
time="2022-05-11T13:53:06-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57   1/2   ImagePullBackOff   0     2m5s"
time="2022-05-11T13:53:06-04:00" level=info msg="my-nginx-788f55df6d-x4s57 in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T13:53:36-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:53:37-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57"
time="2022-05-11T13:53:37-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-x4s57"
time="2022-05-11T13:53:37-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-x4s57 --no-headers"
time="2022-05-11T13:53:37-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57   1/2   ImagePullBackOff   0     2m35s"
time="2022-05-11T13:53:37-04:00" level=info msg="my-nginx-788f55df6d-x4s57 in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T13:54:07-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:54:07-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57"
time="2022-05-11T13:54:07-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-x4s57"
time="2022-05-11T13:54:07-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-x4s57 --no-headers"
time="2022-05-11T13:54:07-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57   1/2   ImagePullBackOff   0     2m38s"
time="2022-05-11T13:54:07-04:00" level=info msg="my-nginx-788f55df6d-x4s57 in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T13:54:47-04:00" level=info msg="Verify NGINX server"
time="2022-05-11T13:54:47-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:54:48-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-x4s57"
time="2022-05-11T13:54:48-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-x4s57"
    common.go:37: failed to get response. Error command failed: "* Added nginx.example.com:8443:127.0.0.1 to DNS cache\n* Rebuilt URL to: https://nginx.example.com:8443/\n* Hostname nginx.example.com was found in DNS cache\n*   Trying 127.0.0.1...\n* TCP_NODELAY set\n* connect to 127.0.0.1 port 8443 failed: Connection refused\n* Failed to connect to nginx.example.com port 8443: Connection refused\n* Closing connection 0\ncurl: (7) Failed to connect to nginx.example.com port 8443: Connection refused\ncommand terminated with exit code 7\n" exit status 7
time="2022-05-11T13:54:48-04:00" level=info msg=Cleanup
time="2022-05-11T13:54:48-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete575453515.yaml"
time="2022-05-11T13:54:48-04:00" level=info msg="Cleanup Nginx"
time="2022-05-11T13:54:48-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/nginx/nginx.yaml"
time="2022-05-11T13:54:49-04:00" level=info msg="Running command kubectl delete configmap nginx-configmap -n bookinfo"
time="2022-05-11T13:54:49-04:00" level=info msg="Command output: \nconfigmap \"nginx-configmap\" deleted"
time="2022-05-11T13:54:49-04:00" level=info msg="Running command kubectl delete secret nginx-server-certs -n bookinfo"
time="2022-05-11T13:54:49-04:00" level=info msg="Command output: \nsecret \"nginx-server-certs\" deleted"
time="2022-05-11T13:54:49-04:00" level=info msg="Running command kubectl delete secret nginx-ca-certs -n bookinfo"
time="2022-05-11T13:54:49-04:00" level=info msg="Command output: \nsecret \"nginx-ca-certs\" deleted"
--- FAIL: T10 (237.06s)
=== RUN   T11
time="2022-05-11T13:55:19-04:00" level=info msg=TestAccessExternalServices
time="2022-05-11T13:55:19-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T13:55:19-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:55:20-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T13:55:20-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T13:55:26-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T13:55:26-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:55:26-04:00" level=info msg="Command output: \nsleep-6d646957b7-ns4kw"
time="2022-05-11T13:55:26-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-ns4kw"
=== RUN   T11/TrafficManagement_egress_envoy_passthrough_to_external_services
time="2022-05-11T13:55:26-04:00" level=info msg="Skip checking the meshConfig outboundTrafficPolicy mode"
time="2022-05-11T13:55:26-04:00" level=info msg="make requests to external https services"
time="2022-05-11T13:55:26-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-ns4kw -n bookinfo -c sleep -- curl -sSI https://www.redhat.com/en | grep  \"HTTP/\" "
time="2022-05-11T13:55:36-04:00" level=info msg="Command output: \ncurl: (35) OpenSSL SSL_connect: Connection reset by peer in connection to www.redhat.com:443 \ncommand terminated with exit code 35"
time="2022-05-11T13:55:36-04:00" level=info msg="Command error: exit status 1"
    common.go:37: Failed to get response. Error command failed: "curl: (35) OpenSSL SSL_connect: Connection reset by peer in connection to www.redhat.com:443 \ncommand terminated with exit code 35\n" exit status 1
--- FAIL: T11 (16.90s)
    --- FAIL: T11/TrafficManagement_egress_envoy_passthrough_to_external_services (10.53s)
=== RUN   T12
time="2022-05-11T13:55:36-04:00" level=info msg=TestEgressTLSOrigination
time="2022-05-11T13:55:36-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T13:55:36-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:55:37-04:00" level=info msg="Command output: \nserviceaccount/sleep unchanged\nservice/sleep unchanged\ndeployment.apps/sleep unchanged"
time="2022-05-11T13:55:37-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T13:55:37-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T13:55:37-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:55:38-04:00" level=info msg="Command output: \nsleep-6d646957b7-ns4kw"
time="2022-05-11T13:55:38-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-ns4kw"
=== RUN   T12/TrafficManagement_egress_configure_access_to_external_service
time="2022-05-11T13:55:38-04:00" level=info msg="Create a ServiceEntry to external istio.io"
time="2022-05-11T13:55:38-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply299073582.yaml"
time="2022-05-11T13:55:39-04:00" level=info msg="Command output: \nserviceentry.networking.istio.io/istio-io created"
time="2022-05-11T13:55:49-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-ns4kw -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - http://istio.io "
time="2022-05-11T13:55:59-04:00" level=info msg="Command output: \nHTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:51:12 GMT\r\nserver: envoy\r\n\r"
time="2022-05-11T13:55:59-04:00" level=info msg="Error response: HTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:51:12 GMT\r\nserver: envoy\r\n\r\n"
    egress_tls_origination.go:59: Error response: HTTP/1.1 503 Service Unavailable
        content-length: 84
        content-type: text/plain
        date: Wed, 11 May 2022 17:51:12 GMT
        server: envoy
        
=== RUN   T12/TrafficManagement_egress_tls_origination
time="2022-05-11T13:55:59-04:00" level=info msg="TLS origination for egress traffic"
time="2022-05-11T13:55:59-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply988572597.yaml"
time="2022-05-11T13:56:00-04:00" level=info msg="Command output: \nserviceentry.networking.istio.io/istio-io configured\ndestinationrule.networking.istio.io/edition-istio-io created"
time="2022-05-11T13:56:10-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-ns4kw -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - http://istio.io "
time="2022-05-11T13:56:20-04:00" level=info msg="Command output: \nHTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:51:34 GMT\r\nserver: envoy\r\n\r"
time="2022-05-11T13:56:20-04:00" level=info msg="Error response: HTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:51:34 GMT\r\nserver: envoy\r\n\r\n"
    egress_tls_origination.go:75: Error response: HTTP/1.1 503 Service Unavailable
        content-length: 84
        content-type: text/plain
        date: Wed, 11 May 2022 17:51:34 GMT
        server: envoy
        
time="2022-05-11T13:56:20-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-ns4kw -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - https://istio.io "
time="2022-05-11T13:56:31-04:00" level=info msg="Command output: \ncurl: (35) OpenSSL SSL_connect: Connection reset by peer in connection to istio.io:443 \ncommand terminated with exit code 35"
time="2022-05-11T13:56:31-04:00" level=info msg="Command error: exit status 35"
    common.go:37: Failed to get response. Error command failed: "curl: (35) OpenSSL SSL_connect: Connection reset by peer in connection to istio.io:443 \ncommand terminated with exit code 35\n" exit status 35
time="2022-05-11T13:56:31-04:00" level=info msg=Cleanup
time="2022-05-11T13:56:31-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete974147472.yaml"
time="2022-05-11T13:56:31-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete946574255.yaml"
time="2022-05-11T13:56:31-04:00" level=info msg="Removing Sleep on namespace bookinfo"
time="2022-05-11T13:56:31-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:56:32-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T13:56:32-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T13:56:32-04:00" level=info msg="Command error: exit status 1"
--- FAIL: T12 (75.41s)
    --- FAIL: T12/TrafficManagement_egress_configure_access_to_external_service (21.30s)
    --- FAIL: T12/TrafficManagement_egress_tls_origination (31.73s)
=== RUN   T13
time="2022-05-11T13:56:52-04:00" level=info msg=TestEgressGateways
time="2022-05-11T13:56:52-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T13:56:52-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:56:53-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T13:56:53-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T13:56:59-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T13:56:59-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:56:59-04:00" level=info msg="Command output: \nsleep-6d646957b7-z2ckm"
time="2022-05-11T13:56:59-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-z2ckm"
=== RUN   T13/TrafficManagement_egress_gateway_for_http_traffic
time="2022-05-11T13:56:59-04:00" level=info msg="Create a ServiceEntry to external istio.io"
time="2022-05-11T13:56:59-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply492572994.yaml"
time="2022-05-11T13:57:00-04:00" level=info msg="Command output: \nserviceentry.networking.istio.io/istio-io created"
time="2022-05-11T13:57:10-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-z2ckm -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - http://istio.io "
time="2022-05-11T13:57:20-04:00" level=info msg="Command output: \nHTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:52:33 GMT\r\nserver: envoy\r\n\r"
time="2022-05-11T13:57:20-04:00" level=info msg="Error response: HTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:52:33 GMT\r\nserver: envoy\r\n\r\n"
    egress_gateways.go:61: Error response: HTTP/1.1 503 Service Unavailable
        content-length: 84
        content-type: text/plain
        date: Wed, 11 May 2022 17:52:33 GMT
        server: envoy
        
time="2022-05-11T13:57:20-04:00" level=info msg="Create a Gateway to external istio.io"
time="2022-05-11T13:57:20-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply618404793.yaml"
time="2022-05-11T13:57:21-04:00" level=info msg="Command output: \ngateway.networking.istio.io/istio-egressgateway created\ndestinationrule.networking.istio.io/egressgateway-for-istio-io created\nvirtualservice.networking.istio.io/direct-istio-io-through-egress-gateway created"
time="2022-05-11T13:57:41-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-z2ckm -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - http://istio.io "
time="2022-05-11T13:58:12-04:00" level=info msg="Command output: \nHTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:53:25 GMT\r\nserver: envoy\r\nx-envoy-upstream-service-time: 30027\r\n\r"
time="2022-05-11T13:58:12-04:00" level=info msg="Error response: HTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:53:25 GMT\r\nserver: envoy\r\nx-envoy-upstream-service-time: 30027\r\n\r\n"
    egress_gateways.go:75: Error response: HTTP/1.1 503 Service Unavailable
        content-length: 84
        content-type: text/plain
        date: Wed, 11 May 2022 17:53:25 GMT
        server: envoy
        x-envoy-upstream-service-time: 30027
        
time="2022-05-11T13:58:12-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete044444612.yaml"
time="2022-05-11T13:58:12-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete413055059.yaml"
=== RUN   T13/TrafficManagement_egress_gateway_for_https_traffic
time="2022-05-11T13:58:32-04:00" level=info msg="Create a TLS ServiceEntry to external istio.io"
time="2022-05-11T13:58:32-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply495276438.yaml"
time="2022-05-11T13:58:33-04:00" level=info msg="Command output: \nserviceentry.networking.istio.io/istio-io created"
time="2022-05-11T13:58:43-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-z2ckm -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - https://istio.io "
time="2022-05-11T13:58:53-04:00" level=info msg="Command output: \ncurl: (35) OpenSSL SSL_connect: Connection reset by peer in connection to istio.io:443 \ncommand terminated with exit code 35"
time="2022-05-11T13:58:53-04:00" level=info msg="Command error: exit status 35"
    common.go:37: Failed to get response. Error command failed: "curl: (35) OpenSSL SSL_connect: Connection reset by peer in connection to istio.io:443 \ncommand terminated with exit code 35\n" exit status 35
time="2022-05-11T13:58:53-04:00" level=info msg=Cleanup
time="2022-05-11T13:58:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete903269373.yaml"
time="2022-05-11T13:58:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete409524024.yaml"
time="2022-05-11T13:58:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete974970679.yaml"
time="2022-05-11T13:58:54-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete474672426.yaml"
time="2022-05-11T13:58:54-04:00" level=info msg="Removing Sleep on namespace bookinfo"
time="2022-05-11T13:58:54-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:58:54-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T13:58:55-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T13:58:55-04:00" level=info msg="Command error: exit status 1"
--- FAIL: T13 (142.78s)
    --- FAIL: T13/TrafficManagement_egress_gateway_for_http_traffic (93.12s)
    --- FAIL: T13/TrafficManagement_egress_gateway_for_https_traffic (21.03s)
=== RUN   T15
time="2022-05-11T13:59:15-04:00" level=info msg="TestEgressGatewaysTLSOrigination File Mount"
time="2022-05-11T13:59:15-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T13:59:15-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T13:59:16-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T13:59:16-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T13:59:21-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T13:59:21-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:59:23-04:00" level=info msg="Command output: \nsleep-6d646957b7-5kzcp"
time="2022-05-11T13:59:23-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-5kzcp"
time="2022-05-11T13:59:23-04:00" level=info msg="Create Secret"
time="2022-05-11T13:59:23-04:00" level=info msg="Running command kubectl create secret tls nginx-server-certs -n bookinfo --key ../sampleCerts/nginx.example.com/nginx.example.com.key --cert ../sampleCerts/nginx.example.com/nginx.example.com.crt"
time="2022-05-11T13:59:23-04:00" level=info msg="Command output: \nsecret/nginx-server-certs created"
time="2022-05-11T13:59:23-04:00" level=info msg="Running command kubectl create -n bookinfo secret generic nginx-ca-certs --from-file=../sampleCerts/nginx.example.com/example.com.crt"
time="2022-05-11T13:59:23-04:00" level=info msg="Command output: \nsecret/nginx-ca-certs created"
time="2022-05-11T13:59:23-04:00" level=info msg="Create ConfigMap"
time="2022-05-11T13:59:23-04:00" level=info msg="Running command kubectl create configmap nginx-configmap --from-file=nginx.conf=../testdata/examples/x86/nginx/nginx_ssl.conf -n bookinfo"
time="2022-05-11T13:59:23-04:00" level=info msg="Command output: \nconfigmap/nginx-configmap created"
time="2022-05-11T13:59:28-04:00" level=info msg="Deploy Nginx"
time="2022-05-11T13:59:28-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/nginx/nginx.yaml"
time="2022-05-11T13:59:29-04:00" level=info msg="Command output: \nservice/my-nginx created\ndeployment.apps/my-nginx created"
time="2022-05-11T13:59:34-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T13:59:34-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm"
time="2022-05-11T13:59:34-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-2zdtm"
time="2022-05-11T13:59:34-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-2zdtm --no-headers"
time="2022-05-11T13:59:35-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm   0/2   ContainerCreating   0     33s"
time="2022-05-11T13:59:35-04:00" level=info msg="my-nginx-788f55df6d-2zdtm in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T14:00:05-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:00:05-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:00:05-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:00:05-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-2zdtm --no-headers"
time="2022-05-11T14:00:05-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm   0/2   ContainerCreating   0     36s"
time="2022-05-11T14:00:05-04:00" level=info msg="my-nginx-788f55df6d-2zdtm in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T14:00:35-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:00:35-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:00:35-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:00:35-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-2zdtm --no-headers"
time="2022-05-11T14:00:36-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm   1/2   ImagePullBackOff   0     94s"
time="2022-05-11T14:00:36-04:00" level=info msg="my-nginx-788f55df6d-2zdtm in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T14:01:06-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:01:08-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:01:08-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:01:08-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-2zdtm --no-headers"
time="2022-05-11T14:01:08-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm   1/2   ErrImagePull   0     98s"
time="2022-05-11T14:01:08-04:00" level=info msg="my-nginx-788f55df6d-2zdtm in namespace bookinfo is not running: ErrImagePull"
time="2022-05-11T14:01:38-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:01:38-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:01:38-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:01:38-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-2zdtm --no-headers"
time="2022-05-11T14:01:38-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm   1/2   ImagePullBackOff   0     2m9s"
time="2022-05-11T14:01:38-04:00" level=info msg="my-nginx-788f55df6d-2zdtm in namespace bookinfo is not running: ImagePullBackOff"
time="2022-05-11T14:02:08-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l run=my-nginx -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:02:09-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:02:09-04:00" level=info msg="run=my-nginx pod name: my-nginx-788f55df6d-2zdtm"
time="2022-05-11T14:02:09-04:00" level=info msg="Running command kubectl -n bookinfo get pods my-nginx-788f55df6d-2zdtm --no-headers"
time="2022-05-11T14:02:09-04:00" level=info msg="Command output: \nmy-nginx-788f55df6d-2zdtm   1/2   ErrImagePull   0     3m7s"
time="2022-05-11T14:02:09-04:00" level=info msg="my-nginx-788f55df6d-2zdtm in namespace bookinfo is not running: ErrImagePull"
=== RUN   T15/TrafficManagement_egress_gateway_perform_TLS_origination
time="2022-05-11T14:02:49-04:00" level=info msg="Perform TLS origination with an egress gateway"
time="2022-05-11T14:02:49-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply489553025.yaml"
time="2022-05-11T14:02:50-04:00" level=info msg="Command output: \nserviceentry.networking.istio.io/istio-io created"
time="2022-05-11T14:03:00-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-5kzcp -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - http://istio.io "
time="2022-05-11T14:03:10-04:00" level=info msg="Command output: \nHTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:58:24 GMT\r\nserver: envoy\r\n\r"
time="2022-05-11T14:03:10-04:00" level=info msg="Error response: HTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:58:24 GMT\r\nserver: envoy\r\n\r\n"
    egress_gateways_tls_file_mount.go:120: Error response: HTTP/1.1 503 Service Unavailable
        content-length: 84
        content-type: text/plain
        date: Wed, 11 May 2022 17:58:24 GMT
        server: envoy
        
time="2022-05-11T14:03:10-04:00" level=info msg="Create a Gateway to external istio.io"
time="2022-05-11T14:03:10-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply002674156.yaml"
time="2022-05-11T14:03:11-04:00" level=info msg="Command output: \ngateway.networking.istio.io/istio-egressgateway created\ndestinationrule.networking.istio.io/egressgateway-for-istio-io created\nvirtualservice.networking.istio.io/direct-istio-io-through-egress-gateway created\ndestinationrule.networking.istio.io/originate-tls-for-edition-istio-io created"
time="2022-05-11T14:03:31-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-5kzcp -n bookinfo -c sleep -- curl -sSL -o /dev/null -D - http://istio.io "
time="2022-05-11T14:04:02-04:00" level=info msg="Command output: \nHTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:59:15 GMT\r\nserver: envoy\r\nx-envoy-upstream-service-time: 30102\r\n\r"
time="2022-05-11T14:04:02-04:00" level=info msg="Error response: HTTP/1.1 503 Service Unavailable\r\ncontent-length: 84\r\ncontent-type: text/plain\r\ndate: Wed, 11 May 2022 17:59:15 GMT\r\nserver: envoy\r\nx-envoy-upstream-service-time: 30102\r\n\r\n"
    egress_gateways_tls_file_mount.go:132: Error response: HTTP/1.1 503 Service Unavailable
        content-length: 84
        content-type: text/plain
        date: Wed, 11 May 2022 17:59:15 GMT
        server: envoy
        x-envoy-upstream-service-time: 30102
        
time="2022-05-11T14:04:02-04:00" level=info msg="Cleanup the TLS origination example"
time="2022-05-11T14:04:02-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete835835995.yaml"
time="2022-05-11T14:04:02-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete375822846.yaml"
=== RUN   T15/TrafficManagement_egress_gateway_perform_MTLS_origination
time="2022-05-11T14:04:22-04:00" level=info msg="Redeploy the egress gateway with the client certs"
time="2022-05-11T14:04:22-04:00" level=info msg="Running command kubectl create -n istio-system secret tls nginx-client-certs --key ../sampleCerts/nginx.example.com/nginx-client.example.com.key --cert ../sampleCerts/nginx.example.com/nginx-client.example.com.crt"
time="2022-05-11T14:04:23-04:00" level=info msg="Command output: \nsecret/nginx-client-certs created"
time="2022-05-11T14:04:23-04:00" level=info msg="Running command kubectl create -n istio-system secret generic nginx-ca-certs --from-file=../sampleCerts/nginx.example.com/example.com.crt"
time="2022-05-11T14:04:23-04:00" level=info msg="Command output: \nsecret/nginx-ca-certs created"
time="2022-05-11T14:04:23-04:00" level=info msg="Patch egress gateway"
time="2022-05-11T14:04:23-04:00" level=info msg="Running command kubectl -n istio-system rollout history deploy istio-egressgateway"
time="2022-05-11T14:04:23-04:00" level=info msg="Command output: \ndeployment.apps/istio-egressgateway \nREVISION  CHANGE-CAUSE\n1         <none>\n2         <none>\n"
time="2022-05-11T14:04:23-04:00" level=info msg="Running command kubectl -n istio-system patch --type=json deploy istio-egressgateway -p='[{\"op\": \"add\",\"path\": \"/spec/template/spec/containers/0/volumeMounts/0\",\"value\": {\"mountPath\": \"/etc/istio/nginx-client-certs\",\"name\": \"nginx-client-certs\",\"readOnly\": true}},{\"op\": \"add\",\"path\": \"/spec/template/spec/volumes/0\",\"value\": {\"name\": \"nginx-client-certs\",\"secret\": {\"secretName\": \"nginx-client-certs\",\"optional\": true}}},{\"op\": \"add\",\"path\": \"/spec/template/spec/containers/0/volumeMounts/1\",\"value\": {\"mountPath\": \"/etc/istio/nginx-ca-certs\",\"name\": \"nginx-ca-certs\",\"readOnly\": true}},{\"op\": \"add\",\"path\": \"/spec/template/spec/volumes/1\",\"value\": {\"name\": \"nginx-ca-certs\",\"secret\": {\"secretName\": \"nginx-ca-certs\",\"optional\": true}}}]'"
time="2022-05-11T14:04:23-04:00" level=info msg="Command output: \ndeployment.apps/istio-egressgateway patched"
time="2022-05-11T14:04:43-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T14:04:44-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T14:04:44-04:00" level=info msg="Verify the istio-egressgateway pod"
time="2022-05-11T14:04:44-04:00" level=info msg="Running command kubectl exec -n istio-system \"$(kubectl -n istio-system get pods -l istio=egressgateway -o jsonpath='{.items[0].metadata.name}')\" -- ls -al /etc/istio/nginx-client-certs /etc/istio/nginx-ca-certs"
time="2022-05-11T14:04:44-04:00" level=info msg="Command output: \n/etc/istio/nginx-ca-certs:\ntotal 0\ndrwxrwsrwt. 3 root 1000630000 100 May 11 17:59 .\ndrwxr-xr-x. 1 root root       136 May 11 17:59 ..\ndrwxr-sr-x. 2 root 1000630000  60 May 11 17:59 ..2022_05_11_17_59_37.895541478\nlrwxrwxrwx. 1 root root        31 May 11 17:59 ..data -> ..2022_05_11_17_59_37.895541478\nlrwxrwxrwx. 1 root root        22 May 11 17:59 example.com.crt -> ..data/example.com.crt\n\n/etc/istio/nginx-client-certs:\ntotal 0\ndrwxrwsrwt. 3 root 1000630000 120 May 11 17:59 .\ndrwxr-xr-x. 1 root root       136 May 11 17:59 ..\ndrwxr-sr-x. 2 root 1000630000  80 May 11 17:59 ..2022_05_11_17_59_37.142049682\nlrwxrwxrwx. 1 root root        31 May 11 17:59 ..data -> ..2022_05_11_17_59_37.142049682\nlrwxrwxrwx. 1 root root        14 May 11 17:59 tls.crt -> ..data/tls.crt\nlrwxrwxrwx. 1 root root        14 May 11 17:59 tls.key -> ..data/tls.key"
time="2022-05-11T14:04:44-04:00" level=info msg="Running command kubectl -n istio-system rollout history deploy istio-egressgateway"
time="2022-05-11T14:04:45-04:00" level=info msg="Command output: \ndeployment.apps/istio-egressgateway \nREVISION  CHANGE-CAUSE\n1         <none>\n2         <none>\n3         <none>\n"
time="2022-05-11T14:04:45-04:00" level=info msg="Configure MTLS origination for egress traffic"
time="2022-05-11T14:04:45-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply463547205.yaml"
time="2022-05-11T14:04:46-04:00" level=info msg="Command output: \ngateway.networking.istio.io/istio-egressgateway created\ndestinationrule.networking.istio.io/egressgateway-for-nginx created\nvirtualservice.networking.istio.io/direct-nginx-through-egress-gateway created"
time="2022-05-11T14:05:06-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply014548960.yaml"
time="2022-05-11T14:05:06-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/originate-mtls-for-nginx created"
time="2022-05-11T14:05:16-04:00" level=info msg="Verify NGINX server"
    egress_gateways_tls_file_mount.go:174: Expected Welcome to nginx; Got unexpected response: no healthy upstream
time="2022-05-11T14:05:17-04:00" level=error msg="Expected Welcome to nginx; Got unexpected response: no healthy upstream"
time="2022-05-11T14:05:17-04:00" level=info msg=Cleanup
time="2022-05-11T14:05:17-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete844001215.yaml"
time="2022-05-11T14:05:17-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete643117586.yaml"
time="2022-05-11T14:05:17-04:00" level=info msg="Running command kubectl -n istio-system rollout undo deploy istio-egressgateway"
time="2022-05-11T14:05:17-04:00" level=info msg="Command output: \ndeployment.apps/istio-egressgateway rolled back"
time="2022-05-11T14:05:37-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T14:05:38-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T14:05:38-04:00" level=info msg="Running command kubectl -n istio-system rollout history deploy istio-egressgateway"
time="2022-05-11T14:05:38-04:00" level=info msg="Command output: \ndeployment.apps/istio-egressgateway \nREVISION  CHANGE-CAUSE\n1         <none>\n3         <none>\n4         <none>\n"
time="2022-05-11T14:05:38-04:00" level=info msg="Running command kubectl delete -n istio-system secret nginx-client-certs"
time="2022-05-11T14:05:38-04:00" level=info msg="Command output: \nsecret \"nginx-client-certs\" deleted"
time="2022-05-11T14:05:38-04:00" level=info msg="Running command kubectl delete -n istio-system secret nginx-ca-certs"
time="2022-05-11T14:05:39-04:00" level=info msg="Command output: \nsecret \"nginx-ca-certs\" deleted"
time="2022-05-11T14:05:39-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete909451849.yaml"
time="2022-05-11T14:05:39-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete014213396.yaml"
time="2022-05-11T14:05:39-04:00" level=info msg="Cleanup Nginx"
time="2022-05-11T14:05:39-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/nginx/nginx.yaml"
time="2022-05-11T14:05:39-04:00" level=info msg="Running command kubectl delete configmap nginx-configmap -n bookinfo"
time="2022-05-11T14:05:40-04:00" level=info msg="Command output: \nconfigmap \"nginx-configmap\" deleted"
time="2022-05-11T14:05:40-04:00" level=info msg="Running command kubectl delete secret nginx-server-certs -n bookinfo"
time="2022-05-11T14:05:40-04:00" level=info msg="Command output: \nsecret \"nginx-server-certs\" deleted"
time="2022-05-11T14:05:40-04:00" level=info msg="Running command kubectl delete secret nginx-ca-certs -n bookinfo"
time="2022-05-11T14:05:40-04:00" level=info msg="Command output: \nsecret \"nginx-ca-certs\" deleted"
time="2022-05-11T14:05:50-04:00" level=info msg="Removing Sleep on namespace bookinfo"
time="2022-05-11T14:05:50-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:05:51-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:05:51-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:05:51-04:00" level=info msg="Command error: exit status 1"
--- FAIL: T15 (416.29s)
    --- FAIL: T15/TrafficManagement_egress_gateway_perform_TLS_origination (93.39s)
    --- FAIL: T15/TrafficManagement_egress_gateway_perform_MTLS_origination (54.29s)
=== RUN   T16
time="2022-05-11T14:06:11-04:00" level=info msg="Test Egress Wildcard Hosts"
time="2022-05-11T14:06:11-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T14:06:11-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:06:12-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:06:12-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:06:17-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:06:17-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:06:17-04:00" level=info msg="Command output: \nsleep-6d646957b7-8vtbv"
time="2022-05-11T14:06:17-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-8vtbv"
=== RUN   T16/TrafficManagement_egress_direct_traffic_wildcard_host
time="2022-05-11T14:06:17-04:00" level=info msg="Configure direct traffic to a wildcard host"
time="2022-05-11T14:06:17-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply635082595.yaml"
time="2022-05-11T14:06:18-04:00" level=info msg="Command output: \nserviceentry.networking.istio.io/wikipedia created"
time="2022-05-11T14:06:28-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-8vtbv -n bookinfo -c sleep -- sh -c \"curl -s https://en.wikipedia.org/wiki/Main_Page | grep -o '<title>.*</title>'; curl -s https://de.wikipedia.org/wiki/Wikipedia:Hauptseite | grep -o '<title>.*</title>'\" "
time="2022-05-11T14:06:49-04:00" level=info msg="Command output: \ncommand terminated with exit code 1"
time="2022-05-11T14:06:49-04:00" level=info msg="Command error: exit status 1"
    common.go:37: Failed to get response. Error command failed: "command terminated with exit code 1\n" exit status 1
=== RUN   T16/TrafficManagement_egress_gateway_wildcard_host
time="2022-05-11T14:06:49-04:00" level=info msg="Configure egress gateway to a wildcard host"
time="2022-05-11T14:06:49-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply994217318.yaml"
time="2022-05-11T14:06:50-04:00" level=info msg="Command output: \ngateway.networking.istio.io/istio-egressgateway created\ndestinationrule.networking.istio.io/egressgateway-for-wikipedia created\nvirtualservice.networking.istio.io/direct-wikipedia-through-egress-gateway created\nserviceentry.networking.istio.io/www-wikipedia created"
time="2022-05-11T14:07:00-04:00" level=info msg="Running command kubectl exec sleep-6d646957b7-8vtbv -n bookinfo -c sleep -- sh -c \"curl -s https://en.wikipedia.org/wiki/Main_Page | grep -o '<title>.*</title>'; curl -s https://de.wikipedia.org/wiki/Wikipedia:Hauptseite | grep -o '<title>.*</title>'\" "
time="2022-05-11T14:07:21-04:00" level=info msg="Command output: \ncommand terminated with exit code 1"
time="2022-05-11T14:07:21-04:00" level=info msg="Command error: exit status 1"
    common.go:37: Failed to get response. Error command failed: "command terminated with exit code 1\n" exit status 1
time="2022-05-11T14:07:21-04:00" level=info msg=Cleanup
time="2022-05-11T14:07:21-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete285859725.yaml"
time="2022-05-11T14:07:21-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete468840328.yaml"
time="2022-05-11T14:07:21-04:00" level=info msg="Removing Sleep on namespace bookinfo"
time="2022-05-11T14:07:21-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:07:21-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:07:22-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:07:22-04:00" level=info msg="Command error: exit status 1"
--- FAIL: T16 (90.79s)
    --- FAIL: T16/TrafficManagement_egress_direct_traffic_wildcard_host (31.86s)
    --- FAIL: T16/TrafficManagement_egress_gateway_wildcard_host (31.55s)
=== RUN   T17
time="2022-05-11T14:07:42-04:00" level=info msg="Test External Certificates"
time="2022-05-11T14:07:42-04:00" level=info msg="Enable Control Plane MTLS"
=== RUN   T17/Security_plugging_external_cert_test
time="2022-05-11T14:07:42-04:00" level=info msg="Adding an external CA"
time="2022-05-11T14:07:42-04:00" level=info msg="Running command kubectl create -n istio-system secret generic cacerts --from-file=../sampleCerts/ca-cert.pem --from-file=../sampleCerts/ca-key.pem --from-file=../sampleCerts/root-cert.pem --from-file=../sampleCerts/cert-chain.pem"
time="2022-05-11T14:07:42-04:00" level=info msg="Command output: \nsecret/cacerts created"
time="2022-05-11T14:07:42-04:00" level=info msg="Running command kubectl -n istio-system patch smcp/istio-system --type=merge --patch=\"\nspec:\n  security:\n    dataPlane:\n      mtls: true\n    certificateAuthority:\n      type: Istiod\n      istiod:\n        type: PrivateKey\n        privateKey:\n          rootCADir: /etc/cacerts\n\""
time="2022-05-11T14:07:42-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T14:07:42-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T14:08:01-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T14:09:01-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T14:09:01-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T14:09:02-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T14:09:07-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:07-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-fb5hr"
time="2022-05-11T14:09:07-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-fb5hr"
time="2022-05-11T14:09:07-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-fb5hr --no-headers"
time="2022-05-11T14:09:08-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-fb5hr   0/2   ContainerCreating   0     33s"
time="2022-05-11T14:09:08-04:00" level=info msg="details-v1-6cd699df8c-fb5hr in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T14:09:38-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:39-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-fb5hr"
time="2022-05-11T14:09:39-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-fb5hr"
time="2022-05-11T14:09:39-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-fb5hr --no-headers"
time="2022-05-11T14:09:40-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-fb5hr   2/2   Running   0     65s"
time="2022-05-11T14:09:40-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T14:09:40-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:40-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-f7j8q"
time="2022-05-11T14:09:40-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-f7j8q"
time="2022-05-11T14:09:40-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-f7j8q --no-headers"
time="2022-05-11T14:09:40-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-f7j8q   2/2   Running   0     38s"
time="2022-05-11T14:09:40-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T14:09:40-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:40-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-sjbzc"
time="2022-05-11T14:09:40-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-sjbzc"
time="2022-05-11T14:09:40-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-sjbzc --no-headers"
time="2022-05-11T14:09:41-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-sjbzc   2/2   Running   0     38s"
time="2022-05-11T14:09:41-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T14:09:41-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:41-04:00" level=info msg="Command output: \nreviews-v2-675679877f-xrq9z"
time="2022-05-11T14:09:41-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-xrq9z"
time="2022-05-11T14:09:41-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-xrq9z --no-headers"
time="2022-05-11T14:09:41-04:00" level=info msg="Command output: \nreviews-v2-675679877f-xrq9z   2/2   Running   0     67s"
time="2022-05-11T14:09:41-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T14:09:41-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:42-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-gw8tc"
time="2022-05-11T14:09:42-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-gw8tc"
time="2022-05-11T14:09:42-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-gw8tc --no-headers"
time="2022-05-11T14:09:42-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-gw8tc   2/2   Running   0     39s"
time="2022-05-11T14:09:42-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T14:09:42-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:42-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-bkkjc"
time="2022-05-11T14:09:42-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-bkkjc"
time="2022-05-11T14:09:42-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-bkkjc --no-headers"
time="2022-05-11T14:09:43-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-bkkjc   2/2   Running   0     40s"
time="2022-05-11T14:09:43-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T14:09:43-04:00" level=info msg="Creating Gateway"
time="2022-05-11T14:09:43-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T14:09:43-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T14:09:43-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T14:09:43-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all-mtls.yaml"
time="2022-05-11T14:09:44-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
time="2022-05-11T14:09:54-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:09:55-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-bkkjc"
time="2022-05-11T14:09:55-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-bkkjc"
time="2022-05-11T14:09:55-04:00" level=info msg="Verify the new certificates"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command oc -n bookinfo exec productpage-v1-5ddcb4b84f-bkkjc -c istio-proxy -- openssl s_client -showcerts -connect details:9080 > /tmp/cacerts277219143/bookinfo-proxy-cert.txt"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command sed -n '/-----BEGIN CERTIFICATE-----/{:start /-----END CERTIFICATE-----/!{N;b start};/.*/p}' /tmp/cacerts277219143/bookinfo-proxy-cert.txt > /tmp/cacerts277219143/certs.pem"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command awk 'BEGIN {counter=0;} /BEGIN CERT/{counter++} { print > \"/tmp/cacerts277219143/proxy-cert-\" counter \".pem\"}' < /tmp/cacerts277219143/certs.pem"
time="2022-05-11T14:09:55-04:00" level=info msg="Verifying the root certificate"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command openssl x509 -in ../sampleCerts/root-cert.pem -text -noout > /tmp/cacerts277219143/root-cert.crt.txt"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command openssl x509 -in /tmp/cacerts277219143/proxy-cert-3.pem -text -noout > /tmp/cacerts277219143/pod-root-cert.crt.txt"
time="2022-05-11T14:09:55-04:00" level=info msg="Verifying the CA certificate"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command openssl x509 -in ../sampleCerts/ca-cert.pem -text -noout > /tmp/cacerts277219143/ca-cert.crt.txt"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command openssl x509 -in /tmp/cacerts277219143/proxy-cert-2.pem -text -noout > /tmp/cacerts277219143/pod-cert-chain-ca.crt.txt"
time="2022-05-11T14:09:55-04:00" level=info msg="Verifying the certificate chain"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command /bin/bash -c \"openssl verify -CAfile <(cat ../sampleCerts/ca-cert.pem ../sampleCerts/root-cert.pem) /tmp/cacerts277219143/proxy-cert-1.pem\""
time="2022-05-11T14:09:55-04:00" level=info msg=Cleanup
time="2022-05-11T14:09:55-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T14:09:55-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T14:09:56-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T14:10:08-04:00" level=info msg="Running command kubectl -n istio-system delete secret cacerts"
time="2022-05-11T14:10:08-04:00" level=info msg="Command output: \nsecret \"cacerts\" deleted"
time="2022-05-11T14:10:08-04:00" level=info msg="Running command kubectl -n istio-system patch smcp/istio-system --type=json -p='[{\"op\": \"remove\", \"path\": \"/spec/security/certificateAuthority\"}, {\"op\": \"remove\", \"path\": \"/spec/security/dataPlane\"}]'"
time="2022-05-11T14:10:08-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T14:10:08-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T14:10:25-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
--- PASS: T17 (222.97s)
    --- PASS: T17/Security_plugging_external_cert_test (133.50s)
=== RUN   T18
time="2022-05-11T14:11:25-04:00" level=info msg="Test Authentication Policy"
time="2022-05-11T14:11:25-04:00" level=info msg="Deploying Httpbin on namespace foo"
time="2022-05-11T14:11:25-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:11:27-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:11:27-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T14:11:37-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T14:11:37-04:00" level=info msg="Deploying Httpbin on namespace bar"
time="2022-05-11T14:11:37-04:00" level=info msg="Running command kubectl apply -n bar -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:11:38-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:11:38-04:00" level=info msg="Running command oc -n bar wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T14:11:49-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T14:11:49-04:00" level=info msg="Deploy Httpbin"
time="2022-05-11T14:11:49-04:00" level=info msg="Running command kubectl apply -n legacy -f ../testdata/examples/x86/httpbin/httpbin_legacy.yaml"
time="2022-05-11T14:11:50-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:11:55-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=httpbin -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:11:55-04:00" level=info msg="Command output: \nhttpbin-7f5b77797d-7prbv"
time="2022-05-11T14:11:55-04:00" level=info msg="app=httpbin pod name: httpbin-7f5b77797d-7prbv"
time="2022-05-11T14:11:55-04:00" level=info msg="Running command kubectl -n legacy get pods httpbin-7f5b77797d-7prbv --no-headers"
time="2022-05-11T14:11:55-04:00" level=info msg="Command output: \nhttpbin-7f5b77797d-7prbv   1/1   Running   0     34s"
time="2022-05-11T14:11:55-04:00" level=info msg="Got the pod name=app=httpbin running!"
time="2022-05-11T14:12:05-04:00" level=info msg="Deploying Sleep in namespace foo"
time="2022-05-11T14:12:05-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:12:06-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:12:06-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:12:13-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:12:13-04:00" level=info msg="Deploying Sleep in namespace bar"
time="2022-05-11T14:12:13-04:00" level=info msg="Running command kubectl apply -n bar -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:12:14-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:12:14-04:00" level=info msg="Running command oc -n bar wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:12:19-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:12:19-04:00" level=info msg="Deploy Sleep"
time="2022-05-11T14:12:19-04:00" level=info msg="Running command kubectl apply -n legacy -f ../testdata/examples/x86/sleep/sleep_legacy.yaml"
time="2022-05-11T14:12:20-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:12:25-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:12:25-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:12:25-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:12:25-04:00" level=info msg="Running command kubectl -n legacy get pods sleep-557747455f-6q5p2 --no-headers"
time="2022-05-11T14:12:25-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2   1/1   Running   0     32s"
time="2022-05-11T14:12:25-04:00" level=info msg="Got the pod name=app=sleep running!"
time="2022-05-11T14:12:35-04:00" level=info msg="Verify setup"
time="2022-05-11T14:12:35-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:12:35-04:00" level=info msg="Command output: \nsleep-6d646957b7-bqv4h"
time="2022-05-11T14:12:35-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-bqv4h"
time="2022-05-11T14:12:36-04:00" level=info msg="Success. Get expected response: sleep.foo to httpbin.foo: 200"
time="2022-05-11T14:12:36-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:12:36-04:00" level=info msg="Command output: \nsleep-6d646957b7-bqv4h"
time="2022-05-11T14:12:36-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-bqv4h"
time="2022-05-11T14:12:37-04:00" level=info msg="Success. Get expected response: sleep.foo to httpbin.bar: 200"
time="2022-05-11T14:12:37-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:12:37-04:00" level=info msg="Command output: \nsleep-6d646957b7-27wmt"
time="2022-05-11T14:12:37-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-27wmt"
time="2022-05-11T14:12:37-04:00" level=info msg="Success. Get expected response: sleep.bar to httpbin.foo: 200"
time="2022-05-11T14:12:37-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:12:38-04:00" level=info msg="Command output: \nsleep-6d646957b7-27wmt"
time="2022-05-11T14:12:38-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-27wmt"
time="2022-05-11T14:12:38-04:00" level=info msg="Success. Get expected response: sleep.bar to httpbin.bar: 200"
time="2022-05-11T14:12:38-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:12:38-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:12:38-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:12:39-04:00" level=info msg="Success. Get expected response: sleep.legacy to httpbin.foo: 200"
time="2022-05-11T14:12:39-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:12:39-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:12:39-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:12:40-04:00" level=info msg="Success. Get expected response: sleep.legacy to httpbin.bar: 200"
time="2022-05-11T14:12:40-04:00" level=info msg="Verify peer authentication policy"
time="2022-05-11T14:12:40-04:00" level=info msg="Running command kubectl get peerauthentication --all-namespaces"
time="2022-05-11T14:12:40-04:00" level=info msg="Command output: \nNAMESPACE      NAME                            MODE         AGE\nistio-system   default                         PERMISSIVE   55m\nistio-system   disable-mtls-jaeger-collector   DISABLE      53m\nistio-system   grafana-ports-mtls-disabled     PERMISSIVE   53m"
time="2022-05-11T14:12:40-04:00" level=info msg="Verify destination rules"
time="2022-05-11T14:12:40-04:00" level=info msg="Running command kubectl get destinationrules.networking.istio.io --all-namespaces -o yaml | grep \"host:\""
time="2022-05-11T14:12:43-04:00" level=info msg="Command output: \nI0511 14:12:41.823459   15840 request.go:655] Throttling request took 1.065420578s, request: GET:https://api.openupi.noiro.local:6443/apis/networking.istio.io/v1alpha3?timeout=32s\n          f:host: {}\n    host: kubernetes.default.svc.cluster.local\n          f:host: {}\n    host: '*.local'\n          f:host: {}\n    host: jaeger-collector.istio-system.svc\n          f:host: {}\n    host: zipkin\n          f:host: {}\n    host: istiod-istio-system.istio-system.svc.cluster.local\n          f:host: {}\n    host: wasm-cacher-istio-system.istio-system.svc.cluster.local"
=== RUN   T18/Security_authentication_auto_mTLS
time="2022-05-11T14:12:43-04:00" level=info msg="Auto mutual TLS"
time="2022-05-11T14:12:43-04:00" level=info msg="Running command kubectl exec $(kubectl get pod -l app=sleep -n foo -o jsonpath={.items..metadata.name}) -c sleep -n foo -- curl http://httpbin.foo:8000/headers -s | grep X-Forwarded-Client-Cert | sed 's/Hash=[a-z0-9]*;/Hash=<redacted>;/'"
time="2022-05-11T14:12:44-04:00" level=info msg="Command output: \n    \"X-Forwarded-Client-Cert\": \"By=spiffe://cluster.local/ns/foo/sa/httpbin;Hash=<redacted>;Subject=\\\"\\\";URI=spiffe://cluster.local/ns/foo/sa/sleep\""
time="2022-05-11T14:12:44-04:00" level=info msg="Running command kubectl exec $(kubectl get pod -l app=sleep -n foo -o jsonpath={.items..metadata.name}) -c sleep -n foo -- curl http://httpbin.legacy:8000/headers -s | grep X-Forwarded-Client-Cert"
=== RUN   T18/Security_authentication_enable_global_mTLS_STRICT_mode
time="2022-05-11T14:12:51-04:00" level=info msg="Globally enabling Istio mutual TLS in STRICT mode"
time="2022-05-11T14:12:51-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply641026554.yaml"
time="2022-05-11T14:12:52-04:00" level=info msg="Command output: \npeerauthentication.security.istio.io/default configured"
time="2022-05-11T14:12:52-04:00" level=info msg="Waiting for rules to propagate. Sleep 30 seconds..."
time="2022-05-11T14:13:22-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:13:22-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:13:22-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:13:22-04:00" level=info msg="Response 000 as expected: sleep.legacy to httpbin.foo: 000command terminated with exit code 56\n"
time="2022-05-11T14:13:22-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:13:23-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:13:23-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:13:23-04:00" level=info msg="Response 000 as expected: sleep.legacy to httpbin.bar: 000command terminated with exit code 56\n"
time="2022-05-11T14:13:23-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete092422417.yaml"
=== RUN   T18/Security_authentication_namespace_policy_mtls
time="2022-05-11T14:13:53-04:00" level=info msg="Enable mutual TLS per namespace"
time="2022-05-11T14:13:53-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply672986940.yaml"
time="2022-05-11T14:13:54-04:00" level=info msg="Command output: \npeerauthentication.security.istio.io/default created"
time="2022-05-11T14:14:04-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:04-04:00" level=info msg="Command output: \nsleep-6d646957b7-bqv4h"
time="2022-05-11T14:14:04-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-bqv4h"
time="2022-05-11T14:14:05-04:00" level=info msg="Success. Get expected response: sleep.foo to httpbin.foo: 200"
time="2022-05-11T14:14:05-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:05-04:00" level=info msg="Command output: \nsleep-6d646957b7-bqv4h"
time="2022-05-11T14:14:05-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-bqv4h"
time="2022-05-11T14:14:05-04:00" level=info msg="Success. Get expected response: sleep.foo to httpbin.bar: 200"
time="2022-05-11T14:14:05-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:06-04:00" level=info msg="Command output: \nsleep-6d646957b7-27wmt"
time="2022-05-11T14:14:06-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-27wmt"
time="2022-05-11T14:14:06-04:00" level=info msg="Success. Get expected response: sleep.bar to httpbin.foo: 200"
time="2022-05-11T14:14:06-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:06-04:00" level=info msg="Command output: \nsleep-6d646957b7-27wmt"
time="2022-05-11T14:14:06-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-27wmt"
time="2022-05-11T14:14:07-04:00" level=info msg="Success. Get expected response: sleep.bar to httpbin.bar: 200"
time="2022-05-11T14:14:07-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:07-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:14:07-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:14:08-04:00" level=info msg="Expected fail from sleep.legacy to httpbin.foo: command failed: \"sleep.legacy to httpbin.foo: 000command terminated with exit code 56\\n\" exit status 56"
time="2022-05-11T14:14:08-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:08-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:14:08-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:14:08-04:00" level=info msg="Success. Get expected response: sleep.legacy to httpbin.bar: 200"
time="2022-05-11T14:14:08-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete489000811.yaml"
=== RUN   T18/Security_authentication_workload_policy_mtls
time="2022-05-11T14:14:09-04:00" level=info msg="Enable mutual TLS per workload"
time="2022-05-11T14:14:09-04:00" level=info msg="Running command kubectl apply -n bar -f /tmp/kubeapply160201678.yaml"
time="2022-05-11T14:14:09-04:00" level=info msg="Command output: \npeerauthentication.security.istio.io/httpbin created\ndestinationrule.networking.istio.io/httpbin created"
time="2022-05-11T14:14:19-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:20-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:14:20-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:14:20-04:00" level=info msg="Expected fail from sleep.legacy to httpbin.bar: command failed: \"sleep.legacy to httpbin.bar: 000command terminated with exit code 56\\n\" exit status 56"
time="2022-05-11T14:14:20-04:00" level=info msg="Refine mutual TLS per port"
time="2022-05-11T14:14:20-04:00" level=info msg="Running command kubectl apply -n bar -f /tmp/kubeapply120505557.yaml"
time="2022-05-11T14:14:21-04:00" level=info msg="Command output: \npeerauthentication.security.istio.io/httpbin configured\ndestinationrule.networking.istio.io/httpbin configured"
time="2022-05-11T14:14:31-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:31-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:14:31-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:14:32-04:00" level=info msg="Expected 200 from sleep.legacy to httpbin.bar: sleep.legacy to httpbin.bar: 200"
time="2022-05-11T14:14:32-04:00" level=info msg="Running command kubectl delete -n bar -f /tmp/kubedelete337545776.yaml"
time="2022-05-11T14:14:32-04:00" level=info msg="Running command kubectl delete -n bar -f /tmp/kubedelete494440399.yaml"
=== RUN   T18/Security_authentication_policy_precedence_mtls
time="2022-05-11T14:14:32-04:00" level=info msg="Overwrite foo namespace policy by a workload policy"
time="2022-05-11T14:14:32-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply030356194.yaml"
time="2022-05-11T14:14:33-04:00" level=info msg="Command output: \npeerauthentication.security.istio.io/overwrite-example created\ndestinationrule.networking.istio.io/overwrite-example created"
time="2022-05-11T14:14:43-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:14:43-04:00" level=info msg="Command output: \nsleep-557747455f-6q5p2"
time="2022-05-11T14:14:43-04:00" level=info msg="app=sleep pod name: sleep-557747455f-6q5p2"
time="2022-05-11T14:14:44-04:00" level=info msg="Success. Get expected response: sleep.legacy to httpbin.foo: 200"
time="2022-05-11T14:14:44-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete201985241.yaml"
=== RUN   T18/Security_authentication_end-user_JWT
time="2022-05-11T14:14:44-04:00" level=info msg="End-user authentication"
time="2022-05-11T14:14:44-04:00" level=info msg="Apply httpbin gateway"
time="2022-05-11T14:14:44-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply291749476.yaml"
time="2022-05-11T14:14:45-04:00" level=info msg="Command output: \ngateway.networking.istio.io/httpbin-gateway created\nvirtualservice.networking.istio.io/httpbin created"
time="2022-05-11T14:15:05-04:00" level=info msg="Running command curl istio-ingressgateway-istio-system.apps.openupi.noiro.local/headers -s -o /dev/null -w \"%{http_code}\\n\""
time="2022-05-11T14:17:15-04:00" level=info msg="Command output: \n000"
time="2022-05-11T14:17:15-04:00" level=info msg="Command error: exit status 7"
    common.go:37: Failed to get httpbin header response. Error command failed: "000\n" exit status 7
=== RUN   T18/Security_authentication_end-user_require_JWT
time="2022-05-11T14:17:15-04:00" level=info msg="Require a valid token"
time="2022-05-11T14:17:15-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply322252915.yaml"
time="2022-05-11T14:17:15-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/frontend-ingress created"
time="2022-05-11T14:17:35-04:00" level=info msg="Running command curl istio-ingressgateway-istio-system.apps.openupi.noiro.local/headers -s -o /dev/null -w \"%{http_code}\\n\""
time="2022-05-11T14:19:46-04:00" level=info msg="Command output: \n000"
time="2022-05-11T14:19:46-04:00" level=info msg="Command error: exit status 7"
    common.go:37: Failed to get httpbin header response. Error command failed: "000\n" exit status 7
time="2022-05-11T14:19:46-04:00" level=info msg=Cleanup
time="2022-05-11T14:19:46-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete416147766.yaml"
time="2022-05-11T14:19:46-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete717607709.yaml"
time="2022-05-11T14:19:47-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete631036888.yaml"
time="2022-05-11T14:19:47-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete696527191.yaml"
time="2022-05-11T14:19:47-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete004154570.yaml"
time="2022-05-11T14:19:47-04:00" level=info msg="Running command kubectl delete -n bar -f /tmp/kubedelete876220833.yaml"
time="2022-05-11T14:19:47-04:00" level=info msg="Running command kubectl delete -n bar -f /tmp/kubedelete206610572.yaml"
time="2022-05-11T14:19:48-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete063471739.yaml"
time="2022-05-11T14:19:48-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete452784030.yaml"
time="2022-05-11T14:19:48-04:00" level=info msg="Removing Sleep on namespace foo"
time="2022-05-11T14:19:48-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:19:48-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:19:49-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:19:49-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:19:49-04:00" level=info msg="Removing Httpbin on namespace foo"
time="2022-05-11T14:19:49-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:19:49-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T14:19:57-04:00" level=info msg="Command output: \npod/httpbin-599849d486-kczgv condition met"
time="2022-05-11T14:19:57-04:00" level=info msg="Removing Sleep on namespace bar"
time="2022-05-11T14:19:57-04:00" level=info msg="Running command kubectl delete -n bar -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:19:57-04:00" level=info msg="Running command oc -n bar wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:19:57-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:19:57-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:19:57-04:00" level=info msg="Removing Httpbin on namespace bar"
time="2022-05-11T14:19:57-04:00" level=info msg="Running command kubectl delete -n bar -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:19:58-04:00" level=info msg="Running command oc -n bar wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T14:20:13-04:00" level=info msg="Command output: \npod/httpbin-599849d486-j4n9z condition met"
time="2022-05-11T14:20:13-04:00" level=info msg="Removing Sleep on namespace legacy"
time="2022-05-11T14:20:13-04:00" level=info msg="Running command kubectl delete -n legacy -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:20:13-04:00" level=info msg="Running command oc -n legacy wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:20:13-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:20:13-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:20:13-04:00" level=info msg="Removing Httpbin on namespace legacy"
time="2022-05-11T14:20:13-04:00" level=info msg="Running command kubectl delete -n legacy -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:20:13-04:00" level=info msg="Running command oc -n legacy wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T14:20:17-04:00" level=info msg="Command output: \npod/httpbin-7f5b77797d-7prbv condition met"
--- FAIL: T18 (552.34s)
    --- PASS: T18/Security_authentication_auto_mTLS (7.63s)
    --- PASS: T18/Security_authentication_enable_global_mTLS_STRICT_mode (62.56s)
    --- PASS: T18/Security_authentication_namespace_policy_mtls (15.08s)
    --- PASS: T18/Security_authentication_workload_policy_mtls (23.51s)
    --- PASS: T18/Security_authentication_policy_precedence_mtls (11.86s)
    --- FAIL: T18/Security_authentication_end-user_JWT (150.82s)
    --- FAIL: T18/Security_authentication_end-user_require_JWT (151.55s)
=== RUN   T19
time="2022-05-11T14:20:37-04:00" level=info msg="Mutual TLS Migration"
time="2022-05-11T14:20:37-04:00" level=info msg="Deploying Httpbin on namespace foo"
time="2022-05-11T14:20:37-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:20:38-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:20:38-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T14:20:44-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T14:20:44-04:00" level=info msg="Deploying Httpbin on namespace bar"
time="2022-05-11T14:20:44-04:00" level=info msg="Running command kubectl apply -n bar -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:20:45-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:20:45-04:00" level=info msg="Running command oc -n bar wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T14:20:51-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T14:20:51-04:00" level=info msg="Deploying Sleep in namespace foo"
time="2022-05-11T14:20:51-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:20:51-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:20:51-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:20:57-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:20:57-04:00" level=info msg="Deploying Sleep in namespace bar"
time="2022-05-11T14:20:57-04:00" level=info msg="Running command kubectl apply -n bar -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:20:58-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:20:58-04:00" level=info msg="Running command oc -n bar wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:21:04-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:21:04-04:00" level=info msg="Deploy Sleep"
time="2022-05-11T14:21:04-04:00" level=info msg="Running command kubectl apply -n legacy -f ../testdata/examples/x86/sleep/sleep_legacy.yaml"
time="2022-05-11T14:21:05-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:21:10-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:10-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj"
time="2022-05-11T14:21:10-04:00" level=info msg="app=sleep pod name: sleep-557747455f-4gbzj"
time="2022-05-11T14:21:10-04:00" level=info msg="Running command kubectl -n legacy get pods sleep-557747455f-4gbzj --no-headers"
time="2022-05-11T14:21:10-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj   1/1   Running   0     5s"
time="2022-05-11T14:21:10-04:00" level=info msg="Got the pod name=app=sleep running!"
time="2022-05-11T14:21:20-04:00" level=info msg="Verify setup"
time="2022-05-11T14:21:20-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:21-04:00" level=info msg="Command output: \nsleep-6d646957b7-kzwg8"
time="2022-05-11T14:21:21-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-kzwg8"
time="2022-05-11T14:21:21-04:00" level=info msg="Success. Get expected response: sleep.foo to httpbin.foo: 200"
time="2022-05-11T14:21:21-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:21-04:00" level=info msg="Command output: \nsleep-6d646957b7-kzwg8"
time="2022-05-11T14:21:21-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-kzwg8"
time="2022-05-11T14:21:22-04:00" level=info msg="Success. Get expected response: sleep.foo to httpbin.bar: 200"
time="2022-05-11T14:21:22-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:22-04:00" level=info msg="Command output: \nsleep-6d646957b7-sd57g"
time="2022-05-11T14:21:22-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-sd57g"
time="2022-05-11T14:21:23-04:00" level=info msg="Success. Get expected response: sleep.bar to httpbin.foo: 200"
time="2022-05-11T14:21:23-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:23-04:00" level=info msg="Command output: \nsleep-6d646957b7-sd57g"
time="2022-05-11T14:21:23-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-sd57g"
time="2022-05-11T14:21:23-04:00" level=info msg="Success. Get expected response: sleep.bar to httpbin.bar: 200"
time="2022-05-11T14:21:23-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:24-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj"
time="2022-05-11T14:21:24-04:00" level=info msg="app=sleep pod name: sleep-557747455f-4gbzj"
time="2022-05-11T14:21:24-04:00" level=info msg="Success. Get expected response: sleep.legacy to httpbin.foo: 200"
time="2022-05-11T14:21:24-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:24-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj"
time="2022-05-11T14:21:24-04:00" level=info msg="app=sleep pod name: sleep-557747455f-4gbzj"
time="2022-05-11T14:21:25-04:00" level=info msg="Success. Get expected response: sleep.legacy to httpbin.bar: 200"
=== RUN   T19/Security_authentication_namespace_enable_mtls
time="2022-05-11T14:21:25-04:00" level=info msg="Lock down to mutual TLS by namespace"
time="2022-05-11T14:21:25-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply749273701.yaml"
time="2022-05-11T14:21:26-04:00" level=info msg="Command output: \npeerauthentication.security.istio.io/default created"
time="2022-05-11T14:21:36-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:36-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj"
time="2022-05-11T14:21:36-04:00" level=info msg="app=sleep pod name: sleep-557747455f-4gbzj"
time="2022-05-11T14:21:36-04:00" level=info msg="Expected fail from sleep.legacy to httpbin.foo: command failed: \"sleep.legacy to httpbin.foo: 000command terminated with exit code 56\\n\" exit status 56"
time="2022-05-11T14:21:36-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:21:37-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj"
time="2022-05-11T14:21:37-04:00" level=info msg="app=sleep pod name: sleep-557747455f-4gbzj"
time="2022-05-11T14:21:37-04:00" level=info msg="Success. Get expected response: sleep.legacy to httpbin.bar: 200"
=== RUN   T19/Security_authentication_globally_enable_mtls
time="2022-05-11T14:21:37-04:00" level=info msg="Lock down to mutual TLS for the entire mesh"
time="2022-05-11T14:21:37-04:00" level=info msg="Running command kubectl apply -n istio-system -f /tmp/kubeapply001748096.yaml"
time="2022-05-11T14:21:38-04:00" level=info msg="Command output: \npeerauthentication.security.istio.io/default created"
time="2022-05-11T14:22:08-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:22:08-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj"
time="2022-05-11T14:22:08-04:00" level=info msg="app=sleep pod name: sleep-557747455f-4gbzj"
time="2022-05-11T14:22:09-04:00" level=info msg="Expected sleep.legacy to httpbin.foo fails: command failed: \"sleep.legacy to httpbin.foo: 000command terminated with exit code 56\\n\" exit status 56"
time="2022-05-11T14:22:09-04:00" level=info msg="Running command kubectl -n legacy get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:22:09-04:00" level=info msg="Command output: \nsleep-557747455f-4gbzj"
time="2022-05-11T14:22:09-04:00" level=info msg="app=sleep pod name: sleep-557747455f-4gbzj"
time="2022-05-11T14:22:09-04:00" level=info msg="Expected sleep.legacy to httpbin.bar fails: command failed: \"sleep.legacy to httpbin.bar: 000command terminated with exit code 56\\n\" exit status 56"
time="2022-05-11T14:22:09-04:00" level=info msg=Cleanup
time="2022-05-11T14:22:09-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete818607071.yaml"
time="2022-05-11T14:22:10-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete523703218.yaml"
time="2022-05-11T14:22:10-04:00" level=info msg="Removing Sleep on namespace foo"
time="2022-05-11T14:22:10-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:22:10-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:22:10-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:22:10-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:22:10-04:00" level=info msg="Removing Httpbin on namespace foo"
time="2022-05-11T14:22:10-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:22:11-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T14:22:23-04:00" level=info msg="Command output: \npod/httpbin-599849d486-sgrxt condition met"
time="2022-05-11T14:22:23-04:00" level=info msg="Removing Sleep on namespace bar"
time="2022-05-11T14:22:23-04:00" level=info msg="Running command kubectl delete -n bar -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:22:23-04:00" level=info msg="Running command oc -n bar wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:22:23-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:22:23-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:22:23-04:00" level=info msg="Removing Httpbin on namespace bar"
time="2022-05-11T14:22:23-04:00" level=info msg="Running command kubectl delete -n bar -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:22:24-04:00" level=info msg="Running command oc -n bar wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T14:22:31-04:00" level=info msg="Command output: \npod/httpbin-599849d486-7gb2n condition met"
time="2022-05-11T14:22:31-04:00" level=info msg="Removing Sleep on namespace legacy"
time="2022-05-11T14:22:31-04:00" level=info msg="Running command kubectl delete -n legacy -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:22:31-04:00" level=info msg="Running command oc -n legacy wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:22:32-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:22:32-04:00" level=info msg="Command error: exit status 1"
--- PASS: T19 (134.61s)
    --- PASS: T19/Security_authentication_namespace_enable_mtls (12.39s)
    --- PASS: T19/Security_authentication_globally_enable_mtls (32.26s)
=== RUN   T20
time="2022-05-11T14:22:52-04:00" level=info msg="Authorization for HTTP traffic"
time="2022-05-11T14:22:52-04:00" level=info msg="Enable Control Plane MTLS"
time="2022-05-11T14:22:52-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":true},\"controlPlane\":{\"mtls\":true}}}}'"
time="2022-05-11T14:22:55-04:00" level=info msg="Command output: \nI0511 14:22:53.410894   16590 request.go:655] Throttling request took 1.138469278s, request: GET:https://api.openupi.noiro.local:6443/apis/helm.openshift.io/v1beta1?timeout=32s\nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T14:22:55-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T14:23:08-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T14:23:08-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T14:23:08-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T14:23:10-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T14:23:15-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:23:15-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-g5gs9"
time="2022-05-11T14:23:15-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-g5gs9"
time="2022-05-11T14:23:15-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-g5gs9 --no-headers"
time="2022-05-11T14:23:16-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-g5gs9   0/2   ContainerCreating   0     5s"
time="2022-05-11T14:23:16-04:00" level=info msg="details-v1-6cd699df8c-g5gs9 in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T14:23:46-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:23:46-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-g5gs9"
time="2022-05-11T14:23:46-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-g5gs9"
time="2022-05-11T14:23:46-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-g5gs9 --no-headers"
time="2022-05-11T14:23:46-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-g5gs9   2/2   Running   0     36s"
time="2022-05-11T14:23:46-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T14:23:46-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:23:47-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-bvktc"
time="2022-05-11T14:23:47-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-bvktc"
time="2022-05-11T14:23:47-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-bvktc --no-headers"
time="2022-05-11T14:23:47-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-bvktc   2/2   Running   0     65s"
time="2022-05-11T14:23:47-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T14:23:47-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:23:47-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-7cl25"
time="2022-05-11T14:23:47-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-7cl25"
time="2022-05-11T14:23:47-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-7cl25 --no-headers"
time="2022-05-11T14:23:47-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-7cl25   2/2   Running   0     65s"
time="2022-05-11T14:23:47-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T14:23:47-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:23:48-04:00" level=info msg="Command output: \nreviews-v2-675679877f-mvm98"
time="2022-05-11T14:23:48-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-mvm98"
time="2022-05-11T14:23:48-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-mvm98 --no-headers"
time="2022-05-11T14:23:48-04:00" level=info msg="Command output: \nreviews-v2-675679877f-mvm98   2/2   Running   0     37s"
time="2022-05-11T14:23:48-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T14:23:48-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:23:48-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-w44dj"
time="2022-05-11T14:23:48-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-w44dj"
time="2022-05-11T14:23:48-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-w44dj --no-headers"
time="2022-05-11T14:23:48-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-w44dj   2/2   Running   0     38s"
time="2022-05-11T14:23:48-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T14:23:48-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:23:49-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-kw45h"
time="2022-05-11T14:23:49-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-kw45h"
time="2022-05-11T14:23:49-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-kw45h --no-headers"
time="2022-05-11T14:23:49-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-kw45h   2/2   Running   0     65s"
time="2022-05-11T14:23:49-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T14:23:49-04:00" level=info msg="Creating Gateway"
time="2022-05-11T14:23:49-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T14:23:50-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T14:23:50-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T14:23:50-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all-mtls.yaml"
time="2022-05-11T14:23:51-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
=== RUN   T20/Security_authorization_rbac_deny_all_http
time="2022-05-11T14:24:01-04:00" level=info msg="Configure access control for workloads using HTTP traffic"
time="2022-05-11T14:24:01-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply169049449.yaml"
time="2022-05-11T14:24:02-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/allow-nothing created"
    common.go:37: Failed to get HTTP Response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/productpage": dial tcp 151.9.1.21:80: i/o timeout
=== RUN   T20/Security_authorization_rbac_allow_GET_http
time="2022-05-11T14:24:42-04:00" level=info msg="Allow access with GET method to the productpage workload"
time="2022-05-11T14:24:42-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply013671348.yaml"
time="2022-05-11T14:24:43-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/productpage-viewer created"
    common.go:37: Failed to get HTTP Response. Error Get "http://istio-ingressgateway-istio-system.apps.openupi.noiro.local/productpage": dial tcp 151.9.1.21:80: i/o timeout
time="2022-05-11T14:25:53-04:00" level=info msg=Cleanup
time="2022-05-11T14:25:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete951733635.yaml"
time="2022-05-11T14:25:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete474975494.yaml"
time="2022-05-11T14:25:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete442642093.yaml"
time="2022-05-11T14:25:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete463062056.yaml"
time="2022-05-11T14:25:53-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete256760167.yaml"
time="2022-05-11T14:26:14-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T14:26:14-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T14:26:14-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T14:26:14-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T14:26:26-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":false},\"controlPlane\":{\"mtls\":false}}}}'"
time="2022-05-11T14:26:26-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T14:26:26-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T14:26:50-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
--- FAIL: T20 (258.09s)
    --- FAIL: T20/Security_authorization_rbac_deny_all_http (40.89s)
    --- FAIL: T20/Security_authorization_rbac_allow_GET_http (70.82s)
=== RUN   T21
time="2022-05-11T14:27:10-04:00" level=info msg="Authorization for TCP traffic"
time="2022-05-11T14:27:10-04:00" level=info msg="Deploying Sleep in namespace foo"
time="2022-05-11T14:27:10-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:27:11-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:27:11-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:27:16-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:27:16-04:00" level=info msg="Deploy Echo"
time="2022-05-11T14:27:16-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/tcp-echo/tcp-echo.yaml"
time="2022-05-11T14:27:17-04:00" level=info msg="Command output: \nservice/tcp-echo created\ndeployment.apps/tcp-echo created"
time="2022-05-11T14:27:22-04:00" level=info msg="Running command kubectl -n foo get pod -l app=tcp-echo,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:27:22-04:00" level=info msg="Command output: \ntcp-echo-567c9458b8-rdt47"
time="2022-05-11T14:27:22-04:00" level=info msg="app=tcp-echo,version=v1 pod name: tcp-echo-567c9458b8-rdt47"
time="2022-05-11T14:27:22-04:00" level=info msg="Running command kubectl -n foo get pods tcp-echo-567c9458b8-rdt47 --no-headers"
time="2022-05-11T14:27:23-04:00" level=info msg="Command output: \ntcp-echo-567c9458b8-rdt47   1/2   Running   0     5s"
time="2022-05-11T14:27:23-04:00" level=info msg="Got the pod name=app=tcp-echo,version=v1 running!"
time="2022-05-11T14:27:53-04:00" level=info msg="Verify echo hello port"
time="2022-05-11T14:27:53-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:27:53-04:00" level=info msg="Command output: \nsleep-6d646957b7-pr8kq"
time="2022-05-11T14:27:53-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-pr8kq"
time="2022-05-11T14:27:53-04:00" level=info msg="Success. Get expected response: hello port 9000\nconnection succeeded\n"
time="2022-05-11T14:27:54-04:00" level=info msg="Success. Get expected response: hello port 9001\nconnection succeeded\n"
time="2022-05-11T14:27:54-04:00" level=info msg="Running command kubectl -n foo get pod -l app=tcp-echo -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:27:54-04:00" level=info msg="Command output: \ntcp-echo-567c9458b8-rdt47"
time="2022-05-11T14:27:54-04:00" level=info msg="app=tcp-echo pod name: tcp-echo-567c9458b8-rdt47"
time="2022-05-11T14:27:54-04:00" level=info msg="Running command kubectl get pod tcp-echo-567c9458b8-rdt47 -n foo -o jsonpath=\"{.status.podIP}\""
time="2022-05-11T14:27:54-04:00" level=info msg="Command output: \n15.128.0.231"
time="2022-05-11T14:27:55-04:00" level=info msg="Success. Get expected response: hello port 9002\nconnection succeeded\n"
=== RUN   T21/Security_authorization_rbac_allow_GET_tcp
time="2022-05-11T14:27:55-04:00" level=info msg="Apply a policy to allow requests to port 9000 and 9001"
time="2022-05-11T14:27:55-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply125189530.yaml"
time="2022-05-11T14:27:55-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/tcp-policy created"
time="2022-05-11T14:28:06-04:00" level=info msg="Success. Get expected response: hello port 9000\nconnection succeeded\n"
time="2022-05-11T14:28:06-04:00" level=info msg="Success. Get expected response: hello port 9001\nconnection succeeded\n"
time="2022-05-11T14:28:06-04:00" level=info msg="Running command kubectl -n foo get pod -l app=tcp-echo -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:28:07-04:00" level=info msg="Command output: \ntcp-echo-567c9458b8-rdt47"
time="2022-05-11T14:28:07-04:00" level=info msg="app=tcp-echo pod name: tcp-echo-567c9458b8-rdt47"
time="2022-05-11T14:28:07-04:00" level=info msg="Running command kubectl get pod tcp-echo-567c9458b8-rdt47 -n foo -o jsonpath=\"{.status.podIP}\""
time="2022-05-11T14:28:07-04:00" level=info msg="Command output: \n15.128.0.231"
time="2022-05-11T14:28:07-04:00" level=info msg="Success. Get expected response: connection rejected\n"
=== RUN   T21/Security_authorization_rbac_invalid_policy_tcp
time="2022-05-11T14:28:07-04:00" level=info msg="Apply a policy to allow requests to port 9000 and add an HTTP GET field"
time="2022-05-11T14:28:07-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply727560753.yaml"
time="2022-05-11T14:28:08-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/tcp-policy configured"
time="2022-05-11T14:28:18-04:00" level=info msg="Success. Get expected response: connection rejected\n"
time="2022-05-11T14:28:19-04:00" level=info msg="Success. Get expected response: connection rejected\n"
=== RUN   T21/Security_authorization_rbac_deny_GET_tcp
time="2022-05-11T14:28:19-04:00" level=info msg="Apply a DENY policy"
time="2022-05-11T14:28:19-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply737773020.yaml"
time="2022-05-11T14:28:20-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/tcp-policy configured"
time="2022-05-11T14:28:30-04:00" level=info msg="Success. Get expected response: connection rejected\n"
time="2022-05-11T14:28:31-04:00" level=info msg="Success. Get expected response: hello port 9001\nconnection succeeded\n"
time="2022-05-11T14:28:31-04:00" level=info msg=Cleanup
time="2022-05-11T14:28:31-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete125910923.yaml"
time="2022-05-11T14:28:31-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete121935726.yaml"
time="2022-05-11T14:28:31-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete103684597.yaml"
time="2022-05-11T14:28:31-04:00" level=info msg="Cleanup Echo"
time="2022-05-11T14:28:31-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/tcp-echo/tcp-echo.yaml"
time="2022-05-11T14:28:41-04:00" level=info msg="Removing Sleep on namespace foo"
time="2022-05-11T14:28:41-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:28:42-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:28:42-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:28:42-04:00" level=info msg="Command error: exit status 1"
--- PASS: T21 (112.34s)
    --- PASS: T21/Security_authorization_rbac_allow_GET_tcp (12.62s)
    --- PASS: T21/Security_authorization_rbac_invalid_policy_tcp (11.57s)
    --- PASS: T21/Security_authorization_rbac_deny_GET_tcp (11.69s)
=== RUN   T22
time="2022-05-11T14:29:02-04:00" level=info msg="Authorization with JWT Token"
time="2022-05-11T14:29:02-04:00" level=info msg="Deploying Httpbin on namespace foo"
time="2022-05-11T14:29:02-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:29:03-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:29:03-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T14:29:09-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T14:29:09-04:00" level=info msg="Deploying Sleep in namespace foo"
time="2022-05-11T14:29:09-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:29:10-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:29:10-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:29:14-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:29:14-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:29:15-04:00" level=info msg="Command output: \nsleep-6d646957b7-hc89z"
time="2022-05-11T14:29:15-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-hc89z"
time="2022-05-11T14:29:15-04:00" level=info msg="Success. Get expected response: 200\n"
=== RUN   T22/Security_authorization_allow_valid_JWT_list-typed_claims
time="2022-05-11T14:29:15-04:00" level=info msg="Allow requests with valid JWT and list-typed claims"
time="2022-05-11T14:29:15-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply155405008.yaml"
time="2022-05-11T14:29:16-04:00" level=info msg="Command output: \nrequestauthentication.security.istio.io/jwt-example created"
time="2022-05-11T14:30:06-04:00" level=info msg="Verify a request with an invalid JWT is denied"
time="2022-05-11T14:30:06-04:00" level=error msg="Verify denied request Unexpected response: 200\n"
    jwt.go:74: Verify denied request Unexpected response: 200
time="2022-05-11T14:30:06-04:00" level=info msg="Verify a request without a JWT is allowed"
time="2022-05-11T14:30:07-04:00" level=info msg="Success. Get expected response: 200\n"
=== RUN   T22/Security_authorization_allow_JWT_requestPrincipal
time="2022-05-11T14:30:07-04:00" level=info msg="Apply a policy requires all requests to have a valid JWT"
time="2022-05-11T14:30:07-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply453076463.yaml"
time="2022-05-11T14:30:07-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/require-jwt created"
time="2022-05-11T14:30:57-04:00" level=info msg="Download JWT token"
time="2022-05-11T14:30:57-04:00" level=info msg="Running command curl https://raw.githubusercontent.com/istio/istio/release-1.9/security/tools/jwt/samples/demo.jwt -s"
time="2022-05-11T14:35:57-04:00" level=info msg="Command error: exit status 28"
    common.go:37: Failed to get JWT token. Error command failed: "" exit status 28
=== RUN   T22/Security_authorization_allow_JWT_claims_group
time="2022-05-11T14:35:57-04:00" level=info msg="Apply a require jwt policy with a group claim"
time="2022-05-11T14:35:57-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply511007362.yaml"
time="2022-05-11T14:36:01-04:00" level=info msg="Command output: \nI0511 14:35:59.809772   17122 request.go:655] Throttling request took 1.148509701s, request: GET:https://api.openupi.noiro.local:6443/apis/template.openshift.io/v1?timeout=32s\nauthorizationpolicy.security.istio.io/require-jwt configured"
time="2022-05-11T14:36:51-04:00" level=info msg="Download JWT token and sets the groups claims"
time="2022-05-11T14:36:51-04:00" level=info msg="Running command curl https://raw.githubusercontent.com/istio/istio/release-1.9/security/tools/jwt/samples/demo.jwt -s"
time="2022-05-11T14:41:51-04:00" level=info msg="Command error: exit status 28"
    common.go:37: Failed to get JWT token. Error command failed: "" exit status 28
time="2022-05-11T14:41:51-04:00" level=info msg=Cleanup
time="2022-05-11T14:41:51-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete629902841.yaml"
time="2022-05-11T14:41:51-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete163553540.yaml"
time="2022-05-11T14:41:51-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete468015763.yaml"
time="2022-05-11T14:42:32-04:00" level=info msg="Removing Sleep on namespace foo"
time="2022-05-11T14:42:32-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:42:32-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:42:32-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:42:32-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:42:32-04:00" level=info msg="Removing Httpbin on namespace foo"
time="2022-05-11T14:42:32-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:42:33-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T14:42:43-04:00" level=info msg="Command output: \npod/httpbin-599849d486-v88rt condition met"
--- FAIL: T22 (840.66s)
    --- FAIL: T22/Security_authorization_allow_valid_JWT_list-typed_claims (51.67s)
    --- FAIL: T22/Security_authorization_allow_JWT_requestPrincipal (350.62s)
    --- FAIL: T22/Security_authorization_allow_JWT_claims_group (353.75s)
=== RUN   T23
time="2022-05-11T14:43:03-04:00" level=info msg="Authorization policies with a deny action"
time="2022-05-11T14:43:03-04:00" level=info msg="Deploying Httpbin on namespace foo"
time="2022-05-11T14:43:03-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:43:03-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:43:03-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T14:43:09-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T14:43:09-04:00" level=info msg="Deploying Sleep in namespace foo"
time="2022-05-11T14:43:09-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:43:09-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:43:09-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:43:15-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:43:15-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:43:15-04:00" level=info msg="Command output: \nsleep-6d646957b7-42f76"
time="2022-05-11T14:43:15-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-42f76"
time="2022-05-11T14:43:16-04:00" level=info msg="Success. Get expected response: 200\n"
=== RUN   T23/Security_authorization_explicitly_deny_request
time="2022-05-11T14:43:16-04:00" level=info msg="Explicitly deny a request"
time="2022-05-11T14:43:16-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply697230550.yaml"
time="2022-05-11T14:43:17-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/deny-method-get created"
time="2022-05-11T14:44:07-04:00" level=info msg="Verify GET requests are denied"
time="2022-05-11T14:44:07-04:00" level=info msg="Success. Get expected response: 403\n"
time="2022-05-11T14:44:07-04:00" level=info msg="Verify POST requests are allowed"
time="2022-05-11T14:44:07-04:00" level=info msg="Success. Get expected response: 200\n"
=== RUN   T23/Security_authorization_deny_request_header_check
time="2022-05-11T14:44:07-04:00" level=info msg="Apply a deny policy when header x-token value is not admin"
time="2022-05-11T14:44:07-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply697188925.yaml"
time="2022-05-11T14:44:08-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/deny-method-get configured"
time="2022-05-11T14:44:58-04:00" level=info msg="Verify GET requests with HTTP header x-token: admin are allowed"
time="2022-05-11T14:44:59-04:00" level=info msg="Success. Get expected response: 200\n"
time="2022-05-11T14:44:59-04:00" level=info msg="Verify GET requests with HTTP header x-token: guest are denied"
time="2022-05-11T14:44:59-04:00" level=info msg="Success. Get expected response: 403\n"
=== RUN   T23/Security_authorization_allow_path_policy
time="2022-05-11T14:44:59-04:00" level=info msg="Apply a policy that allows requests at the ip path"
time="2022-05-11T14:44:59-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply504846456.yaml"
time="2022-05-11T14:45:00-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/allow-path-ip created"
time="2022-05-11T14:45:50-04:00" level=info msg="Verify GET requests with the HTTP header x-token: guest at path /ip are denied"
time="2022-05-11T14:45:50-04:00" level=info msg="Success. Get expected response: 403\n"
time="2022-05-11T14:45:50-04:00" level=info msg="Verify GET requests with the HTTP header x-token: admin at path /ip are allowed"
time="2022-05-11T14:45:51-04:00" level=info msg="Success. Get expected response: 200\n"
time="2022-05-11T14:45:51-04:00" level=info msg="Verify GET requests with the HTTP header x-token: admin at path /get are denied"
time="2022-05-11T14:45:51-04:00" level=info msg="Success. Get expected response: 403\n"
time="2022-05-11T14:45:51-04:00" level=info msg=Cleanup
time="2022-05-11T14:45:51-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete569279351.yaml"
time="2022-05-11T14:45:51-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete565947498.yaml"
time="2022-05-11T14:45:51-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete624646337.yaml"
time="2022-05-11T14:46:32-04:00" level=info msg="Removing Sleep on namespace foo"
time="2022-05-11T14:46:32-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:46:35-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T14:46:35-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T14:46:35-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:46:35-04:00" level=info msg="Removing Httpbin on namespace foo"
time="2022-05-11T14:46:35-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:46:35-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T14:46:53-04:00" level=info msg="Command output: \npod/httpbin-599849d486-pxd87 condition met"
--- PASS: T23 (250.07s)
    --- PASS: T23/Security_authorization_explicitly_deny_request (51.67s)
    --- PASS: T23/Security_authorization_deny_request_header_check (51.48s)
    --- PASS: T23/Security_authorization_allow_path_policy (52.13s)
=== RUN   T24
time="2022-05-11T14:47:13-04:00" level=info msg="Trust Domain Migration"
time="2022-05-11T14:47:13-04:00" level=info msg="Configuring  spec.security.trust.domain to \"old-td\" and alias \"\""
time="2022-05-11T14:47:13-04:00" level=info msg="Running command oc -n istio-system patch smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":true}, \"trust\":{\"domain\":\"old-td\", \"additionalDomains\": []}}}}'"
time="2022-05-11T14:47:13-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T14:47:13-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T14:47:33-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T14:47:33-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istiod-istio-system"
time="2022-05-11T14:47:33-04:00" level=info msg="Command output: \ndeployment.apps/istiod-istio-system restarted"
time="2022-05-11T14:47:53-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T14:47:53-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-64bc86c9bf-k4rs7 condition met\npod/istio-ingressgateway-6f7dcc9fd8-69hgw condition met\npod/istiod-istio-system-559c55bfc7-5gznd condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met"
time="2022-05-11T14:47:53-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istio-ingressgateway"
time="2022-05-11T14:47:54-04:00" level=info msg="Command output: \ndeployment.apps/istio-ingressgateway restarted"
time="2022-05-11T14:48:14-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T14:48:14-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-64bc86c9bf-k4rs7 condition met\npod/istio-ingressgateway-74988f55f9-xw8bs condition met\npod/istiod-istio-system-559c55bfc7-5gznd condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met"
time="2022-05-11T14:48:14-04:00" level=info msg="Deploying Httpbin on namespace foo"
time="2022-05-11T14:48:14-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T14:48:15-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T14:48:15-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T14:48:20-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T14:48:20-04:00" level=info msg="Deploying Sleep in namespace foo"
time="2022-05-11T14:48:20-04:00" level=info msg="Running command kubectl apply -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:48:21-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:48:21-04:00" level=info msg="Running command oc -n foo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:48:27-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:48:27-04:00" level=info msg="Deploying Sleep in namespace bar"
time="2022-05-11T14:48:27-04:00" level=info msg="Running command kubectl apply -n bar -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T14:48:28-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T14:48:28-04:00" level=info msg="Running command oc -n bar wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T14:48:35-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T14:48:35-04:00" level=info msg="Apply deny all policy except sleep in bar namespace"
time="2022-05-11T14:48:35-04:00" level=info msg="Running command kubectl apply -n foo -f /tmp/kubeapply098616108.yaml"
time="2022-05-11T14:48:36-04:00" level=info msg="Command output: \nauthorizationpolicy.security.istio.io/service-httpbin.foo.svc.cluster.local created"
=== RUN   T24/Case_1:_Verifying_policy_works
time="2022-05-11T14:48:36-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:48:36-04:00" level=info msg="Command output: \nsleep-6d646957b7-8qdsq"
time="2022-05-11T14:48:36-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-8qdsq"
time="2022-05-11T14:48:36-04:00" level=info msg="Verifying curl output, expecting 403"
time="2022-05-11T14:48:37-04:00" level=info msg="Attempt 1/5 - Success, got 403\n"
time="2022-05-11T14:48:37-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:48:37-04:00" level=info msg="Command output: \nsleep-6d646957b7-zhr7z"
time="2022-05-11T14:48:37-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-zhr7z"
time="2022-05-11T14:48:37-04:00" level=info msg="Verifying curl output, expecting 200"
time="2022-05-11T14:48:37-04:00" level=info msg="Attempt 1/5 - Success, got 200\n"
=== RUN   T24/Case_2:_Migrate_trust_domain_without_trust_domain_aliases
time="2022-05-11T14:48:37-04:00" level=info msg="Configuring  spec.security.trust.domain to \"new-td\" and alias \"\""
time="2022-05-11T14:48:37-04:00" level=info msg="Running command oc -n istio-system patch smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":true}, \"trust\":{\"domain\":\"new-td\", \"additionalDomains\": []}}}}'"
time="2022-05-11T14:48:38-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T14:48:38-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T14:51:38-04:00" level=info msg="Command output: \nerror: timed out waiting for the condition on servicemeshcontrolplanes/istio-system"
time="2022-05-11T14:51:38-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:51:38-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istiod-istio-system"
time="2022-05-11T14:51:38-04:00" level=info msg="Command output: \ndeployment.apps/istiod-istio-system restarted"
time="2022-05-11T14:51:58-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T14:54:59-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-64bc86c9bf-k4rs7 condition met\npod/istio-ingressgateway-5c87749497-tgn74 condition met\npod/istiod-istio-system-5679b985fc-wsqln condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met\nerror: timed out waiting for the condition on pods/istio-egressgateway-f5c784b95-knxzw"
time="2022-05-11T14:54:59-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:54:59-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istio-ingressgateway"
time="2022-05-11T14:54:59-04:00" level=info msg="Command output: \ndeployment.apps/istio-ingressgateway restarted"
time="2022-05-11T14:55:19-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T14:58:19-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-64bc86c9bf-k4rs7 condition met\npod/istio-ingressgateway-b958cb4-2rzsv condition met\npod/istiod-istio-system-5679b985fc-wsqln condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met\nerror: timed out waiting for the condition on pods/istio-egressgateway-f5c784b95-knxzw"
time="2022-05-11T14:58:19-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:58:19-04:00" level=info msg="Running command oc -n foo delete pod --all"
time="2022-05-11T14:58:33-04:00" level=info msg="Command output: \npod \"httpbin-599849d486-44pgf\" deleted\npod \"sleep-6d646957b7-8qdsq\" deleted"
time="2022-05-11T14:58:33-04:00" level=info msg="Running command oc -n bar delete pod --all"
time="2022-05-11T14:58:33-04:00" level=info msg="Command output: \npod \"sleep-6d646957b7-zhr7z\" deleted"
time="2022-05-11T14:58:33-04:00" level=info msg="Running command oc -n foo wait --for condition=Ready --all pods --timeout 30s"
time="2022-05-11T14:59:03-04:00" level=info msg="Command output: \npod/httpbin-599849d486-s9f89 condition met\nerror: timed out waiting for the condition on pods/sleep-6d646957b7-pw845"
time="2022-05-11T14:59:03-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T14:59:03-04:00" level=info msg="Running command oc -n bar wait --for condition=Ready --all pods --timeout 30s"
time="2022-05-11T14:59:04-04:00" level=info msg="Command output: \npod/sleep-6d646957b7-xzl4v condition met"
time="2022-05-11T14:59:04-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T14:59:04-04:00" level=info msg="Command output: \nsleep-6d646957b7-pw845"
time="2022-05-11T14:59:04-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-pw845"
time="2022-05-11T14:59:04-04:00" level=info msg="Verifying curl output, expecting 403"
    trust_domain.go:88: command failed: "000\ncurl: (6) Could not resolve host: httpbin.foo\ncommand terminated with exit code 6\n" exit status 6
=== RUN   T24/Case_3:_Migrate_trust_domain_with_trust_domain_aliases
time="2022-05-11T15:00:16-04:00" level=info msg="Configuring  spec.security.trust.domain to \"new-td\" and alias \"old-td\""
time="2022-05-11T15:00:16-04:00" level=info msg="Running command oc -n istio-system patch smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":true}, \"trust\":{\"domain\":\"new-td\", \"additionalDomains\": [\"old-td\"]}}}}'"
time="2022-05-11T15:00:17-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:00:17-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T15:03:17-04:00" level=info msg="Command output: \nerror: timed out waiting for the condition on servicemeshcontrolplanes/istio-system"
time="2022-05-11T15:03:17-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:03:17-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istiod-istio-system"
time="2022-05-11T15:03:17-04:00" level=info msg="Command output: \ndeployment.apps/istiod-istio-system restarted"
time="2022-05-11T15:03:37-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T15:06:37-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-64bc86c9bf-k4rs7 condition met\npod/istio-ingressgateway-b958cb4-2rzsv condition met\npod/istiod-istio-system-5c4fd57b-gs676 condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met\nerror: timed out waiting for the condition on pods/istio-egressgateway-f5c784b95-knxzw"
time="2022-05-11T15:06:37-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:06:37-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istio-ingressgateway"
time="2022-05-11T15:06:38-04:00" level=info msg="Command output: \ndeployment.apps/istio-ingressgateway restarted"
time="2022-05-11T15:06:58-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T15:12:58-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-64bc86c9bf-k4rs7 condition met\npod/istio-ingressgateway-774f689677-jq94j condition met\npod/istiod-istio-system-5c4fd57b-gs676 condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met\ntimed out waiting for the condition on pods/istio-egressgateway-f5c784b95-knxzw\ntimed out waiting for the condition on pods/istio-ingressgateway-b958cb4-2rzsv"
time="2022-05-11T15:12:58-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:12:58-04:00" level=info msg="Running command oc -n foo delete pod --all"
time="2022-05-11T15:13:13-04:00" level=info msg="Command output: \npod \"httpbin-599849d486-s9f89\" deleted\npod \"sleep-6d646957b7-pw845\" deleted"
time="2022-05-11T15:13:13-04:00" level=info msg="Running command oc -n bar delete pod --all"
time="2022-05-11T15:13:13-04:00" level=info msg="Command output: \npod \"sleep-6d646957b7-xzl4v\" deleted"
time="2022-05-11T15:13:13-04:00" level=info msg="Running command oc -n foo wait --for condition=Ready --all pods --timeout 30s"
time="2022-05-11T15:13:13-04:00" level=info msg="Command output: \npod/httpbin-599849d486-m5tt4 condition met\npod/sleep-6d646957b7-mcnbv condition met"
time="2022-05-11T15:13:13-04:00" level=info msg="Running command oc -n bar wait --for condition=Ready --all pods --timeout 30s"
time="2022-05-11T15:13:44-04:00" level=info msg="Command output: \nerror: timed out waiting for the condition on pods/sleep-6d646957b7-4jclx"
time="2022-05-11T15:13:44-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:13:44-04:00" level=info msg="Running command kubectl -n foo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:13:44-04:00" level=info msg="Command output: \nsleep-6d646957b7-mcnbv"
time="2022-05-11T15:13:44-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-mcnbv"
time="2022-05-11T15:13:44-04:00" level=info msg="Verifying curl output, expecting 403"
time="2022-05-11T15:13:44-04:00" level=info msg="Attempt 1/5 - Success, got 403\n"
time="2022-05-11T15:13:44-04:00" level=info msg="Running command kubectl -n bar get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:13:45-04:00" level=info msg="Command output: \nsleep-6d646957b7-4jclx"
time="2022-05-11T15:13:45-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-4jclx"
time="2022-05-11T15:13:45-04:00" level=info msg="Verifying curl output, expecting 200"
    trust_domain.go:120: command failed: "000\ncurl: (6) Could not resolve host: httpbin.foo\ncommand terminated with exit code 6\n" exit status 6
time="2022-05-11T15:14:57-04:00" level=info msg=Cleanup
time="2022-05-11T15:14:57-04:00" level=info msg="Running command kubectl delete -n foo -f /tmp/kubedelete844521627.yaml"
time="2022-05-11T15:14:57-04:00" level=info msg="Removing Sleep on namespace foo"
time="2022-05-11T15:14:57-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T15:14:57-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T15:14:58-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T15:14:58-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:14:58-04:00" level=info msg="Removing Httpbin on namespace foo"
time="2022-05-11T15:14:58-04:00" level=info msg="Running command kubectl delete -n foo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T15:14:58-04:00" level=info msg="Running command oc -n foo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T15:15:13-04:00" level=info msg="Command output: \npod/httpbin-599849d486-m5tt4 condition met"
time="2022-05-11T15:15:13-04:00" level=info msg="Removing Sleep on namespace bar"
time="2022-05-11T15:15:13-04:00" level=info msg="Running command kubectl delete -n bar -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T15:15:13-04:00" level=info msg="Running command oc -n bar wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T15:15:13-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T15:15:13-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:15:13-04:00" level=info msg="Configuring  spec.security.trust.domain to \"cluster.local\" and alias \"\""
time="2022-05-11T15:15:13-04:00" level=info msg="Running command oc -n istio-system patch smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":false}, \"trust\":{\"domain\":\"cluster.local\", \"additionalDomains\": []}}}}'"
time="2022-05-11T15:15:14-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:15:14-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T15:15:57-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T15:15:57-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istiod-istio-system"
time="2022-05-11T15:15:57-04:00" level=info msg="Command output: \ndeployment.apps/istiod-istio-system restarted"
time="2022-05-11T15:16:17-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T15:16:18-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-76888d7857-p7tfg condition met\npod/istio-ingressgateway-6c4bf885f9-4pl6t condition met\npod/istiod-istio-system-868f5c8449-xftjw condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met"
time="2022-05-11T15:16:18-04:00" level=info msg="Running command oc -n istio-system rollout restart deployment istio-ingressgateway"
time="2022-05-11T15:16:18-04:00" level=info msg="Command output: \ndeployment.apps/istio-ingressgateway restarted"
time="2022-05-11T15:16:38-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready --all pods --timeout 180s"
time="2022-05-11T15:17:37-04:00" level=info msg="Command output: \npod/grafana-797bdb99db-qscbz condition met\npod/istio-egressgateway-76888d7857-p7tfg condition met\npod/istio-ingressgateway-6c4bf885f9-4pl6t condition met\npod/istio-ingressgateway-7f9fbf8688-8kvqs condition met\npod/istiod-istio-system-868f5c8449-xftjw condition met\npod/jaeger-657bd6b6f5-9rzcp condition met\npod/kiali-767b789c5c-js29p condition met\npod/prometheus-565c449c44-xrlzd condition met\npod/wasm-cacher-istio-system-6fdf689cf9-7648z condition met"
--- FAIL: T24 (1824.53s)
    --- PASS: T24/Case_1:_Verifying_policy_works (1.50s)
    --- FAIL: T24/Case_2:_Migrate_trust_domain_without_trust_domain_aliases (698.80s)
    --- FAIL: T24/Case_3:_Migrate_trust_domain_with_trust_domain_aliases (880.79s)
=== RUN   T25
time="2022-05-11T15:17:37-04:00" level=info msg="Deploy httpbin pod"
time="2022-05-11T15:17:37-04:00" level=info msg="Deploying Httpbin on namespace bookinfo"
time="2022-05-11T15:17:37-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T15:17:38-04:00" level=info msg="Command output: \nserviceaccount/httpbin created\nservice/httpbin created\ndeployment.apps/httpbin created"
time="2022-05-11T15:17:38-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/httpbin --timeout 3m0s"
time="2022-05-11T15:17:46-04:00" level=info msg="Command output: \ndeployment.apps/httpbin condition met"
time="2022-05-11T15:17:46-04:00" level=info msg="Deploy sleep pod"
time="2022-05-11T15:17:46-04:00" level=info msg="Deploying Sleep in namespace bookinfo"
time="2022-05-11T15:17:46-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T15:17:47-04:00" level=info msg="Command output: \nserviceaccount/sleep created\nservice/sleep created\ndeployment.apps/sleep created"
time="2022-05-11T15:17:47-04:00" level=info msg="Running command oc -n bookinfo wait --for condition=Available deploy/sleep --timeout 3m0s"
time="2022-05-11T15:17:54-04:00" level=info msg="Command output: \ndeployment.apps/sleep condition met"
time="2022-05-11T15:17:54-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:17:54-04:00" level=info msg="Command output: \nsleep-6d646957b7-j9dm5"
time="2022-05-11T15:17:54-04:00" level=info msg="app=sleep pod name: sleep-6d646957b7-j9dm5"
=== RUN   T25/Operator_test_sme_install
time="2022-05-11T15:17:54-04:00" level=info msg="Running command kubectl -n istio-system get pod -l app=wasm-cacher -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:17:55-04:00" level=info msg="Command output: \nwasm-cacher-istio-system-6fdf689cf9-7648z"
time="2022-05-11T15:17:55-04:00" level=info msg="app=wasm-cacher pod name: wasm-cacher-istio-system-6fdf689cf9-7648z"
time="2022-05-11T15:17:55-04:00" level=info msg="Running command kubectl -n istio-system get pods wasm-cacher-istio-system-6fdf689cf9-7648z --no-headers"
time="2022-05-11T15:17:55-04:00" level=info msg="Command output: \nwasm-cacher-istio-system-6fdf689cf9-7648z   1/1   Running   0     118m"
time="2022-05-11T15:17:55-04:00" level=info msg="Got the pod name=app=wasm-cacher running!"
time="2022-05-11T15:17:55-04:00" level=info msg="Creating ServiceMeshExtension"
time="2022-05-11T15:17:55-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply298508094.yaml"
time="2022-05-11T15:17:56-04:00" level=info msg="Command output: \nservicemeshextension.maistra.io/header-append created"
time="2022-05-11T15:17:56-04:00" level=info msg="Running command kubectl -n bookinfo get sme header-append -o jsonpath='{.status.deployment.ready}'"
time="2022-05-11T15:18:26-04:00" level=info msg="Running command kubectl -n bookinfo get sme header-append -o jsonpath='{.status.deployment.ready}'"
time="2022-05-11T15:18:56-04:00" level=info msg="Running command kubectl -n bookinfo get sme header-append -o jsonpath='{.status.deployment.ready}'"
time="2022-05-11T15:18:57-04:00" level=info msg="Command output: \nfalse"
time="2022-05-11T15:19:27-04:00" level=info msg="Running command kubectl -n bookinfo get sme header-append -o jsonpath='{.status.deployment.ready}'"
time="2022-05-11T15:19:27-04:00" level=info msg="Command output: \nfalse"
time="2022-05-11T15:19:57-04:00" level=info msg="Running command kubectl -n bookinfo get sme header-append -o jsonpath='{.status.deployment.ready}'"
time="2022-05-11T15:19:57-04:00" level=info msg="Command output: \nfalse"
time="2022-05-11T15:20:27-04:00" level=info msg="Running command kubectl -n bookinfo get sme header-append -o jsonpath='{.status.deployment.ready}'"
time="2022-05-11T15:20:28-04:00" level=info msg="Command output: \nfalse"
    sme_install.go:64: error checking for SME header-append: sme is not ready
time="2022-05-11T15:20:58-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=httpbin -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:20:58-04:00" level=info msg="Command output: \nhttpbin-599849d486-f72c2"
time="2022-05-11T15:20:58-04:00" level=info msg="app=httpbin pod name: httpbin-599849d486-f72c2"
time="2022-05-11T15:20:58-04:00" level=info msg="# httpbin proxy log: "
time="2022-05-11T15:20:58-04:00" level=info msg="Running command kubectl --namespace bookinfo logs httpbin-599849d486-f72c2 -c istio-proxy "
time="2022-05-11T15:20:58-04:00" level=info msg="2022-05-11T19:12:56.467241Z\tinfo\tcitadelclient\tCitadel client using custom root cert: istiod-istio-system.istio-system.svc:15012\n2022-05-11T19:12:56.527966Z\tinfo\tads\tAll caches have been synced up in 67.460425ms, marking server ready\n2022-05-11T19:12:56.545722Z\tinfo\tsds\tSDS server for workload certificates started, listening on \"./etc/istio/proxy/SDS\"\n2022-05-11T19:12:56.546304Z\tinfo\txdsproxy\tInitializing with upstream address \"istiod-istio-system.istio-system.svc:15012\" and cluster \"Kubernetes\"\n2022-05-11T19:12:56.547071Z\tinfo\tsds\tStart SDS grpc server\n2022-05-11T19:12:56.547186Z\tinfo\tdns\tStarting local udp DNS server at localhost:15053\n2022-05-11T19:12:56.547320Z\tinfo\tdns\tStarting local tcp DNS server at localhost:15053\n2022-05-11T19:12:56.709339Z\twarning\tenvoy runtime\tUnable to use runtime singleton for feature envoy.http.headermap.lazy_map_min_size\n2022-05-11T19:12:56.709511Z\twarning\tenvoy runtime\tUnable to use runtime singleton for feature envoy.http.headermap.lazy_map_min_size\n2022-05-11T19:12:56.710122Z\twarning\tenvoy runtime\tUnable to use runtime singleton for feature envoy.http.headermap.lazy_map_min_size\n2022-05-11T19:12:56.710174Z\twarning\tenvoy runtime\tUnable to use runtime singleton for feature envoy.http.headermap.lazy_map_min_size\n2022-05-11T19:12:56.785176Z\tinfo\txdsproxy\tconnected to upstream XDS server: istiod-istio-system.istio-system.svc:15012\n2022-05-11T19:12:56.835991Z\tinfo\tads\tADS: new connection for node:sidecar~15.128.0.229~httpbin-599849d486-f72c2.bookinfo~bookinfo.svc.cluster.local-1\n2022-05-11T19:12:56.836805Z\tinfo\tads\tADS: new connection for node:sidecar~15.128.0.229~httpbin-599849d486-f72c2.bookinfo~bookinfo.svc.cluster.local-2\n2022-05-11T19:12:57.527521Z\tinfo\tcache\tRoot cert has changed, start rotating root cert\n2022-05-11T19:12:57.527595Z\tinfo\tads\tXDS: Incremental Pushing:0 ConnectedEndpoints:2 Version:\n2022-05-11T19:12:57.527633Z\tinfo\tcache\tgenerated new workload certificate\tlatency=998.263262ms ttl=23h59m59.472383395s\n2022-05-11T19:12:57.527738Z\tinfo\tcache\treturned delayed workload certificate from cache\tttl=23h59m59.472277101s\n2022-05-11T19:12:57.528111Z\tinfo\tsds\tSDS: PUSH\tresource=default\n2022-05-11T19:12:58.244962Z\tinfo\tsds\tSDS: PUSH\tresource=ROOTCA\n2022-05-11T19:12:58.245657Z\tinfo\tsds\tSDS: PUSH\tresource=ROOTCA\n2022-05-11T19:12:58.343211Z\twarning\tenvoy filter\tmTLS PERMISSIVE mode is used, connection can be either plaintext or TLS, and client cert can be omitted. Please consider to upgrade to mTLS STRICT mode for more secure configuration that only allows TLS connection with client cert. See https://istio.io/docs/tasks/security/mtls-migration/\n2022-05-11T19:12:58.348471Z\twarning\tenvoy filter\tmTLS PERMISSIVE mode is used, connection can be either plaintext or TLS, and client cert can be omitted. Please consider to upgrade to mTLS STRICT mode for more secure configuration that only allows TLS connection with client cert. See https://istio.io/docs/tasks/security/mtls-migration/\n"
time="2022-05-11T15:20:58-04:00" level=info msg="# end of httpbin proxy log"
time="2022-05-11T15:20:58-04:00" level=info msg="# Cleanup ..."
time="2022-05-11T15:20:58-04:00" level=info msg="Removing Httpbin on namespace bookinfo"
time="2022-05-11T15:20:58-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/httpbin/httpbin.yaml"
time="2022-05-11T15:20:59-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=httpbin pods --timeout=30s"
time="2022-05-11T15:21:13-04:00" level=info msg="Command output: \npod/httpbin-599849d486-f72c2 condition met"
time="2022-05-11T15:21:13-04:00" level=info msg="Removing Sleep on namespace bookinfo"
time="2022-05-11T15:21:13-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/sleep/sleep.yaml"
time="2022-05-11T15:21:13-04:00" level=info msg="Running command oc -n bookinfo wait --for=delete -l app=sleep pods --timeout=30s"
time="2022-05-11T15:21:13-04:00" level=info msg="Command output: \nerror: no matching resources found"
time="2022-05-11T15:21:13-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:21:13-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete317497221.yaml"
--- FAIL: T25 (236.44s)
    --- FAIL: T25/Operator_test_sme_install (183.27s)
=== RUN   T26
=== RUN   T26/Operator_test_smcp_global_tls_minVersion_TLSv1_0
time="2022-05-11T15:21:34-04:00" level=info msg="Update SMCP spec.security.controlPlane.tls.minProtocolVersion: TLSv1_0"
time="2022-05-11T15:21:34-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"controlPlane\":{\"tls\":{\"minProtocolVersion\":\"TLSv1_0\"}}}}}'"
time="2022-05-11T15:21:35-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:21:35-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T15:21:35-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
=== RUN   T26/Operator_test_smcp_global_tls_minVersion_TLSv1_1
time="2022-05-11T15:21:35-04:00" level=info msg="Update SMCP spec.security.controlPlane.tls.minProtocolVersion: TLSv1_1"
time="2022-05-11T15:21:35-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"controlPlane\":{\"tls\":{\"minProtocolVersion\":\"TLSv1_1\"}}}}}'"
time="2022-05-11T15:21:36-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:21:36-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T15:22:00-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
=== RUN   T26/Operator_test_smcp_global_tls_maxVersion_TLSv1_3
time="2022-05-11T15:22:00-04:00" level=info msg="Update SMCP spec.security.controlPlane.tls.minProtocolVersion: TLSv1_3"
time="2022-05-11T15:22:00-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"controlPlane\":{\"tls\":{\"maxProtocolVersion\":\"TLSv1_3\"}}}}}'"
time="2022-05-11T15:22:00-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:22:00-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T15:22:00-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T15:22:00-04:00" level=info msg="Cleanup ..."
time="2022-05-11T15:22:00-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type=json -p='[{\"op\": \"remove\", \"path\": \"/spec/security/controlPlane/tls\"}]'"
time="2022-05-11T15:22:01-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:22:01-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T15:22:01-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
--- PASS: T26 (27.38s)
    --- PASS: T26/Operator_test_smcp_global_tls_minVersion_TLSv1_0 (1.57s)
    --- PASS: T26/Operator_test_smcp_global_tls_minVersion_TLSv1_1 (24.62s)
    --- PASS: T26/Operator_test_smcp_global_tls_maxVersion_TLSv1_3 (0.57s)
=== RUN   T27
=== RUN   T27/Operator_test_smcp_testssl
time="2022-05-11T15:22:01-04:00" level=info msg="Update SMCP mtls to true"
time="2022-05-11T15:22:01-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":true},\"controlPlane\":{\"mtls\":true}}}}'"
time="2022-05-11T15:22:01-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:22:01-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T15:22:02-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T15:22:02-04:00" level=info msg="Update SMCP spec.security.controlPlane.tls"
time="2022-05-11T15:22:02-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"controlPlane\":{\"tls\":{\"minProtocolVersion\":\"TLSv1_2\",\"maxProtocolVersion\":\"TLSv1_2\",\"cipherSuites\":[\"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\"],\"ecdhCurves\":[\"CurveP256\", \"CurveP384\"]}}}}}'"
time="2022-05-11T15:22:02-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:22:02-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T15:22:20-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
time="2022-05-11T15:22:20-04:00" level=info msg="Deploy bookinfo"
time="2022-05-11T15:22:20-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T15:22:20-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T15:22:22-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T15:22:27-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:22:27-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-86xhj"
time="2022-05-11T15:22:27-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-86xhj"
time="2022-05-11T15:22:27-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-86xhj --no-headers"
time="2022-05-11T15:22:27-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-86xhj   1/2   Running   0     6s"
time="2022-05-11T15:22:27-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T15:22:27-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:22:28-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-mcx2s"
time="2022-05-11T15:22:28-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-mcx2s"
time="2022-05-11T15:22:28-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-mcx2s --no-headers"
time="2022-05-11T15:22:28-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-mcx2s   0/2   ContainerCreating   0     5s"
time="2022-05-11T15:22:28-04:00" level=info msg="ratings-v1-bdbcc68bc-mcx2s in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T15:22:58-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:22:58-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-mcx2s"
time="2022-05-11T15:22:58-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-mcx2s"
time="2022-05-11T15:22:58-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-mcx2s --no-headers"
time="2022-05-11T15:22:59-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-mcx2s   2/2   Running   0     36s"
time="2022-05-11T15:22:59-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T15:22:59-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:22:59-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-5kd84"
time="2022-05-11T15:22:59-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-5kd84"
time="2022-05-11T15:22:59-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-5kd84 --no-headers"
time="2022-05-11T15:22:59-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-5kd84   2/2   Running   0     64s"
time="2022-05-11T15:22:59-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T15:22:59-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:23:00-04:00" level=info msg="Command output: \nreviews-v2-675679877f-5vqfl"
time="2022-05-11T15:23:00-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-5vqfl"
time="2022-05-11T15:23:00-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-5vqfl --no-headers"
time="2022-05-11T15:23:02-04:00" level=info msg="Command output: \nreviews-v2-675679877f-5vqfl   2/2   Running   0     40s"
time="2022-05-11T15:23:02-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T15:23:02-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:23:03-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-kq767"
time="2022-05-11T15:23:03-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-kq767"
time="2022-05-11T15:23:03-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-kq767 --no-headers"
time="2022-05-11T15:23:03-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-kq767   2/2   Running   0     69s"
time="2022-05-11T15:23:03-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T15:23:03-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:23:03-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-fbblw"
time="2022-05-11T15:23:03-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-fbblw"
time="2022-05-11T15:23:03-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-fbblw --no-headers"
time="2022-05-11T15:23:04-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-fbblw   2/2   Running   0     42s"
time="2022-05-11T15:23:04-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T15:23:04-04:00" level=info msg="Creating Gateway"
time="2022-05-11T15:23:04-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T15:23:04-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T15:23:04-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T15:23:04-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all-mtls.yaml"
time="2022-05-11T15:23:06-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
time="2022-05-11T15:23:16-04:00" level=info msg="Deploy testssl pod"
time="2022-05-11T15:23:16-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply443352864.yaml"
time="2022-05-11T15:23:17-04:00" level=info msg="Command output: \ndeployment.apps/testssl created"
time="2022-05-11T15:23:17-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=testssl -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:23:17-04:00" level=info msg="Command output: \ntestssl-7cf4f6f974-t84wh"
time="2022-05-11T15:23:17-04:00" level=info msg="app=testssl pod name: testssl-7cf4f6f974-t84wh"
time="2022-05-11T15:23:17-04:00" level=info msg="Running command kubectl -n bookinfo get pods testssl-7cf4f6f974-t84wh --no-headers"
time="2022-05-11T15:23:17-04:00" level=info msg="Command output: \ntestssl-7cf4f6f974-t84wh   0/1   ContainerCreating   0     28s"
time="2022-05-11T15:23:17-04:00" level=info msg="testssl-7cf4f6f974-t84wh in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T15:23:47-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=testssl -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:23:47-04:00" level=info msg="Command output: \ntestssl-7cf4f6f974-t84wh"
time="2022-05-11T15:23:47-04:00" level=info msg="app=testssl pod name: testssl-7cf4f6f974-t84wh"
time="2022-05-11T15:23:47-04:00" level=info msg="Running command kubectl -n bookinfo get pods testssl-7cf4f6f974-t84wh --no-headers"
time="2022-05-11T15:23:48-04:00" level=info msg="Command output: \ntestssl-7cf4f6f974-t84wh   1/1   Running   0     59s"
time="2022-05-11T15:23:48-04:00" level=info msg="Got the pod name=app=testssl running!"
time="2022-05-11T15:23:48-04:00" level=info msg="Check testssl.sh results. Ignore info\tCommand error"
time="2022-05-11T15:23:48-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=testssl -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:23:48-04:00" level=info msg="Command output: \ntestssl-7cf4f6f974-t84wh"
time="2022-05-11T15:23:48-04:00" level=info msg="app=testssl pod name: testssl-7cf4f6f974-t84wh"
time="2022-05-11T15:23:48-04:00" level=info msg="Running command kubectl exec testssl-7cf4f6f974-t84wh -n bookinfo -c testssl -- ./testssl/testssl.sh productpage:9080 "
time="2022-05-11T15:24:59-04:00" level=info msg="Command output: \n./testssl/testssl.sh: line 272: warning: setlocale: LC_COLLATE: cannot change locale (en_US.UTF-8): No such file or directory\n\n\x1b[0;35mNo engine or GOST support via engine with your /usr/bin/openssl\x1b[m\n\x1b[1m\n###########################################################\n    testssl.sh       3.0.6 from \x1b[m\x1b[1mhttps://testssl.sh/\x1b[m\n\x1b[1m\n      This program is free software. Distribution and\n             modification under GPLv2 permitted.\n      USAGE w/o ANY WARRANTY. USE IT AT YOUR OWN RISK!\n\n       Please file bugs @ \x1b[m\x1b[1mhttps://testssl.sh/bugs/\x1b[m\n\x1b[1m\n###########################################################\x1b[m\n\n Using \"OpenSSL 1.1.1g FIPS  21 Apr 2020\" [~85 ciphers]\n on testssl-7cf4f6f974-t84wh:/usr/bin/openssl\n (built: \"Mar 25 16:46:53 2021\", platform: \"linux-x86_64\")\n\n\n\x1b[7m Start 2022-05-11 19:19:06        -->> 172.30.90.243:9080 (productpage) <<--\x1b[m\n\n rDNS (172.30.90.243):   productpage.bookinfo.svc.cluster.local.\n Service detected:       certificate-based authentication => skipping all HTTP checks\n\n\n\x1b[1m\x1b[4m Testing protocols \x1b[m\x1b[4mvia sockets except NPN+ALPN \x1b[m\n\n\x1b[1m SSLv2      \x1b[m\x1b[1;32mnot offered (OK)\x1b[m\n\x1b[1m SSLv3      \x1b[m\x1b[1;32mnot offered (OK)\x1b[m\n\x1b[1m TLS 1      \x1b[mnot offered\n\x1b[1m TLS 1.1    \x1b[mnot offered\n\x1b[1m TLS 1.2    \x1b[m\x1b[1;32moffered (OK)\x1b[m\n\x1b[1m TLS 1.3    \x1b[mnot offered and downgraded to a weaker protocol\n\x1b[1m NPN/SPDY   \x1b[mnot offered\n\x1b[1m ALPN/HTTP2 \x1b[m\x1b[0;32mh2\x1b[m, http/1.1 (offered)\n\n\x1b[1m\x1b[4m Testing cipher categories \x1b[m\n\n\x1b[1m NULL ciphers (no encryption)                  \x1b[m\x1b[1;32mnot offered (OK)\x1b[m\n\x1b[1m Anonymous NULL Ciphers (no authentication)    \x1b[m\x1b[1;32mnot offered (OK)\x1b[m\n\x1b[1m Export ciphers (w/o ADH+NULL)                 \x1b[m\x1b[1;32mnot offered (OK)\x1b[m\n\x1b[1m LOW: 64 Bit + DES, RC[2,4] (w/o export)       \x1b[m\x1b[0;32mnot offered (OK)\x1b[m\n\x1b[1m Triple DES Ciphers / IDEA                     \x1b[mnot offered\n\x1b[1m Obsolete CBC ciphers (AES, ARIA etc.)         \x1b[mnot offered\n\x1b[1m Strong encryption (AEAD ciphers)              \x1b[m\x1b[1;32moffered (OK)\x1b[m\n\n\n\x1b[1m\x1b[4m Testing robust (perfect) forward secrecy\x1b[m\x1b[4m, (P)FS -- omitting Null Authentication/Encryption, 3DES, RC4 \x1b[m\n\n\x1b[0;32m PFS is offered (OK)\x1b[m          ECDHE-RSA-AES128-GCM-SHA256 \n\x1b[1m Elliptic curves offered:     \x1b[m\x1b[0;32mprime256v1\x1b[m \x1b[0;32msecp384r1\x1b[m \n\n\n\x1b[1m\x1b[4m Testing server preferences \x1b[m\n\n\x1b[1m Has server cipher order?     \x1b[m\x1b[1;32myes (OK)\x1b[m\n\x1b[1m Negotiated protocol          \x1b[m\x1b[1;32mTLSv1.2\x1b[m\n\x1b[1m Negotiated cipher            \x1b[m\x1b[1;32mECDHE-RSA-AES128-GCM-SHA256\x1b[m, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n\x1b[1m Cipher order\x1b[m\n    TLSv1.2:   ECDHE-RSA-AES128-GCM-SHA256 \n\n\n\x1b[1m\x1b[4m Testing server defaults (Server Hello) \x1b[m\n\n\x1b[1m TLS extensions (standard)    \x1b[m\"renegotiation info/#65281\"\n                              \"EC point formats/#11\" \"session ticket/#35\"\n                              \"max fragment length/#1\"\n                              \"application layer protocol negotiation/#16\"\n                              \"extended master secret/#23\"\n\x1b[1m Session Ticket RFC 5077 hint \x1b[mno -- no lifetime advertised\n\x1b[1m SSL Session ID support       \x1b[myes\n\x1b[1m Session Resumption           \x1b[mTickets no, \x1b[0;35mClient Auth: ID resumption test not supported\x1b[m\n\x1b[1m TLS clock skew\x1b[m               Random values, no fingerprinting possible \n\x1b[1m Signature Algorithm          \x1b[m\x1b[0;32mSHA256 with RSA\x1b[m\n\x1b[1m Server key size              \x1b[mRSA 2048 bits\n\x1b[1m Server key usage             \x1b[mDigital Signature, Key Encipherment\n\x1b[1m Server extended key usage    \x1b[mTLS Web Server Authentication, TLS Web Client Authentication\n\x1b[1m Serial / Fingerprints        \x1b[m5F971D831229B39268ADED05910CEA6E / SHA1 891B8A51804437DD666A0EB0698B77DE4BE36162\n                              SHA256 C1A8A96E0831068EC7A5A028DCCE1279875DF14B829550BA7E4030358AD10AF4\n\x1b[1m Common Name (CN)             \x1b[m(no CN field in subject)\n\x1b[1m subjectAltName (SAN)         \x1b[m\x1b[3mspiffe://cluster.local/ns/bookinfo/sa/bookinfo-productpage \x1b[m\n\x1b[1m Issuer                       \x1b[m\x1b[3m\x1b[m (\x1b[3mcluster.local\x1b[m)\n\x1b[1m Trust (hostname)             \x1b[m\x1b[0;31mcertificate does not match supplied URI\x1b[m (same w/o SNI)\n\x1b[1m Chain of trust\x1b[m               \x1b[1;31mNOT ok\x1b[m (self signed CA in chain)\n\x1b[1m EV cert\x1b[m (experimental)       no \n\x1b[1m ETS/\"eTLS\"\x1b[m, visibility info  not present\n\x1b[1m Certificate Validity (UTC)   \x1b[m\x1b[0;31mexpires < 30 days (0)\x1b[m (2022-05-11 19:17 --> 2022-05-12 19:17)\n\x1b[1m # of certificates provided\x1b[m   2\n\x1b[1m Certificate Revocation List  \x1b[m--\n\x1b[1m OCSP URI                     \x1b[m--\n                              \x1b[0;31mNOT ok --\x1b[m neither CRL nor OCSP URI provided\n\x1b[1m OCSP stapling                \x1b[mnot offered\n\x1b[1m OCSP must staple extension   \x1b[m--\n\x1b[1m DNS CAA RR\x1b[m (experimental)    \x1b[1;33mnot offered\x1b[m\n\x1b[1m Certificate Transparency     \x1b[m--\n\n\n\x1b[1m\x1b[4m Testing vulnerabilities \x1b[m\n\n\x1b[1m Heartbleed\x1b[m (CVE-2014-0160)                \x1b[1;32mnot vulnerable (OK)\x1b[m, no heartbeat extension\n\x1b[1m CCS\x1b[m (CVE-2014-0224)                       \x1b[1;32mnot vulnerable (OK)\x1b[m\n\x1b[1m Ticketbleed\x1b[m (CVE-2016-9244), experiment.  \x1b[1;32mnot vulnerable (OK)\x1b[m, no session tickets\n\x1b[1m ROBOT                                     \x1b[m\x1b[1;32mServer does not support any cipher suites that use RSA key transport\x1b[m\n\x1b[1m Secure Renegotiation (RFC 5746)           \x1b[m\x1b[1;32msupported (OK)\x1b[m\n\x1b[1m Secure Client-Initiated Renegotiation     \x1b[m\x1b[0;35mclient x509-based authentication prevents this from being tested\x1b[m\n\x1b[1m CRIME, TLS \x1b[m(CVE-2012-4929)                \x1b[0;32mnot vulnerable (OK)\x1b[m\n\x1b[1m BREACH\x1b[m (CVE-2013-3587)                    \x1b[0;35mclient x509-based authentication prevents this from being tested\x1b[m\n\x1b[1m POODLE, SSL\x1b[m (CVE-2014-3566)               \x1b[1;32mnot vulnerable (OK)\x1b[m, no SSLv3 support\n\x1b[1m TLS_FALLBACK_SCSV\x1b[m (RFC 7507)              \x1b[0;32mNo fallback possible (OK)\x1b[m, no protocol below TLS 1.2 offered\n\x1b[1m SWEET32\x1b[m (CVE-2016-2183, CVE-2016-6329)    \x1b[1;32mnot vulnerable (OK)\x1b[m\n\x1b[1m FREAK\x1b[m (CVE-2015-0204)                     \x1b[1;32mnot vulnerable (OK)\x1b[m\n\x1b[1m DROWN\x1b[m (CVE-2016-0800, CVE-2016-0703)      \x1b[1;32mnot vulnerable on this host and port (OK)\x1b[m\n                                           make sure you don't use this certificate elsewhere with SSLv2 enabled services\n                                           https://censys.io/ipv4?q=C1A8A96E0831068EC7A5A028DCCE1279875DF14B829550BA7E4030358AD10AF4 could help you to find out\n\x1b[1m LOGJAM\x1b[m (CVE-2015-4000), experimental      \x1b[0;32mnot vulnerable (OK):\x1b[m no DH EXPORT ciphers, no DH key detected with <= TLS 1.2\n\x1b[1m BEAST\x1b[m (CVE-2011-3389)                     \x1b[0;32mnot vulnerable (OK)\x1b[m, no SSL3 or TLS1\n\x1b[1m LUCKY13\x1b[m (CVE-2013-0169), experimental     \x1b[1;32mnot vulnerable (OK)\x1b[m\n\x1b[1m RC4\x1b[m (CVE-2013-2566, CVE-2015-2808)        \x1b[0;32mno RC4 ciphers detected (OK)\x1b[m\n\n\n\x1b[1m\x1b[4m Testing 370 ciphers via OpenSSL plus sockets against the server, ordered by encryption strength \x1b[m\n\nHexcode  Cipher Suite Name (OpenSSL)       KeyExch.   Encryption  Bits     Cipher Suite Name (IANA/RFC)\n-----------------------------------------------------------------------------------------------------------------------------\n xc02f   ECDHE-RSA-AES128-GCM-SHA256       ECDH\x1b[0;32m 256\x1b[m   AESGCM      128      TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256              \n\nCould not determine the protocol, only simulating generic clients.\n\n\x1b[1m\x1b[4m Running client simulations \x1b[m\x1b[1m\x1b[4mvia sockets \x1b[m\n\n Android 4.4.2                TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Android 5.0.0                TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Android 6.0                  TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Android 7.0 (native)         TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Android 8.1 (native)         TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Android 9.0 (native)         TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Android 10.0 (native)        TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Chrome 74 (Win 10)           TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Chrome 79 (Win 10)           TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Firefox 66 (Win 8.1/10)      TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Firefox 71 (Win 10)          TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n IE 6 XP                      No connection\n IE 8 Win 7                   No connection\n IE 8 XP                      No connection\n IE 11 Win 7                  No connection\n IE 11 Win 8.1                No connection\n IE 11 Win Phone 8.1          No connection\n IE 11 Win 10                 TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Edge 15 Win 10               TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Edge 17 (Win 10)             TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Opera 66 (Win 10)            TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Safari 9 iOS 9               TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Safari 9 OS X 10.11          TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Safari 10 OS X 10.12         TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Safari 12.1 (iOS 12.2)       TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Safari 13.0 (macOS 10.14.6)  TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Apple ATS 9 iOS 9            TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Java 6u45                    No connection\n Java 7u25                    No connection\n Java 8u161                   TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Java 11.0.2 (OpenJDK)        TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Java 12.0.1 (OpenJDK)        TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n OpenSSL 1.0.2e               TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n OpenSSL 1.1.0l (Debian)      TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n OpenSSL 1.1.1d (Debian)      TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n Thunderbird (68.3)           TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256, \x1b[0;32m256 bit ECDH (P-256)\x1b[m\n\n\x1b[7m Done 2022-05-11 19:20:12 [  70s] -->> 172.30.90.243:9080 (productpage) <<--\x1b[m\n\n\ncommand terminated with exit code 8"
time="2022-05-11T15:24:59-04:00" level=info msg="Command error: exit status 8"
time="2022-05-11T15:24:59-04:00" level=info msg="Cleanup ..."
time="2022-05-11T15:24:59-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete608653823.yaml"
time="2022-05-11T15:24:59-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T15:24:59-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T15:24:59-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T15:24:59-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T15:25:11-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type=json -p='[{\"op\": \"remove\", \"path\": \"/spec/security/controlPlane/tls\"}]'"
time="2022-05-11T15:25:11-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:25:11-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"security\":{\"dataPlane\":{\"mtls\":false},\"controlPlane\":{\"mtls\":false}}}}'"
time="2022-05-11T15:25:12-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:25:12-04:00" level=info msg="Running command oc wait --for condition=Ready -n istio-system smmr/default --timeout 180s"
time="2022-05-11T15:25:28-04:00" level=info msg="Command output: \nservicemeshmemberroll.maistra.io/default condition met"
--- PASS: T27 (207.07s)
    --- PASS: T27/Operator_test_smcp_testssl (177.50s)
=== RUN   T28
time="2022-05-11T15:25:28-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T15:25:28-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T15:25:30-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T15:25:35-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:25:36-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-dvx82"
time="2022-05-11T15:25:36-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-dvx82"
time="2022-05-11T15:25:36-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-dvx82 --no-headers"
time="2022-05-11T15:25:36-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-dvx82   0/2   ContainerCreating   0     5s"
time="2022-05-11T15:25:36-04:00" level=info msg="details-v1-6cd699df8c-dvx82 in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T15:26:06-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:26:06-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-dvx82"
time="2022-05-11T15:26:06-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-dvx82"
time="2022-05-11T15:26:06-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-dvx82 --no-headers"
time="2022-05-11T15:26:06-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-dvx82   2/2   Running   0     63s"
time="2022-05-11T15:26:06-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T15:26:06-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:26:07-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-mn64w"
time="2022-05-11T15:26:07-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-mn64w"
time="2022-05-11T15:26:07-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-mn64w --no-headers"
time="2022-05-11T15:26:07-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-mn64w   2/2   Running   0     64s"
time="2022-05-11T15:26:07-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T15:26:07-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:26:07-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-56p5w"
time="2022-05-11T15:26:07-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-56p5w"
time="2022-05-11T15:26:07-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-56p5w --no-headers"
time="2022-05-11T15:26:07-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-56p5w   2/2   Running   0     65s"
time="2022-05-11T15:26:07-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T15:26:07-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:26:08-04:00" level=info msg="Command output: \nreviews-v2-675679877f-sgzkt"
time="2022-05-11T15:26:08-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-sgzkt"
time="2022-05-11T15:26:08-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-sgzkt --no-headers"
time="2022-05-11T15:26:08-04:00" level=info msg="Command output: \nreviews-v2-675679877f-sgzkt   2/2   Running   0     66s"
time="2022-05-11T15:26:08-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T15:26:08-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:26:08-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-rz5l7"
time="2022-05-11T15:26:08-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-rz5l7"
time="2022-05-11T15:26:08-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-rz5l7 --no-headers"
time="2022-05-11T15:26:09-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-rz5l7   2/2   Running   0     39s"
time="2022-05-11T15:26:09-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T15:26:09-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:26:09-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-7l8rh"
time="2022-05-11T15:26:09-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-7l8rh"
time="2022-05-11T15:26:09-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-7l8rh --no-headers"
time="2022-05-11T15:26:09-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-7l8rh   2/2   Running   0     65s"
time="2022-05-11T15:26:09-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T15:26:09-04:00" level=info msg="Creating Gateway"
time="2022-05-11T15:26:09-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T15:26:10-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T15:26:10-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T15:26:10-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T15:26:11-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
time="2022-05-11T15:26:21-04:00" level=info msg="Deploy Redis"
time="2022-05-11T15:26:21-04:00" level=info msg="Running command oc new-project redis"
time="2022-05-11T15:26:21-04:00" level=info msg="namespace redis created\n"
time="2022-05-11T15:26:21-04:00" level=info msg="Running command kubectl apply -n redis -f ../testdata/examples/x86/redis/redis.yaml"
time="2022-05-11T15:26:22-04:00" level=info msg="Command output: \nserviceaccount/redis created\nservice/redis created\ndeployment.apps/redis created"
time="2022-05-11T15:26:22-04:00" level=info msg="Running command oc -n redis wait --for condition=Available deploy/redis --timeout 180s"
time="2022-05-11T15:29:22-04:00" level=info msg="Command output: \nerror: timed out waiting for the condition on deployments/redis"
time="2022-05-11T15:29:22-04:00" level=info msg="Command error: exit status 1"
    ratelimit.go:137: redis deployment not ready: command failed: "error: timed out waiting for the condition on deployments/redis\n" exit status 1
time="2022-05-11T15:29:22-04:00" level=info msg="Running command kubectl -n istio-system patch smcp/istio-system --type=json -p='[{\"op\": \"remove\", \"path\": \"/spec/techPreview/rateLimiting\"}]'"
time="2022-05-11T15:29:23-04:00" level=info msg="Command output: \nThe request is invalid"
time="2022-05-11T15:29:23-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:29:23-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T15:29:23-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T15:29:23-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete158016338.yaml"
time="2022-05-11T15:29:28-04:00" level=info msg="Running command kubectl delete -n istio-system -f /tmp/kubedelete030707849.yaml"
time="2022-05-11T15:29:28-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T15:29:28-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T15:29:28-04:00" level=info msg="Cleanup Redis"
time="2022-05-11T15:29:28-04:00" level=info msg="Running command kubectl delete -n redis -f ../testdata/examples/x86/redis/redis.yaml"
time="2022-05-11T15:29:29-04:00" level=info msg="Running command kubectl delete project redis"
time="2022-05-11T15:29:29-04:00" level=info msg="Command output: \nproject.project.openshift.io \"redis\" deleted"
time="2022-05-11T15:29:29-04:00" level=info msg="namespace redis deleted\n"
time="2022-05-11T15:29:39-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T15:29:39-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T15:29:39-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T15:29:40-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
--- FAIL: T28 (263.21s)
=== RUN   T29
=== RUN   T29/smcp_test_annotation_proxyEnv
time="2022-05-11T15:29:51-04:00" level=info msg="Test annotation sidecar.maistra.io/proxyEnv"
time="2022-05-11T15:29:51-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply799005780.yaml"
time="2022-05-11T15:29:52-04:00" level=info msg="Command output: \ndeployment.apps/testenv created"
time="2022-05-11T15:29:52-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=env -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:29:53-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg"
time="2022-05-11T15:29:53-04:00" level=info msg="app=env pod name: testenv-698bfb8785-5nvmg"
time="2022-05-11T15:29:53-04:00" level=info msg="Running command kubectl -n bookinfo get pods testenv-698bfb8785-5nvmg --no-headers"
time="2022-05-11T15:29:53-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg   0/1   ContainerCreating   0     29s"
time="2022-05-11T15:29:53-04:00" level=info msg="testenv-698bfb8785-5nvmg in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T15:30:23-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=env -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:30:23-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg"
time="2022-05-11T15:30:23-04:00" level=info msg="app=env pod name: testenv-698bfb8785-5nvmg"
time="2022-05-11T15:30:23-04:00" level=info msg="Running command kubectl -n bookinfo get pods testenv-698bfb8785-5nvmg --no-headers"
time="2022-05-11T15:30:23-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg   1/1   Running   0     59s"
time="2022-05-11T15:30:23-04:00" level=info msg="Got the pod name=app=env running!"
time="2022-05-11T15:30:23-04:00" level=info msg="Running command kubectl get po -n bookinfo -o yaml | grep maistra_test_env"
time="2022-05-11T15:30:24-04:00" level=info msg="      sidecar.maistra.io/proxyEnv: '{ \"maistra_test_env\": \"env_value\", \"maistra_test_env_2\": \"env_value_2\" }'\n"
=== RUN   T29/smcp_test_annotation_quote_injection
time="2022-05-11T15:30:24-04:00" level=info msg="Test SMCP annotation quote value injection"
time="2022-05-11T15:30:24-04:00" level=info msg="Running command kubectl -n istio-system patch smcp/istio-system --type=merge --patch=\"\nspec:\n  proxy:\n    injection:\n      autoInject: true\n      injectedAnnotations:\n        test1.annotation-from-smcp: test1\n        test2.annotation-from-smcp: '[\"test2\"]'\n        test3.annotation-from-smcp: '{test3}'\n\""
time="2022-05-11T15:30:24-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:30:24-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T15:30:38-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T15:30:38-04:00" level=info msg="Check a pod annotations"
time="2022-05-11T15:30:38-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply256381859.yaml"
time="2022-05-11T15:30:39-04:00" level=info msg="Command output: \ndeployment.apps/testenv unchanged"
time="2022-05-11T15:30:39-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=env -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:30:39-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg"
time="2022-05-11T15:30:39-04:00" level=info msg="app=env pod name: testenv-698bfb8785-5nvmg"
time="2022-05-11T15:30:39-04:00" level=info msg="Running command kubectl -n bookinfo get pods testenv-698bfb8785-5nvmg --no-headers"
time="2022-05-11T15:30:39-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg   1/1   Running   0     47s"
time="2022-05-11T15:30:39-04:00" level=info msg="Got the pod name=app=env running!"
time="2022-05-11T15:30:59-04:00" level=info msg="Running command oc -n bookinfo rollout restart deployment testenv"
time="2022-05-11T15:31:00-04:00" level=info msg="Command output: \ndeployment.apps/testenv restarted"
time="2022-05-11T15:31:00-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=env -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:31:00-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg"
time="2022-05-11T15:31:00-04:00" level=info msg="app=env pod name: testenv-698bfb8785-5nvmg"
time="2022-05-11T15:31:00-04:00" level=info msg="Running command kubectl -n bookinfo get pods testenv-698bfb8785-5nvmg --no-headers"
time="2022-05-11T15:31:00-04:00" level=info msg="Command output: \ntestenv-698bfb8785-5nvmg   1/1   Running   0     96s"
time="2022-05-11T15:31:00-04:00" level=info msg="Got the pod name=app=env running!"
time="2022-05-11T15:31:00-04:00" level=info msg="Running command kubectl get po -n bookinfo -l app=env -o yaml | grep \"annotation-from-smcp\""
time="2022-05-11T15:31:00-04:00" level=info msg="Command error: exit status 1"
    common.go:37: Failed to get po. Error command failed: "" exit status 1
time="2022-05-11T15:31:00-04:00" level=info msg="Cleanup ..."
time="2022-05-11T15:31:00-04:00" level=info msg="Running command kubectl -n istio-system patch smcp/istio-system --type=json -p='[{\"op\": \"remove\", \"path\": \"/spec/proxy/injection/injectedAnnotations\"}]'"
time="2022-05-11T15:31:01-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system patched"
time="2022-05-11T15:31:01-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T15:31:19-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
time="2022-05-11T15:31:19-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete321791654.yaml"
--- FAIL: T29 (108.09s)
    --- PASS: T29/smcp_test_annotation_proxyEnv (32.27s)
    --- FAIL: T29/smcp_test_annotation_quote_injection (36.84s)
=== RUN   T30
time="2022-05-11T15:31:39-04:00" level=info msg="Deploy bookinfo in bookinfo ns"
time="2022-05-11T15:31:39-04:00" level=info msg="Deploying Bookinfo"
time="2022-05-11T15:31:39-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
time="2022-05-11T15:31:41-04:00" level=info msg="Command output: \nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created"
time="2022-05-11T15:31:46-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:31:46-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-9v2xt"
time="2022-05-11T15:31:46-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-9v2xt"
time="2022-05-11T15:31:46-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-9v2xt --no-headers"
time="2022-05-11T15:31:46-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-9v2xt   0/2   ContainerCreating   0     32s"
time="2022-05-11T15:31:46-04:00" level=info msg="details-v1-6cd699df8c-9v2xt in namespace bookinfo is not running: ContainerCreating"
time="2022-05-11T15:32:16-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=details -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:32:17-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-9v2xt"
time="2022-05-11T15:32:17-04:00" level=info msg="app=details pod name: details-v1-6cd699df8c-9v2xt"
time="2022-05-11T15:32:17-04:00" level=info msg="Running command kubectl -n bookinfo get pods details-v1-6cd699df8c-9v2xt --no-headers"
time="2022-05-11T15:32:17-04:00" level=info msg="Command output: \ndetails-v1-6cd699df8c-9v2xt   2/2   Running   0     35s"
time="2022-05-11T15:32:17-04:00" level=info msg="Got the pod name=app=details running!"
time="2022-05-11T15:32:17-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=ratings -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:32:17-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-gwmj6"
time="2022-05-11T15:32:17-04:00" level=info msg="app=ratings pod name: ratings-v1-bdbcc68bc-gwmj6"
time="2022-05-11T15:32:17-04:00" level=info msg="Running command kubectl -n bookinfo get pods ratings-v1-bdbcc68bc-gwmj6 --no-headers"
time="2022-05-11T15:32:17-04:00" level=info msg="Command output: \nratings-v1-bdbcc68bc-gwmj6   2/2   Running   0     63s"
time="2022-05-11T15:32:17-04:00" level=info msg="Got the pod name=app=ratings running!"
time="2022-05-11T15:32:17-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v1 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:32:18-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-h5k6h"
time="2022-05-11T15:32:18-04:00" level=info msg="app=reviews,version=v1 pod name: reviews-v1-754ddd7b6f-h5k6h"
time="2022-05-11T15:32:18-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v1-754ddd7b6f-h5k6h --no-headers"
time="2022-05-11T15:32:18-04:00" level=info msg="Command output: \nreviews-v1-754ddd7b6f-h5k6h   2/2   Running   0     36s"
time="2022-05-11T15:32:18-04:00" level=info msg="Got the pod name=app=reviews,version=v1 running!"
time="2022-05-11T15:32:18-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v2 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:32:18-04:00" level=info msg="Command output: \nreviews-v2-675679877f-6th8w"
time="2022-05-11T15:32:18-04:00" level=info msg="app=reviews,version=v2 pod name: reviews-v2-675679877f-6th8w"
time="2022-05-11T15:32:18-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v2-675679877f-6th8w --no-headers"
time="2022-05-11T15:32:19-04:00" level=info msg="Command output: \nreviews-v2-675679877f-6th8w   2/2   Running   0     65s"
time="2022-05-11T15:32:19-04:00" level=info msg="Got the pod name=app=reviews,version=v2 running!"
time="2022-05-11T15:32:19-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=reviews,version=v3 -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:32:19-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-cpvh7"
time="2022-05-11T15:32:19-04:00" level=info msg="app=reviews,version=v3 pod name: reviews-v3-79d7549c7-cpvh7"
time="2022-05-11T15:32:19-04:00" level=info msg="Running command kubectl -n bookinfo get pods reviews-v3-79d7549c7-cpvh7 --no-headers"
time="2022-05-11T15:32:19-04:00" level=info msg="Command output: \nreviews-v3-79d7549c7-cpvh7   2/2   Running   0     38s"
time="2022-05-11T15:32:19-04:00" level=info msg="Got the pod name=app=reviews,version=v3 running!"
time="2022-05-11T15:32:19-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=productpage -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:32:19-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-k4wfj"
time="2022-05-11T15:32:19-04:00" level=info msg="app=productpage pod name: productpage-v1-5ddcb4b84f-k4wfj"
time="2022-05-11T15:32:19-04:00" level=info msg="Running command kubectl -n bookinfo get pods productpage-v1-5ddcb4b84f-k4wfj --no-headers"
time="2022-05-11T15:32:20-04:00" level=info msg="Command output: \nproductpage-v1-5ddcb4b84f-k4wfj   2/2   Running   0     39s"
time="2022-05-11T15:32:20-04:00" level=info msg="Got the pod name=app=productpage running!"
time="2022-05-11T15:32:20-04:00" level=info msg="Creating Gateway"
time="2022-05-11T15:32:20-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T15:32:20-04:00" level=info msg="Command output: \ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created"
time="2022-05-11T15:32:20-04:00" level=info msg="Creating destination rules all"
time="2022-05-11T15:32:20-04:00" level=info msg="Running command kubectl apply -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T15:32:21-04:00" level=info msg="Command output: \ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created"
=== RUN   T30/smcp_test_must_gather
time="2022-05-11T15:32:31-04:00" level=info msg="Test must-gather log collection"
time="2022-05-11T15:32:31-04:00" level=info msg="Running command mkdir -p debug; oc adm must-gather --dest-dir=./debug --image=registry.redhat.io/openshift-service-mesh/istio-must-gather-rhel8"
time="2022-05-11T15:35:57-04:00" level=info msg="Command output: \n[must-gather      ] OUT Using must-gather plug-in image: registry.redhat.io/openshift-service-mesh/istio-must-gather-rhel8\nWhen opening a support case, bugzilla, or issue please include the following summary data along with any other requested information.\nClusterID: abcf5756-83e4-4086-9d72-9bc9b30117f5\nClusterVersion: Stable at \"4.7.39\"\nClusterOperators:\n\tclusteroperator/ingress is degraded because Some ingresscontrollers are degraded: ingresscontroller \"default\" is degraded: DegradedConditions: One or more other status conditions indicate a degraded state: CanaryChecksSucceeding=False (CanaryChecksRepetitiveFailures: Canary route checks for the default ingress controller are failing)\n\n\n[must-gather      ] OUT namespace/openshift-must-gather-s4mhb created\n[must-gather      ] OUT clusterrolebinding.rbac.authorization.k8s.io/must-gather-z7t7h created\n[must-gather      ] OUT pod for plug-in image registry.redhat.io/openshift-service-mesh/istio-must-gather-rhel8 created\n[must-gather-76q5p] POD 2022-05-11T19:28:15.929569977Z \n[must-gather-76q5p] POD 2022-05-11T19:28:15.929738257Z Executing Istio gather script\n[must-gather-76q5p] POD 2022-05-11T19:28:15.929796324Z \n[must-gather-76q5p] POD 2022-05-11T19:28:17.111853200Z Collecting resources for namespace istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:19.262740088Z I0511 19:28:19.262299      58 request.go:668] Waited for 1.170879609s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/apiextensions.k8s.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:19.694029475Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:21.078011972Z I0511 19:28:21.077869      67 request.go:668] Waited for 1.151686081s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:21.509043216Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:21.706947134Z Collecting Envoy config for pods in istio-system, control plane namespace istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:22.242626721Z Collecting config for pod istio-egressgateway-76888d7857-p7tfg.istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:23.483649948Z Collecting config for pod istio-ingressgateway-7f9fbf8688-8kvqs.istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:25.519950336Z Processing istio-system member bookinfo\n[must-gather-76q5p] POD 2022-05-11T19:28:25.711957992Z Collecting Envoy config for pods in bookinfo, control plane namespace istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:26.107608148Z Collecting config for pod details-v1-6cd699df8c-9v2xt.bookinfo\n[must-gather-76q5p] POD 2022-05-11T19:28:27.752347189Z Collecting config for pod productpage-v1-5ddcb4b84f-k4wfj.bookinfo\n[must-gather-76q5p] POD 2022-05-11T19:28:29.075604170Z Collecting config for pod ratings-v1-bdbcc68bc-gwmj6.bookinfo\n[must-gather-76q5p] POD 2022-05-11T19:28:30.391218798Z Collecting config for pod reviews-v1-754ddd7b6f-h5k6h.bookinfo\n[must-gather-76q5p] POD 2022-05-11T19:28:31.693850339Z Collecting config for pod reviews-v2-675679877f-6th8w.bookinfo\n[must-gather-76q5p] POD 2022-05-11T19:28:33.000299126Z Collecting config for pod reviews-v3-79d7549c7-cpvh7.bookinfo\n[must-gather-76q5p] POD 2022-05-11T19:28:34.094410327Z Processing istio-system member foo\n[must-gather-76q5p] POD 2022-05-11T19:28:34.273520176Z Collecting Envoy config for pods in foo, control plane namespace istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:34.430840952Z Processing istio-system member bar\n[must-gather-76q5p] POD 2022-05-11T19:28:34.616699858Z Collecting Envoy config for pods in bar, control plane namespace istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:34.769054355Z Processing istio-system member legacy\n[must-gather-76q5p] POD 2022-05-11T19:28:34.948791750Z Collecting Envoy config for pods in legacy, control plane namespace istio-system\n[must-gather-76q5p] POD 2022-05-11T19:28:37.344897921Z \n[must-gather-76q5p] POD 2022-05-11T19:28:37.344897921Z Dumping resource ns/openshift-operators...\n[must-gather-76q5p] POD 2022-05-11T19:28:37.597339833Z Gathering data for ns/openshift-operators...\n[must-gather-76q5p] POD 2022-05-11T19:28:41.990219907Z I0511 19:28:41.990143     449 request.go:668] Waited for 1.189136717s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/metal3.io/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:43.200499020Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:43.208861433Z \n[must-gather-76q5p] POD 2022-05-11T19:28:43.208962593Z Dumping resource MutatingWebhookConfiguration...\n[must-gather-76q5p] POD 2022-05-11T19:28:43.392082636Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:43.400126829Z \n[must-gather-76q5p] POD 2022-05-11T19:28:43.400227707Z Dumping resource ValidatingWebhookConfiguration...\n[must-gather-76q5p] POD 2022-05-11T19:28:43.578209127Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:43.582428141Z \n[must-gather-76q5p] POD 2022-05-11T19:28:43.582508402Z Dumping resource ns/istio-system...\n[must-gather-76q5p] POD 2022-05-11T19:28:43.758559656Z Gathering data for ns/istio-system...\n[must-gather-76q5p] POD 2022-05-11T19:28:45.464866218Z I0511 19:28:45.463986     473 request.go:668] Waited for 1.176856142s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/authentication.maistra.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:47.980869005Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:47.991648116Z \n[must-gather-76q5p] POD 2022-05-11T19:28:47.991713556Z Dumping resource ns/bookinfo...\n[must-gather-76q5p] POD 2022-05-11T19:28:48.154318685Z Gathering data for ns/bookinfo...\n[must-gather-76q5p] POD 2022-05-11T19:28:49.857850731Z I0511 19:28:49.857719     482 request.go:668] Waited for 1.177360459s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.dnsnetpol/v1beta?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:52.164847927Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:52.173182099Z \n[must-gather-76q5p] POD 2022-05-11T19:28:52.173182099Z Dumping resource foo...\n[must-gather-76q5p] POD 2022-05-11T19:28:53.517618486Z I0511 19:28:53.517301     491 request.go:668] Waited for 1.170524463s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/security.internal.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:53.924815956Z error: the server doesn't have a resource type \"foo\"\n[must-gather-76q5p] POD 2022-05-11T19:28:53.931415688Z \n[must-gather-76q5p] POD 2022-05-11T19:28:53.931415688Z Dumping resource bar...\n[must-gather-76q5p] POD 2022-05-11T19:28:55.331012598Z I0511 19:28:55.330816     499 request.go:668] Waited for 1.168364334s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/node.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:55.738749806Z error: the server doesn't have a resource type \"bar\"\n[must-gather-76q5p] POD 2022-05-11T19:28:55.744758663Z \n[must-gather-76q5p] POD 2022-05-11T19:28:55.744758663Z Dumping resource legacy...\n[must-gather-76q5p] POD 2022-05-11T19:28:57.088658869Z I0511 19:28:57.088458     507 request.go:668] Waited for 1.165933964s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/scheduling.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:28:57.496142184Z error: the server doesn't have a resource type \"legacy\"\n[must-gather-76q5p] POD 2022-05-11T19:28:57.502006682Z \n[must-gather-76q5p] POD 2022-05-11T19:28:57.502006682Z Dumping resource crd/adapters.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:28:58.204064279Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:28:58.216415226Z \n[must-gather-76q5p] POD 2022-05-11T19:28:58.216415226Z Dumping resource attributemanifests.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:28:59.588396261Z I0511 19:28:59.588260     523 request.go:668] Waited for 1.170865717s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/operator.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:00.471898345Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:00.480501346Z \n[must-gather-76q5p] POD 2022-05-11T19:29:00.480501346Z Dumping resource authorizationpolicies.security.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:01.825548029Z I0511 19:29:01.825263     532 request.go:668] Waited for 1.160081498s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.netflow/v1alpha?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:02.745533132Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:02.751457907Z \n[must-gather-76q5p] POD 2022-05-11T19:29:02.751457907Z Dumping resource destinationrules.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:04.109241876Z I0511 19:29:04.108460     541 request.go:668] Waited for 1.177637892s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/whereabouts.cni.cncf.io/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:05.030828846Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:05.042298912Z \n[must-gather-76q5p] POD 2022-05-11T19:29:05.042442959Z Dumping resource envoyfilters.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:06.400945139Z I0511 19:29:06.400707     549 request.go:668] Waited for 1.17143298s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/security.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:07.293845669Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:07.303011678Z \n[must-gather-76q5p] POD 2022-05-11T19:29:07.303143786Z Dumping resource exportedservicesets.federation.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:08.672087322Z I0511 19:29:08.671912     558 request.go:668] Waited for 1.167517005s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/cloudcredential.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:09.533909944Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:09.541119009Z \n[must-gather-76q5p] POD 2022-05-11T19:29:09.541572651Z Dumping resource gateways.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:10.908170197Z I0511 19:29:10.907949     566 request.go:668] Waited for 1.162229872s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.dnsnetpol/v1beta?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:11.883068150Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:11.888748762Z \n[must-gather-76q5p] POD 2022-05-11T19:29:11.888918646Z Dumping resource handlers.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:13.256083893Z I0511 19:29:13.255877     575 request.go:668] Waited for 1.163680748s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/network.operator.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:14.285409707Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:14.293983954Z \n[must-gather-76q5p] POD 2022-05-11T19:29:14.294086354Z Dumping resource httpapispecbindings.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:15.628948707Z I0511 19:29:15.628755     583 request.go:668] Waited for 1.157953607s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.droplog/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:16.589061254Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:16.599786340Z \n[must-gather-76q5p] POD 2022-05-11T19:29:16.599924448Z Dumping resource httpapispecs.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:17.956406894Z I0511 19:29:17.956148     593 request.go:668] Waited for 1.12767467s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.droplog/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:18.847492987Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:18.854546769Z \n[must-gather-76q5p] POD 2022-05-11T19:29:18.854715984Z Dumping resource importedservicesets.federation.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:20.325916129Z I0511 19:29:20.325710     601 request.go:668] Waited for 1.160120843s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/rbac.authorization.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:21.212976009Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:21.219567879Z \n[must-gather-76q5p] POD 2022-05-11T19:29:21.219750028Z Dumping resource instances.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:22.578681621Z I0511 19:29:22.578455     609 request.go:668] Waited for 1.163859102s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/networking.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:23.486681100Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:23.498122680Z \n[must-gather-76q5p] POD 2022-05-11T19:29:23.498211383Z Dumping resource peerauthentications.security.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:24.867351148Z I0511 19:29:24.867083     617 request.go:668] Waited for 1.163369577s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/node.k8s.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:25.741243786Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:25.747679867Z \n[must-gather-76q5p] POD 2022-05-11T19:29:25.747756421Z Dumping resource policies.authentication.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:27.089355394Z I0511 19:29:27.087807     626 request.go:668] Waited for 1.159010723s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/flowcontrol.apiserver.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:28.022946083Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:28.034037083Z \n[must-gather-76q5p] POD 2022-05-11T19:29:28.034037083Z Dumping resource quotaspecbindings.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:29.396885839Z I0511 19:29:29.396583     634 request.go:668] Waited for 1.165625757s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:30.313949544Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:30.320559685Z \n[must-gather-76q5p] POD 2022-05-11T19:29:30.320776655Z Dumping resource quotaspecs.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:31.676536017Z I0511 19:29:31.676369     642 request.go:668] Waited for 1.172282383s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/security.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:32.585362459Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:32.591912901Z \n[must-gather-76q5p] POD 2022-05-11T19:29:32.592058585Z Dumping resource rbacconfigs.rbac.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:33.941740168Z I0511 19:29:33.941558     650 request.go:668] Waited for 1.159565579s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/networking.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:34.884380600Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:34.896401810Z \n[must-gather-76q5p] POD 2022-05-11T19:29:34.896952384Z Dumping resource requestauthentications.security.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:36.279252049Z I0511 19:29:36.278993     658 request.go:668] Waited for 1.131391723s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/controlplane.operator.openshift.io/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:37.220415733Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:37.230085745Z \n[must-gather-76q5p] POD 2022-05-11T19:29:37.230932808Z Dumping resource rules.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:38.697314966Z I0511 19:29:38.697129     666 request.go:668] Waited for 1.158930978s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/packages.operators.coreos.com/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:39.656137145Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:39.662259519Z \n[must-gather-76q5p] POD 2022-05-11T19:29:39.662259519Z Dumping resource serviceentries.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:41.025748774Z I0511 19:29:41.025573     674 request.go:668] Waited for 1.166357868s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.netpol/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:41.928147828Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:41.933945399Z \n[must-gather-76q5p] POD 2022-05-11T19:29:41.934094206Z Dumping resource servicemeshextensions.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:43.286171664Z I0511 19:29:43.285828     683 request.go:668] Waited for 1.167141681s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/authentication.maistra.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:44.204034584Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:44.209704495Z \n[must-gather-76q5p] POD 2022-05-11T19:29:44.209748625Z Dumping resource servicemeshpeers.federation.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:45.606800430Z I0511 19:29:45.606402     692 request.go:668] Waited for 1.171266447s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.dnsnetpol/v1beta?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:46.556087577Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:46.561506570Z \n[must-gather-76q5p] POD 2022-05-11T19:29:46.561546880Z Dumping resource servicemeshpolicies.authentication.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:47.902166143Z I0511 19:29:47.902011     700 request.go:668] Waited for 1.142294967s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/networking.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:48.806555603Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:48.812657247Z \n[must-gather-76q5p] POD 2022-05-11T19:29:48.812701130Z Dumping resource servicemeshrbacconfigs.rbac.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:50.152495481Z I0511 19:29:50.152252     709 request.go:668] Waited for 1.133612537s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/operators.coreos.com/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:51.010213735Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:51.017089581Z \n[must-gather-76q5p] POD 2022-05-11T19:29:51.017135409Z Dumping resource servicerolebindings.rbac.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:52.384882187Z I0511 19:29:52.384674     717 request.go:668] Waited for 1.159402664s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/authentication.istio.io/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:53.269261754Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:53.275554828Z \n[must-gather-76q5p] POD 2022-05-11T19:29:53.275554828Z Dumping resource serviceroles.rbac.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:54.618964645Z I0511 19:29:54.618797     725 request.go:668] Waited for 1.165281991s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/machine.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:55.623711329Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:55.631643756Z \n[must-gather-76q5p] POD 2022-05-11T19:29:55.631691025Z Dumping resource sidecars.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:56.979147205Z I0511 19:29:56.978938     733 request.go:668] Waited for 1.151376093s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/project.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:29:57.885649730Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:29:57.893149990Z \n[must-gather-76q5p] POD 2022-05-11T19:29:57.893149990Z Dumping resource templates.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:29:59.223883692Z I0511 19:29:59.223658     742 request.go:668] Waited for 1.132636031s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/user.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:00.105370328Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:00.111469119Z \n[must-gather-76q5p] POD 2022-05-11T19:30:00.111469119Z Dumping resource virtualservices.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:01.459239557Z I0511 19:30:01.459079     750 request.go:668] Waited for 1.155663015s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/template.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:02.369310247Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:02.378126997Z \n[must-gather-76q5p] POD 2022-05-11T19:30:02.378318943Z Dumping resource workloadentries.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:03.748386341Z I0511 19:30:03.748217     758 request.go:668] Waited for 1.167789638s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/machine.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:04.696053235Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:04.702426883Z \n[must-gather-76q5p] POD 2022-05-11T19:30:04.702540849Z Dumping resource workloadgroups.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:06.042671586Z I0511 19:30:06.042505     766 request.go:668] Waited for 1.164924309s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/security.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:06.961115067Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:06.971554504Z \n[must-gather-76q5p] POD 2022-05-11T19:30:06.971751975Z Dumping resource servicemeshcontrolplanes.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:08.329952456Z I0511 19:30:08.329776     775 request.go:668] Waited for 1.170206407s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:09.266276960Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:09.272975578Z \n[must-gather-76q5p] POD 2022-05-11T19:30:09.272975578Z Dumping resource servicemeshmemberrolls.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:10.611687266Z I0511 19:30:10.611460     783 request.go:668] Waited for 1.172613041s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:11.502097967Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:11.509007990Z \n[must-gather-76q5p] POD 2022-05-11T19:30:11.509007990Z Dumping resource servicemeshmembers.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:12.874211803Z I0511 19:30:12.874025     791 request.go:668] Waited for 1.169034571s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/security.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:13.760060698Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:13.766543582Z \n[must-gather-76q5p] POD 2022-05-11T19:30:13.766543582Z Dumping CRD adapters.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:15.125803844Z I0511 19:30:15.125522     800 request.go:668] Waited for 1.167080138s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/config.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:16.069830059Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:16.077752182Z \n[must-gather-76q5p] POD 2022-05-11T19:30:16.077752182Z Dumping CRD attributemanifests.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:17.421170159Z I0511 19:30:17.420999     808 request.go:668] Waited for 1.15134864s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/rbac.maistra.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:18.298252625Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:18.304671227Z \n[must-gather-76q5p] POD 2022-05-11T19:30:18.304877786Z Dumping CRD authorizationpolicies.security.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:19.644083927Z I0511 19:30:19.643925     816 request.go:668] Waited for 1.160771534s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/coordination.k8s.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:20.542875575Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:20.553011898Z \n[must-gather-76q5p] POD 2022-05-11T19:30:20.553011898Z Dumping CRD destinationrules.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:21.901877994Z I0511 19:30:21.901555     825 request.go:668] Waited for 1.169872782s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/whereabouts.cni.cncf.io/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:22.874851600Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:22.880929432Z \n[must-gather-76q5p] POD 2022-05-11T19:30:22.881005633Z Dumping CRD envoyfilters.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:24.218301357Z I0511 19:30:24.218019     833 request.go:668] Waited for 1.165262563s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/policy/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:25.213135758Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:25.219576886Z \n[must-gather-76q5p] POD 2022-05-11T19:30:25.219576886Z Dumping CRD exportedservicesets.federation.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:26.571114546Z I0511 19:30:26.570956     841 request.go:668] Waited for 1.168449855s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:27.487749890Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:27.495015856Z \n[must-gather-76q5p] POD 2022-05-11T19:30:27.495145894Z Dumping CRD gateways.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:28.850261494Z I0511 19:30:28.850072     849 request.go:668] Waited for 1.17198083s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/machine.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:29.758191977Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:29.763937729Z \n[must-gather-76q5p] POD 2022-05-11T19:30:29.764063325Z Dumping CRD handlers.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:31.124394857Z I0511 19:30:31.124212     859 request.go:668] Waited for 1.157002768s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/networking.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:32.019385796Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:32.028635503Z \n[must-gather-76q5p] POD 2022-05-11T19:30:32.028743569Z Dumping CRD httpapispecbindings.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:33.377158643Z I0511 19:30:33.376932     867 request.go:668] Waited for 1.150614125s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/flowcontrol.apiserver.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:34.335324769Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:34.342201375Z \n[must-gather-76q5p] POD 2022-05-11T19:30:34.342305344Z Dumping CRD httpapispecs.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:35.690619860Z I0511 19:30:35.688727     875 request.go:668] Waited for 1.162684121s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/whereabouts.cni.cncf.io/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:36.633856155Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:36.639693691Z \n[must-gather-76q5p] POD 2022-05-11T19:30:36.639870148Z Dumping CRD importedservicesets.federation.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:38.020739200Z I0511 19:30:38.020529     883 request.go:668] Waited for 1.168800686s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/config.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:38.899506923Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:38.909251094Z \n[must-gather-76q5p] POD 2022-05-11T19:30:38.909424190Z Dumping CRD instances.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:40.337051531Z I0511 19:30:40.336875     892 request.go:668] Waited for 1.154165109s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/storage.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:41.241396308Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:41.247263182Z \n[must-gather-76q5p] POD 2022-05-11T19:30:41.247358756Z Dumping CRD peerauthentications.security.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:42.625420892Z I0511 19:30:42.625222     900 request.go:668] Waited for 1.161511712s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:43.515203195Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:43.524028074Z \n[must-gather-76q5p] POD 2022-05-11T19:30:43.524379439Z Dumping CRD policies.authentication.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:44.925615316Z I0511 19:30:44.925450     909 request.go:668] Waited for 1.173985341s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/build.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:45.832207129Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:45.838676754Z \n[must-gather-76q5p] POD 2022-05-11T19:30:45.838832128Z Dumping CRD quotaspecbindings.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:47.170177498Z I0511 19:30:47.169982     917 request.go:668] Waited for 1.173835159s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/security.istio.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:48.068379115Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:48.077589215Z \n[must-gather-76q5p] POD 2022-05-11T19:30:48.077692836Z Dumping CRD quotaspecs.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:49.449217528Z I0511 19:30:49.448961     926 request.go:668] Waited for 1.168944007s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/migration.k8s.io/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:50.420320915Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:50.426338431Z \n[must-gather-76q5p] POD 2022-05-11T19:30:50.426436925Z Dumping CRD rbacconfigs.rbac.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:51.775072551Z I0511 19:30:51.773952     935 request.go:668] Waited for 1.173989243s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/snapshot.storage.k8s.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:52.669124450Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:52.675109236Z \n[must-gather-76q5p] POD 2022-05-11T19:30:52.675200505Z Dumping CRD requestauthentications.security.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:54.028192864Z I0511 19:30:54.027894     945 request.go:668] Waited for 1.170771958s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/machine.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:54.987465064Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:54.994439029Z \n[must-gather-76q5p] POD 2022-05-11T19:30:54.994542399Z Dumping CRD rules.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:56.395951649Z I0511 19:30:56.394473     953 request.go:668] Waited for 1.161844068s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/packages.operators.coreos.com/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:57.312861293Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:57.323265245Z \n[must-gather-76q5p] POD 2022-05-11T19:30:57.323265245Z Dumping CRD serviceentries.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:30:58.686298690Z I0511 19:30:58.686112     963 request.go:668] Waited for 1.163489935s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.ctrl/v1alpha1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:30:59.636880575Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:30:59.646405881Z \n[must-gather-76q5p] POD 2022-05-11T19:30:59.646405881Z Dumping CRD servicemeshextensions.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:01.018438714Z I0511 19:31:01.018146     971 request.go:668] Waited for 1.15807904s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:01.924944363Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:01.930935812Z \n[must-gather-76q5p] POD 2022-05-11T19:31:01.930985881Z Dumping CRD servicemeshpeers.federation.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:03.294229579Z I0511 19:31:03.294039     980 request.go:668] Waited for 1.170791431s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/security.internal.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:04.240375584Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:04.255833390Z \n[must-gather-76q5p] POD 2022-05-11T19:31:04.256082594Z Dumping CRD servicemeshpolicies.authentication.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:05.602061041Z I0511 19:31:05.601907     988 request.go:668] Waited for 1.173377442s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/networking.istio.io/v1alpha3?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:06.546151922Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:06.554097889Z \n[must-gather-76q5p] POD 2022-05-11T19:31:06.554423464Z Dumping CRD servicemeshrbacconfigs.rbac.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:07.928254110Z I0511 19:31:07.928065     996 request.go:668] Waited for 1.172783906s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/authentication.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:08.822065841Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:08.831373726Z \n[must-gather-76q5p] POD 2022-05-11T19:31:08.831786404Z Dumping CRD servicerolebindings.rbac.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:10.218462214Z I0511 19:31:10.218244    1004 request.go:668] Waited for 1.15781777s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/snapshot.storage.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:11.074952177Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:11.083811516Z \n[must-gather-76q5p] POD 2022-05-11T19:31:11.083991788Z Dumping CRD serviceroles.rbac.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:12.432260824Z I0511 19:31:12.432040    1013 request.go:668] Waited for 1.163132829s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/cloudcredential.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:13.387082351Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:13.394363164Z \n[must-gather-76q5p] POD 2022-05-11T19:31:13.394461064Z Dumping CRD sidecars.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:14.746388073Z I0511 19:31:14.746158    1021 request.go:668] Waited for 1.163760843s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:15.636501809Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:15.642108998Z \n[must-gather-76q5p] POD 2022-05-11T19:31:15.642270855Z Dumping CRD templates.config.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:16.981213777Z I0511 19:31:16.981058    1030 request.go:668] Waited for 1.157312244s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.dnsnetpol/v1beta?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:18.051277556Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:18.076377384Z \n[must-gather-76q5p] POD 2022-05-11T19:31:18.076823157Z Dumping CRD virtualservices.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:19.464357471Z I0511 19:31:19.464140    1038 request.go:668] Waited for 1.147965459s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/operator.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:20.456496785Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:20.466728790Z \n[must-gather-76q5p] POD 2022-05-11T19:31:20.466858327Z Dumping CRD workloadentries.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:21.816212588Z I0511 19:31:21.816015    1046 request.go:668] Waited for 1.166857008s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/aci.netpol/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:22.710501369Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:22.718623040Z \n[must-gather-76q5p] POD 2022-05-11T19:31:22.718724044Z Dumping CRD workloadgroups.networking.istio.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:24.046594256Z I0511 19:31:24.046396    1054 request.go:668] Waited for 1.169365048s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/machine.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:24.994943024Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:25.004456054Z \n[must-gather-76q5p] POD 2022-05-11T19:31:25.004563557Z Dumping CRD servicemeshcontrolplanes.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:26.397301041Z I0511 19:31:26.397035    1064 request.go:668] Waited for 1.141209414s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/flowcontrol.apiserver.k8s.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:27.412110021Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:27.419318108Z \n[must-gather-76q5p] POD 2022-05-11T19:31:27.419485727Z Dumping CRD servicemeshmemberrolls.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:28.786049811Z I0511 19:31:28.785842    1072 request.go:668] Waited for 1.160018178s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/config.openshift.io/v1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:29.711030298Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:29.719157515Z \n[must-gather-76q5p] POD 2022-05-11T19:31:29.719948626Z Dumping CRD servicemeshmembers.maistra.io...\n[must-gather-76q5p] POD 2022-05-11T19:31:31.076530946Z I0511 19:31:31.076361    1081 request.go:668] Waited for 1.170573456s due to client-side throttling, not priority and fairness, request: GET:https://172.30.0.1:443/apis/helm.openshift.io/v1beta1?timeout=32s\n[must-gather-76q5p] POD 2022-05-11T19:31:32.066077005Z Wrote inspect data to /must-gather.\n[must-gather-76q5p] POD 2022-05-11T19:31:32.078916895Z \n[must-gather-76q5p] POD 2022-05-11T19:31:32.078916895Z \n[must-gather-76q5p] POD 2022-05-11T19:31:32.078916895Z Done\n[must-gather-76q5p] POD 2022-05-11T19:31:32.078916895Z \n[must-gather-76q5p] OUT waiting for gather to complete\n[must-gather-76q5p] OUT downloading gather output\n[must-gather-76q5p] OUT receiving incremental file list\n[must-gather-76q5p] OUT event-filter.html\n[must-gather-76q5p] OUT timestamp\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/mutatingwebhookconfigurations/istiod-istio-system-istio-system.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/mutatingwebhookconfigurations/machine-api.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/mutatingwebhookconfigurations/openshift-operators.servicemesh-resources.maistra.io.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/validatingwebhookconfigurations/autoscaling.openshift.io.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/validatingwebhookconfigurations/istiod-istio-system-istio-system.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/validatingwebhookconfigurations/machine-api.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/validatingwebhookconfigurations/multus.openshift.io.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/validatingwebhookconfigurations/openshift-operators.servicemesh-resources.maistra.io.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/validatingwebhookconfigurations/prometheusrules.openshift.io.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/admissionregistration.k8s.io/validatingwebhookconfigurations/snapshot.storage.k8s.io.yaml\n[must-gather-76q5p] OUT cluster-scoped-resources/apiextensions.k8s.io/customresourcedefinitions/adapters.config.istio.io.yaml\n[must-gather-76q5p] OUT namespaces/bar/maistra.io/servicemeshmembers/default.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/bookinfo.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/apps.openshift.io/deploymentconfigs.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/apps/daemonsets.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/apps/deployments.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/apps/replicasets.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/apps/statefulsets.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/autoscaling/horizontalpodautoscalers.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/batch/cronjobs.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/batch/jobs.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/build.openshift.io/buildconfigs.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/build.openshift.io/builds.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/configmaps.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/endpoints.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/events.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/persistentvolumeclaims.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/pods.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/replicationcontrollers.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/secrets.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/core/services.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/discovery.k8s.io/endpointslices.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/image.openshift.io/imagestreams.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/maistra.io/servicemeshmembers/default.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/networking.istio.io/destinationrules/details.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/networking.istio.io/destinationrules/productpage.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/networking.istio.io/destinationrules/ratings.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/networking.istio.io/destinationrules/reviews.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/networking.istio.io/gateways/bookinfo-gateway.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/networking.istio.io/serviceentries/proxy.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/networking.istio.io/virtualservices/bookinfo.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/details-v1-6cd699df8c-9v2xt.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/details/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/details/details/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/details/details/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/details/details/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/details/details/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/details/details/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/details-v1-6cd699df8c-9v2xt/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/productpage-v1-5ddcb4b84f-k4wfj.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/productpage/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/productpage/productpage/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/productpage/productpage/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/productpage/productpage/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/productpage/productpage/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/productpage-v1-5ddcb4b84f-k4wfj/productpage/productpage/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/ratings-v1-bdbcc68bc-gwmj6.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/ratings/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/ratings/ratings/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/ratings/ratings/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/ratings/ratings/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/ratings/ratings/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/ratings-v1-bdbcc68bc-gwmj6/ratings/ratings/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/reviews-v1-754ddd7b6f-h5k6h.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/reviews/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/reviews/reviews/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/reviews/reviews/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/reviews/reviews/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/reviews/reviews/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v1-754ddd7b6f-h5k6h/reviews/reviews/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/reviews-v2-675679877f-6th8w.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/reviews/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/reviews/reviews/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/reviews/reviews/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/reviews/reviews/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/reviews/reviews/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v2-675679877f-6th8w/reviews/reviews/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/reviews-v3-79d7549c7-cpvh7.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/reviews/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/reviews/reviews/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/reviews/reviews/logs/\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/reviews/reviews/logs/current.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/reviews/reviews/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/bookinfo/pods/reviews-v3-79d7549c7-cpvh7/reviews/reviews/logs/previous.log\n[must-gather-76q5p] OUT namespaces/bookinfo/policy/poddisruptionbudgets.yaml\n[must-gather-76q5p] OUT namespaces/bookinfo/route.openshift.io/routes.yaml\n[must-gather-76q5p] OUT namespaces/foo/maistra.io/servicemeshmembers/default.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/apps.openshift.io/deploymentconfigs.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/apps/daemonsets.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/apps/deployments.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/apps/replicasets.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/apps/statefulsets.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/autoscaling/horizontalpodautoscalers.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/batch/cronjobs.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/batch/jobs.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/build.openshift.io/buildconfigs.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/build.openshift.io/builds.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/controlplane/synchronization\n[must-gather-76q5p] OUT namespaces/istio-system/core/configmaps.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/core/endpoints.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/core/events.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/core/persistentvolumeclaims.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/core/pods.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/core/replicationcontrollers.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/core/secrets.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/core/services.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/discovery.k8s.io/endpointslices.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/image.openshift.io/imagestreams.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/jaegertracing.io/jaegers/jaeger.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/kiali.io/kialis/kiali.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/maistra.io/servicemeshcontrolplanes/istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/maistra.io/servicemeshmemberrolls/default.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/destinationrules/api-server.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/destinationrules/default.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/destinationrules/disable-mtls-jaeger-collector.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/destinationrules/disable-mtls-zipkin.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/destinationrules/istiod-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/destinationrules/wasm-cacher-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/metadata-exchange-1.6-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/metadata-exchange-1.8-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/metadata-exchange-1.9-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/stats-filter-1.6-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/stats-filter-1.8-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/stats-filter-1.9-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/tcp-metadata-exchange-1.6-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/tcp-metadata-exchange-1.8-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/tcp-metadata-exchange-1.9-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/tcp-stats-filter-1.6-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/tcp-stats-filter-1.8-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/networking.istio.io/envoyfilters/tcp-stats-filter-1.9-istio-system.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana-797bdb99db-qscbz.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana-proxy/grafana-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana-proxy/grafana-proxy/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana-proxy/grafana-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana-proxy/grafana-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana-proxy/grafana-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana/grafana/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana/grafana/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana/grafana/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana/grafana/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/grafana-797bdb99db-qscbz/grafana/grafana/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/istio-egressgateway-76888d7857-p7tfg.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/istio-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-egressgateway-76888d7857-p7tfg/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/envoyConfiguration\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/istio-ingressgateway-7f9fbf8688-8kvqs.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/pilotConfiguration\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/istio-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/istio-proxy/istio-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/istio-proxy/istio-proxy/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/istio-proxy/istio-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/istio-proxy/istio-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istio-ingressgateway-7f9fbf8688-8kvqs/istio-proxy/istio-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/istiod-istio-system-868f5c8449-grl4h.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/discovery/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/discovery/discovery/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/discovery/discovery/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/discovery/discovery/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/discovery/discovery/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/istiod-istio-system-868f5c8449-grl4h/discovery/discovery/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/jaeger-657bd6b6f5-9rzcp.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/jaeger/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/jaeger/jaeger/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/jaeger/jaeger/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/jaeger/jaeger/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/jaeger/jaeger/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/jaeger/jaeger/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/oauth-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/oauth-proxy/oauth-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/oauth-proxy/oauth-proxy/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/oauth-proxy/oauth-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/oauth-proxy/oauth-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/jaeger-657bd6b6f5-9rzcp/oauth-proxy/oauth-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/kiali-767b789c5c-js29p.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/kiali/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/kiali/kiali/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/kiali/kiali/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/kiali/kiali/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/kiali/kiali/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/kiali-767b789c5c-js29p/kiali/kiali/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus-565c449c44-xrlzd.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus-proxy/prometheus-proxy/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus-proxy/prometheus-proxy/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus-proxy/prometheus-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus-proxy/prometheus-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus-proxy/prometheus-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus/prometheus/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus/prometheus/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus/prometheus/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus/prometheus/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/prometheus-565c449c44-xrlzd/prometheus/prometheus/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/wasm-cacher-istio-system-6fdf689cf9-7648z.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/wasm-cacher/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/wasm-cacher/wasm-cacher/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/wasm-cacher/wasm-cacher/logs/\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/wasm-cacher/wasm-cacher/logs/current.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/wasm-cacher/wasm-cacher/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/istio-system/pods/wasm-cacher-istio-system-6fdf689cf9-7648z/wasm-cacher/wasm-cacher/logs/previous.log\n[must-gather-76q5p] OUT namespaces/istio-system/policy/poddisruptionbudgets.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/route.openshift.io/routes.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/security.istio.io/peerauthentications/default.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/security.istio.io/peerauthentications/disable-mtls-jaeger-collector.yaml\n[must-gather-76q5p] OUT namespaces/istio-system/security.istio.io/peerauthentications/grafana-ports-mtls-disabled.yaml\n[must-gather-76q5p] OUT namespaces/legacy/maistra.io/servicemeshmembers/default.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/openshift-operators.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/apps.openshift.io/deploymentconfigs.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/apps/daemonsets.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/apps/deployments.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/apps/replicasets.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/apps/statefulsets.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/autoscaling/horizontalpodautoscalers.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/batch/cronjobs.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/batch/jobs.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/build.openshift.io/buildconfigs.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/build.openshift.io/builds.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/configmaps.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/endpoints.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/events.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/persistentvolumeclaims.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/pods.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/replicationcontrollers.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/secrets.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/core/services.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/discovery.k8s.io/endpointslices.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/image.openshift.io/imagestreams.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/istio-node-j52sn.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v1-0/install-cni-v1-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v1-0/install-cni-v1-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v1-0/install-cni-v1-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v1-1/install-cni-v1-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v1-1/install-cni-v1-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v1-1/install-cni-v1-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v2-0/install-cni-v2-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v2-0/install-cni-v2-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v2-0/install-cni-v2-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v2-1/install-cni-v2-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v2-1/install-cni-v2-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-j52sn/install-cni-v2-1/install-cni-v2-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/istio-node-jbhcj.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v1-0/install-cni-v1-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v1-0/install-cni-v1-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v1-0/install-cni-v1-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v1-1/install-cni-v1-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v1-1/install-cni-v1-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v1-1/install-cni-v1-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v2-0/install-cni-v2-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v2-0/install-cni-v2-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v2-0/install-cni-v2-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v2-1/install-cni-v2-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v2-1/install-cni-v2-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-jbhcj/install-cni-v2-1/install-cni-v2-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/istio-node-nv8b8.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v1-0/install-cni-v1-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v1-0/install-cni-v1-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v1-0/install-cni-v1-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v1-1/install-cni-v1-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v1-1/install-cni-v1-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v1-1/install-cni-v1-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v2-0/install-cni-v2-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v2-0/install-cni-v2-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v2-0/install-cni-v2-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v2-1/install-cni-v2-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v2-1/install-cni-v2-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-nv8b8/install-cni-v2-1/install-cni-v2-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/istio-node-ssq87.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v1-0/install-cni-v1-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v1-0/install-cni-v1-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v1-0/install-cni-v1-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v1-1/install-cni-v1-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v1-1/install-cni-v1-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v1-1/install-cni-v1-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v2-0/install-cni-v2-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v2-0/install-cni-v2-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v2-0/install-cni-v2-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v2-1/install-cni-v2-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v2-1/install-cni-v2-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-ssq87/install-cni-v2-1/install-cni-v2-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/istio-node-t6zpp.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v1-0/install-cni-v1-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v1-0/install-cni-v1-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v1-0/install-cni-v1-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v1-1/install-cni-v1-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v1-1/install-cni-v1-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v1-1/install-cni-v1-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v2-0/install-cni-v2-0/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v2-0/install-cni-v2-0/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v2-0/install-cni-v2-0/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v2-1/install-cni-v2-1/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v2-1/install-cni-v2-1/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-node-t6zpp/install-cni-v2-1/install-cni-v2-1/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-operator-7b7b874c6-pl82m/istio-operator-7b7b874c6-pl82m.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-operator-7b7b874c6-pl82m/istio-operator/istio-operator/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-operator-7b7b874c6-pl82m/istio-operator/istio-operator/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/istio-operator-7b7b874c6-pl82m/istio-operator/istio-operator/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-all-in-one-inmemory-7766bb6568-827fb/jaeger-all-in-one-inmemory-7766bb6568-827fb.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-all-in-one-inmemory-7766bb6568-827fb/jaeger/jaeger/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-all-in-one-inmemory-7766bb6568-827fb/jaeger/jaeger/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-all-in-one-inmemory-7766bb6568-827fb/jaeger/jaeger/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-operator-55fb695857-7c7dw/jaeger-operator-55fb695857-7c7dw.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-operator-55fb695857-7c7dw/jaeger-operator/jaeger-operator/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-operator-55fb695857-7c7dw/jaeger-operator/jaeger-operator/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-operator-55fb695857-7c7dw/jaeger-operator/jaeger-operator/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-operator-55fb695857-7c7dw/kube-rbac-proxy/kube-rbac-proxy/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-operator-55fb695857-7c7dw/kube-rbac-proxy/kube-rbac-proxy/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/jaeger-operator-55fb695857-7c7dw/kube-rbac-proxy/kube-rbac-proxy/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/kiali-operator-d5dbf94d7-h2w6l/kiali-operator-d5dbf94d7-h2w6l.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/kiali-operator-d5dbf94d7-h2w6l/operator/operator/logs/current.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/kiali-operator-d5dbf94d7-h2w6l/operator/operator/logs/previous.insecure.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/pods/kiali-operator-d5dbf94d7-h2w6l/operator/operator/logs/previous.log\n[must-gather-76q5p] OUT namespaces/openshift-operators/policy/poddisruptionbudgets.yaml\n[must-gather-76q5p] OUT namespaces/openshift-operators/route.openshift.io/routes.yaml\n[must-gather-76q5p] OUT \n[must-gather-76q5p] OUT sent 93,122 bytes  received 1,275,441 bytes  304,125.11 bytes/sec\n[must-gather-76q5p] OUT total size is 46,616,276  speedup is 34.06\n[must-gather      ] OUT clusterrolebinding.rbac.authorization.k8s.io/must-gather-z7t7h deleted\n[must-gather      ] OUT namespace/openshift-must-gather-s4mhb deleted\n\n\nWhen opening a support case, bugzilla, or issue please include the following summary data along with any other requested information.\nClusterID: abcf5756-83e4-4086-9d72-9bc9b30117f5\nClusterVersion: Stable at \"4.7.39\"\nClusterOperators:\n\tclusteroperator/ingress is degraded because Some ingresscontrollers are degraded: ingresscontroller \"default\" is degraded: DegradedConditions: One or more other status conditions indicate a degraded state: CanaryChecksSucceeding=False (CanaryChecksRepetitiveFailures: Canary route checks for the default ingress controller are failing)\n\n"
time="2022-05-11T15:35:57-04:00" level=info msg="Check cluster-scoped openshift-operators.servicemesh-resources.maistra.io.yaml"
time="2022-05-11T15:35:57-04:00" level=info msg="file exists: [debug/registry-redhat-io-openshift-service-mesh-istio-must-gather-rhel8-sha256-35844d0317a98a0d0c8b344f25a92d68d4624387f2dfe3cf23888584c24d5986/cluster-scoped-resources/admissionregistration.k8s.io/mutatingwebhookconfigurations/openshift-operators.servicemesh-resources.maistra.io.yaml]"
time="2022-05-11T15:35:57-04:00" level=info msg="Cleanup ..."
time="2022-05-11T15:35:57-04:00" level=info msg="Cleanup Bookinfo"
time="2022-05-11T15:35:57-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/destination-rule-all.yaml"
time="2022-05-11T15:35:57-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo-gateway.yaml"
time="2022-05-11T15:35:57-04:00" level=info msg="Running command kubectl delete -n bookinfo -f ../testdata/examples/x86/bookinfo/bookinfo.yaml"
--- PASS: T30 (289.62s)
    --- PASS: T30/smcp_test_must_gather (205.37s)
=== RUN   T31
=== RUN   T31/federation_single_cluster_install
time="2022-05-11T15:36:29-04:00" level=info msg="Test federation install in a single cluster"
time="2022-05-11T15:36:29-04:00" level=info msg="Reference: https://github.com/maistra/istio/blob/maistra-2.1/pkg/servicemesh/federation/example/config-poc/install.sh"
time="2022-05-11T15:36:29-04:00" level=info msg="Running install.sh waiting 1 min..."
time="2022-05-11T15:36:29-04:00" level=info msg="Running command pushd ../testdata/examples/federation \\\n\t\t\t&& export MESH1_KUBECONFIG=~/.kube/config \\\n\t\t\t&& export MESH2_KUBECONFIG=~/.kube/config \\\n\t\t\t&& ./install.sh"
time="2022-05-11T15:37:58-04:00" level=info msg="Command output: \n~/Downloads/maistra-test-tool/testdata/examples/federation ~/Downloads/maistra-test-tool/tests\n\n##### Using the following kubeconfig files:\nmesh1: /home/noiro/.kube/config\nmesh2: /home/noiro/.kube/config\n\n##### Creating projects for mesh1\nNow using project \"mesh1-system\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\nNow using project \"mesh1-bookinfo\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\n\n##### Installing control plane for mesh1\nservicemeshcontrolplane.maistra.io/fed-export created\nservicemeshmemberroll.maistra.io/default created\nservicemeshcontrolplane.maistra.io/fed-export patched\n\n##### Creating projects for mesh2\nNow using project \"mesh2-system\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\nNow using project \"mesh2-bookinfo\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\n\n##### Installing control plane for mesh2\nservicemeshcontrolplane.maistra.io/fed-import created\nservicemeshmemberroll.maistra.io/default created\nservicemeshcontrolplane.maistra.io/fed-import patched\n\n##### Waiting for mesh1 installation to complete\nservicemeshmemberroll.maistra.io/default condition met\n\n##### Waiting for mesh2 installation to complete\nservicemeshmemberroll.maistra.io/default condition met\n\n##### Retrieving root certificates\n\n##### Retrieving ingress addresses\nSingle cluster detected; using cluster-local service for ingress\nMESH1_ADDRESS=mesh2-ingress.mesh1-system.svc.cluster.local\nMESH2_ADDRESS=mesh1-ingress.mesh2-system.svc.cluster.local\n\n##### Enabling federation for mesh1\nconfigmap/mesh2-ca-root-cert created\nservicemeshpeer.federation.maistra.io/mesh2 created\nexportedserviceset.federation.maistra.io/mesh2 created\n\n##### Enabling federation for mesh2\nconfigmap/mesh1-ca-root-cert created\nservicemeshpeer.federation.maistra.io/mesh1 created\nimportedserviceset.federation.maistra.io/mesh1 created\n\n##### Installing bookinfo in mesh1\nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created\nserviceaccount/bookinfo-ratings-v2 created\ndeployment.apps/ratings-v2 created\nservice/mongodb created\ndeployment.apps/mongodb-v1 created\ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created\n\n##### Installing bookinfo in mesh2\nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created\nserviceaccount/bookinfo-ratings-v2 created\ndeployment.apps/ratings-v2 created\ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created\ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created\nvirtualservice.networking.istio.io/reviews created\n\n##### Installing mongodb k8s Service for mesh2\nservice/mongodb created\n\n##### Installing VirtualServices for mesh2\nvirtualservice.networking.istio.io/mongodb-remote created\nvirtualservice.networking.istio.io/ratings-split created\n\n##### INSTALLATION COMPLETE"
time="2022-05-11T15:37:58-04:00" level=info msg="Waiting 40s..."
time="2022-05-11T15:38:38-04:00" level=info msg="Verify mesh1 connection status"
time="2022-05-11T15:38:38-04:00" level=info msg="Running command oc -n mesh1-system get servicemeshpeer mesh2 -o json"
time="2022-05-11T15:38:38-04:00" level=info msg="Command output: \n{\n    \"apiVersion\": \"federation.maistra.io/v1\",\n    \"kind\": \"ServiceMeshPeer\",\n    \"metadata\": {\n        \"annotations\": {\n            \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"federation.maistra.io/v1\\\",\\\"kind\\\":\\\"ServiceMeshPeer\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"mesh2\\\",\\\"namespace\\\":\\\"mesh1-system\\\"},\\\"spec\\\":{\\\"gateways\\\":{\\\"egress\\\":{\\\"name\\\":\\\"mesh2-egress\\\"},\\\"ingress\\\":{\\\"name\\\":\\\"mesh2-ingress\\\"}},\\\"remote\\\":{\\\"addresses\\\":[\\\"mesh1-ingress.mesh2-system.svc.cluster.local\\\"],\\\"discoveryPort\\\":8188,\\\"servicePort\\\":15443},\\\"security\\\":{\\\"certificateChain\\\":{\\\"kind\\\":\\\"ConfigMap\\\",\\\"name\\\":\\\"mesh2-ca-root-cert\\\"},\\\"clientID\\\":\\\"mesh2.local/ns/mesh2-system/sa/mesh1-egress-service-account\\\",\\\"trustDomain\\\":\\\"mesh2.local\\\"}}}\\n\"\n        },\n        \"creationTimestamp\": \"2022-05-11T19:32:57Z\",\n        \"generation\": 1,\n        \"managedFields\": [\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:metadata\": {\n                        \"f:annotations\": {\n                            \".\": {},\n                            \"f:kubectl.kubernetes.io/last-applied-configuration\": {}\n                        }\n                    },\n                    \"f:spec\": {\n                        \".\": {},\n                        \"f:gateways\": {\n                            \".\": {},\n                            \"f:egress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:ingress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            }\n                        },\n                        \"f:remote\": {\n                            \".\": {},\n                            \"f:addresses\": {},\n                            \"f:discoveryPort\": {},\n                            \"f:servicePort\": {}\n                        },\n                        \"f:security\": {\n                            \".\": {},\n                            \"f:certificateChain\": {\n                                \".\": {},\n                                \"f:kind\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:clientID\": {},\n                            \"f:trustDomain\": {}\n                        }\n                    }\n                },\n                \"manager\": \"kubectl-client-side-apply\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:32:57Z\"\n            },\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:status\": {\n                        \".\": {},\n                        \"f:discoveryStatus\": {\n                            \".\": {},\n                            \"f:active\": {\n                                \".\": {},\n                                \"k:{\\\"pod\\\":\\\"istiod-fed-export-7846bb76cb-pq577\\\"}\": {\n                                    \".\": {},\n                                    \"f:pod\": {},\n                                    \"f:remotes\": {\n                                        \".\": {},\n                                        \"k:{\\\"source\\\":\\\"15.128.0.189\\\"}\": {\n                                            \".\": {},\n                                            \"f:connected\": {},\n                                            \"f:lastConnected\": {},\n                                            \"f:lastDisconnect\": {},\n                                            \"f:lastEvent\": {},\n                                            \"f:lastFullSync\": {},\n                                            \"f:source\": {}\n                                        }\n                                    },\n                                    \"f:watch\": {\n                                        \".\": {},\n                                        \"f:connected\": {},\n                                        \"f:lastConnected\": {},\n                                        \"f:lastDisconnectStatus\": {},\n                                        \"f:lastFullSync\": {}\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                \"manager\": \"pilot-discovery\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:34:14Z\"\n            }\n        ],\n        \"name\": \"mesh2\",\n        \"namespace\": \"mesh1-system\",\n        \"resourceVersion\": \"29581965\",\n        \"selfLink\": \"/apis/federation.maistra.io/v1/namespaces/mesh1-system/servicemeshpeers/mesh2\",\n        \"uid\": \"2d800250-34ea-4964-a94a-8aa09f8902eb\"\n    },\n    \"spec\": {\n        \"gateways\": {\n            \"egress\": {\n                \"name\": \"mesh2-egress\"\n            },\n            \"ingress\": {\n                \"name\": \"mesh2-ingress\"\n            }\n        },\n        \"remote\": {\n            \"addresses\": [\n                \"mesh1-ingress.mesh2-system.svc.cluster.local\"\n            ],\n            \"discoveryPort\": 8188,\n            \"servicePort\": 15443\n        },\n        \"security\": {\n            \"certificateChain\": {\n                \"kind\": \"ConfigMap\",\n                \"name\": \"mesh2-ca-root-cert\"\n            },\n            \"clientID\": \"mesh2.local/ns/mesh2-system/sa/mesh1-egress-service-account\",\n            \"trustDomain\": \"mesh2.local\"\n        }\n    },\n    \"status\": {\n        \"discoveryStatus\": {\n            \"active\": [\n                {\n                    \"pod\": \"istiod-fed-export-7846bb76cb-pq577\",\n                    \"remotes\": [\n                        {\n                            \"connected\": true,\n                            \"lastConnected\": \"2022-05-11T19:33:49Z\",\n                            \"lastDisconnect\": \"2022-05-11T19:33:46Z\",\n                            \"lastEvent\": \"2022-05-11T19:33:00Z\",\n                            \"lastFullSync\": \"2022-05-11T19:33:49Z\",\n                            \"source\": \"15.128.0.189\"\n                        }\n                    ],\n                    \"watch\": {\n                        \"connected\": true,\n                        \"lastConnected\": \"2022-05-11T19:33:00Z\",\n                        \"lastDisconnectStatus\": \"503 Service Unavailable\",\n                        \"lastFullSync\": \"2022-05-11T19:33:00Z\"\n                    }\n                }\n            ]\n        }\n    }\n}"
time="2022-05-11T15:38:38-04:00" level=info msg="mesh1-system connected true"
time="2022-05-11T15:38:38-04:00" level=info msg="Verify mesh2 connection status"
time="2022-05-11T15:38:38-04:00" level=info msg="Running command oc -n mesh2-system get servicemeshpeer mesh1 -o json"
time="2022-05-11T15:38:39-04:00" level=info msg="Command output: \n{\n    \"apiVersion\": \"federation.maistra.io/v1\",\n    \"kind\": \"ServiceMeshPeer\",\n    \"metadata\": {\n        \"annotations\": {\n            \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"federation.maistra.io/v1\\\",\\\"kind\\\":\\\"ServiceMeshPeer\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"mesh1\\\",\\\"namespace\\\":\\\"mesh2-system\\\"},\\\"spec\\\":{\\\"gateways\\\":{\\\"egress\\\":{\\\"name\\\":\\\"mesh1-egress\\\"},\\\"ingress\\\":{\\\"name\\\":\\\"mesh1-ingress\\\"}},\\\"remote\\\":{\\\"addresses\\\":[\\\"mesh2-ingress.mesh1-system.svc.cluster.local\\\"],\\\"discoveryPort\\\":8188,\\\"servicePort\\\":15443},\\\"security\\\":{\\\"certificateChain\\\":{\\\"kind\\\":\\\"ConfigMap\\\",\\\"name\\\":\\\"mesh1-ca-root-cert\\\"},\\\"clientID\\\":\\\"mesh1.local/ns/mesh1-system/sa/mesh2-egress-service-account\\\",\\\"trustDomain\\\":\\\"mesh1.local\\\"}}}\\n\"\n        },\n        \"creationTimestamp\": \"2022-05-11T19:32:59Z\",\n        \"generation\": 1,\n        \"managedFields\": [\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:metadata\": {\n                        \"f:annotations\": {\n                            \".\": {},\n                            \"f:kubectl.kubernetes.io/last-applied-configuration\": {}\n                        }\n                    },\n                    \"f:spec\": {\n                        \".\": {},\n                        \"f:gateways\": {\n                            \".\": {},\n                            \"f:egress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:ingress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            }\n                        },\n                        \"f:remote\": {\n                            \".\": {},\n                            \"f:addresses\": {},\n                            \"f:discoveryPort\": {},\n                            \"f:servicePort\": {}\n                        },\n                        \"f:security\": {\n                            \".\": {},\n                            \"f:certificateChain\": {\n                                \".\": {},\n                                \"f:kind\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:clientID\": {},\n                            \"f:trustDomain\": {}\n                        }\n                    }\n                },\n                \"manager\": \"kubectl-client-side-apply\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:32:59Z\"\n            },\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:status\": {\n                        \".\": {},\n                        \"f:discoveryStatus\": {\n                            \".\": {},\n                            \"f:active\": {\n                                \".\": {},\n                                \"k:{\\\"pod\\\":\\\"istiod-fed-import-7b97dd6cc5-qzvqt\\\"}\": {\n                                    \".\": {},\n                                    \"f:pod\": {},\n                                    \"f:remotes\": {\n                                        \".\": {},\n                                        \"k:{\\\"source\\\":\\\"15.128.0.188\\\"}\": {\n                                            \".\": {},\n                                            \"f:connected\": {},\n                                            \"f:lastConnected\": {},\n                                            \"f:lastFullSync\": {},\n                                            \"f:source\": {}\n                                        }\n                                    },\n                                    \"f:watch\": {\n                                        \".\": {},\n                                        \"f:connected\": {},\n                                        \"f:lastConnected\": {},\n                                        \"f:lastDisconnect\": {},\n                                        \"f:lastDisconnectStatus\": {},\n                                        \"f:lastFullSync\": {}\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                \"manager\": \"pilot-discovery\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:33:49Z\"\n            }\n        ],\n        \"name\": \"mesh1\",\n        \"namespace\": \"mesh2-system\",\n        \"resourceVersion\": \"29581966\",\n        \"selfLink\": \"/apis/federation.maistra.io/v1/namespaces/mesh2-system/servicemeshpeers/mesh1\",\n        \"uid\": \"d0abe839-1b50-4ed8-b91d-54a3695f7367\"\n    },\n    \"spec\": {\n        \"gateways\": {\n            \"egress\": {\n                \"name\": \"mesh1-egress\"\n            },\n            \"ingress\": {\n                \"name\": \"mesh1-ingress\"\n            }\n        },\n        \"remote\": {\n            \"addresses\": [\n                \"mesh2-ingress.mesh1-system.svc.cluster.local\"\n            ],\n            \"discoveryPort\": 8188,\n            \"servicePort\": 15443\n        },\n        \"security\": {\n            \"certificateChain\": {\n                \"kind\": \"ConfigMap\",\n                \"name\": \"mesh1-ca-root-cert\"\n            },\n            \"clientID\": \"mesh1.local/ns/mesh1-system/sa/mesh2-egress-service-account\",\n            \"trustDomain\": \"mesh1.local\"\n        }\n    },\n    \"status\": {\n        \"discoveryStatus\": {\n            \"active\": [\n                {\n                    \"pod\": \"istiod-fed-import-7b97dd6cc5-qzvqt\",\n                    \"remotes\": [\n                        {\n                            \"connected\": true,\n                            \"lastConnected\": \"2022-05-11T19:33:00Z\",\n                            \"lastFullSync\": \"2022-05-11T19:33:00Z\",\n                            \"source\": \"15.128.0.188\"\n                        }\n                    ],\n                    \"watch\": {\n                        \"connected\": true,\n                        \"lastConnected\": \"2022-05-11T19:33:49Z\",\n                        \"lastDisconnect\": \"2022-05-11T19:33:48Z\",\n                        \"lastDisconnectStatus\": \"200 OK\",\n                        \"lastFullSync\": \"2022-05-11T19:33:49Z\"\n                    }\n                }\n            ]\n        }\n    }\n}"
time="2022-05-11T15:38:39-04:00" level=info msg="mesh2-system connected true"
time="2022-05-11T15:38:39-04:00" level=info msg="Verify if services from mesh1 are imported into mesh2"
time="2022-05-11T15:38:39-04:00" level=info msg="Running command oc -n mesh2-system get importedservicesets mesh1 -o json"
time="2022-05-11T15:38:39-04:00" level=info msg="Command output: \n{\n    \"apiVersion\": \"federation.maistra.io/v1\",\n    \"kind\": \"ImportedServiceSet\",\n    \"metadata\": {\n        \"annotations\": {\n            \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"federation.maistra.io/v1\\\",\\\"kind\\\":\\\"ImportedServiceSet\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"mesh1\\\",\\\"namespace\\\":\\\"mesh2-system\\\"},\\\"spec\\\":{\\\"importRules\\\":[{\\\"importAsLocal\\\":false,\\\"nameSelector\\\":{\\\"alias\\\":{\\\"namespace\\\":\\\"mesh2-bookinfo\\\"},\\\"namespace\\\":\\\"bookinfo\\\"},\\\"type\\\":\\\"NameSelector\\\"}]}}\\n\"\n        },\n        \"creationTimestamp\": \"2022-05-11T19:32:59Z\",\n        \"generation\": 1,\n        \"managedFields\": [\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:metadata\": {\n                        \"f:annotations\": {\n                            \".\": {},\n                            \"f:kubectl.kubernetes.io/last-applied-configuration\": {}\n                        }\n                    },\n                    \"f:spec\": {\n                        \".\": {},\n                        \"f:importRules\": {}\n                    }\n                },\n                \"manager\": \"kubectl-client-side-apply\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:32:59Z\"\n            },\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:status\": {\n                        \".\": {},\n                        \"f:importedServices\": {\n                            \".\": {},\n                            \"k:{\\\"exportedName\\\":\\\"ratings.bookinfo.svc.mesh2-exports.local\\\"}\": {\n                                \".\": {},\n                                \"f:exportedName\": {},\n                                \"f:localService\": {\n                                    \".\": {},\n                                    \"f:hostname\": {},\n                                    \"f:name\": {},\n                                    \"f:namespace\": {}\n                                }\n                            }\n                        }\n                    }\n                },\n                \"manager\": \"pilot-discovery\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:33:01Z\"\n            }\n        ],\n        \"name\": \"mesh1\",\n        \"namespace\": \"mesh2-system\",\n        \"resourceVersion\": \"29580992\",\n        \"selfLink\": \"/apis/federation.maistra.io/v1/namespaces/mesh2-system/importedservicesets/mesh1\",\n        \"uid\": \"9901843c-fdba-4ed0-9b12-bbc6690dddc6\"\n    },\n    \"spec\": {\n        \"importRules\": [\n            {\n                \"importAsLocal\": false,\n                \"nameSelector\": {\n                    \"alias\": {\n                        \"namespace\": \"mesh2-bookinfo\"\n                    },\n                    \"namespace\": \"bookinfo\"\n                },\n                \"type\": \"NameSelector\"\n            }\n        ]\n    },\n    \"status\": {\n        \"importedServices\": [\n            {\n                \"exportedName\": \"ratings.bookinfo.svc.mesh2-exports.local\",\n                \"localService\": {\n                    \"hostname\": \"ratings.mesh2-bookinfo.svc.mesh1-imports.local\",\n                    \"name\": \"ratings\",\n                    \"namespace\": \"mesh2-bookinfo\"\n                }\n            }\n        ]\n    }\n}"
    fed_single_cluster_install.go:94: mesh2-system failed to get both mongodb and ratings services from mesh1
time="2022-05-11T15:38:39-04:00" level=error msg="mesh2-system failed to get both mongodb and ratings services from mesh1"
time="2022-05-11T15:38:39-04:00" level=info msg="Cleanup ..."
time="2022-05-11T15:38:39-04:00" level=info msg="Running command pushd ../testdata/examples/federation \\\n\t\t\t&& export MESH1_KUBECONFIG=~/.kube/config \\\n\t\t\t&& export MESH2_KUBECONFIG=~/.kube/config \\\n\t\t\t&& ./cleanup.sh"
time="2022-05-11T15:40:41-04:00" level=info msg="Command output: \n~/Downloads/maistra-test-tool/testdata/examples/federation ~/Downloads/maistra-test-tool/tests\n\n##### Using the following kubeconfig files:\nmesh1: /home/noiro/.kube/config\nmesh2: /home/noiro/.kube/config\nservicemeshpeer.federation.maistra.io \"mesh2\" deleted\nservicemeshpeer.federation.maistra.io \"mesh1\" deleted\nproject.project.openshift.io \"mesh1-system\" deleted\nproject.project.openshift.io \"mesh2-system\" deleted\nproject.project.openshift.io \"mesh1-bookinfo\" deleted\nproject.project.openshift.io \"mesh2-bookinfo\" deleted"
--- FAIL: T31 (271.67s)
    --- FAIL: T31/federation_single_cluster_install (129.87s)
=== RUN   T32
=== RUN   T32/federation_single_cluster_different_cert_install
time="2022-05-11T15:41:01-04:00" level=info msg="Test federation install in a single cluster"
time="2022-05-11T15:41:01-04:00" level=info msg="Reference: https://github.com/maistra/istio/blob/maistra-2.1/pkg/servicemesh/federation/example/config-poc/install.sh"
time="2022-05-11T15:41:01-04:00" level=info msg="Running install_diff_cert.sh waiting 1 min..."
time="2022-05-11T15:41:01-04:00" level=info msg="Running command pushd ../testdata/examples/federation \\\n\t\t\t&& export MESH1_KUBECONFIG=~/.kube/config \\\n\t\t\t&& export MESH2_KUBECONFIG=~/.kube/config \\\n\t\t\t&& ./install_diff_cert.sh"
time="2022-05-11T15:42:49-04:00" level=info msg="Command output: \n~/Downloads/maistra-test-tool/testdata/examples/federation ~/Downloads/maistra-test-tool/tests\n\n##### Using the following kubeconfig files:\nmesh1: /home/noiro/.kube/config\nmesh2: /home/noiro/.kube/config\n\n##### Creating projects for mesh1\nNow using project \"mesh1-system\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\nNow using project \"mesh1-bookinfo\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\n\n##### Configure mesh1 smcp for using different root cert\nsecret/cacerts created\n\n##### Installing control plane for mesh1\nservicemeshcontrolplane.maistra.io/fed-export created\nservicemeshmemberroll.maistra.io/default created\nservicemeshcontrolplane.maistra.io/fed-export patched\n\n##### Creating projects for mesh2\nNow using project \"mesh2-system\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\nNow using project \"mesh2-bookinfo\" on server \"https://api.openupi.noiro.local:6443\".\n\nYou can add applications to this project with the 'new-app' command. For example, try:\n\n    oc new-app rails-postgresql-example\n\nto build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=k8s.gcr.io/serve_hostname\n\n\n##### Installing control plane for mesh2\nservicemeshcontrolplane.maistra.io/fed-import created\nservicemeshmemberroll.maistra.io/default created\nservicemeshcontrolplane.maistra.io/fed-import patched\n\n##### Waiting for mesh1 installation to complete\nservicemeshmemberroll.maistra.io/default condition met\n\n##### Waiting for mesh2 installation to complete\nservicemeshmemberroll.maistra.io/default condition met\n\n##### Retrieving root certificates\n\n##### Retrieving ingress addresses\nSingle cluster detected; using cluster-local service for ingress\nMESH1_ADDRESS=mesh2-ingress.mesh1-system.svc.cluster.local\nMESH2_ADDRESS=mesh1-ingress.mesh2-system.svc.cluster.local\n\n##### Enabling federation for mesh1\nconfigmap/mesh2-ca-root-cert created\nservicemeshpeer.federation.maistra.io/mesh2 created\nexportedserviceset.federation.maistra.io/mesh2 created\n\n##### Enabling federation for mesh2\nconfigmap/mesh1-ca-root-cert created\nservicemeshpeer.federation.maistra.io/mesh1 created\nimportedserviceset.federation.maistra.io/mesh1 created\n\n##### Installing bookinfo in mesh1\nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created\nserviceaccount/bookinfo-ratings-v2 created\ndeployment.apps/ratings-v2 created\nservice/mongodb created\ndeployment.apps/mongodb-v1 created\ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created\n\n##### Installing bookinfo in mesh2\nservice/details created\nserviceaccount/bookinfo-details created\ndeployment.apps/details-v1 created\nservice/ratings created\nserviceaccount/bookinfo-ratings created\ndeployment.apps/ratings-v1 created\nservice/reviews created\nserviceaccount/bookinfo-reviews created\ndeployment.apps/reviews-v1 created\ndeployment.apps/reviews-v2 created\ndeployment.apps/reviews-v3 created\nservice/productpage created\nserviceaccount/bookinfo-productpage created\ndeployment.apps/productpage-v1 created\nserviceaccount/bookinfo-ratings-v2 created\ndeployment.apps/ratings-v2 created\ngateway.networking.istio.io/bookinfo-gateway created\nvirtualservice.networking.istio.io/bookinfo created\ndestinationrule.networking.istio.io/productpage created\ndestinationrule.networking.istio.io/reviews created\ndestinationrule.networking.istio.io/ratings created\ndestinationrule.networking.istio.io/details created\nvirtualservice.networking.istio.io/reviews created\n\n##### Installing mongodb k8s Service for mesh2\nservice/mongodb created\n\n##### Installing VirtualServices for mesh2\nvirtualservice.networking.istio.io/mongodb-remote created\nvirtualservice.networking.istio.io/ratings-split created\n\n##### INSTALLATION COMPLETE"
time="2022-05-11T15:42:49-04:00" level=info msg="Waiting 2 minutes..."
time="2022-05-11T15:44:49-04:00" level=info msg="Verify mesh1 connection status"
time="2022-05-11T15:44:49-04:00" level=info msg="Running command oc -n mesh1-system get servicemeshpeer mesh2 -o json"
time="2022-05-11T15:44:49-04:00" level=info msg="Command output: \n{\n    \"apiVersion\": \"federation.maistra.io/v1\",\n    \"kind\": \"ServiceMeshPeer\",\n    \"metadata\": {\n        \"annotations\": {\n            \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"federation.maistra.io/v1\\\",\\\"kind\\\":\\\"ServiceMeshPeer\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"mesh2\\\",\\\"namespace\\\":\\\"mesh1-system\\\"},\\\"spec\\\":{\\\"gateways\\\":{\\\"egress\\\":{\\\"name\\\":\\\"mesh2-egress\\\"},\\\"ingress\\\":{\\\"name\\\":\\\"mesh2-ingress\\\"}},\\\"remote\\\":{\\\"addresses\\\":[\\\"mesh1-ingress.mesh2-system.svc.cluster.local\\\"],\\\"discoveryPort\\\":8188,\\\"servicePort\\\":15443},\\\"security\\\":{\\\"certificateChain\\\":{\\\"kind\\\":\\\"ConfigMap\\\",\\\"name\\\":\\\"mesh2-ca-root-cert\\\"},\\\"clientID\\\":\\\"mesh2.local/ns/mesh2-system/sa/mesh1-egress-service-account\\\",\\\"trustDomain\\\":\\\"mesh2.local\\\"}}}\\n\"\n        },\n        \"creationTimestamp\": \"2022-05-11T19:38:14Z\",\n        \"generation\": 1,\n        \"managedFields\": [\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:metadata\": {\n                        \"f:annotations\": {\n                            \".\": {},\n                            \"f:kubectl.kubernetes.io/last-applied-configuration\": {}\n                        }\n                    },\n                    \"f:spec\": {\n                        \".\": {},\n                        \"f:gateways\": {\n                            \".\": {},\n                            \"f:egress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:ingress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            }\n                        },\n                        \"f:remote\": {\n                            \".\": {},\n                            \"f:addresses\": {},\n                            \"f:discoveryPort\": {},\n                            \"f:servicePort\": {}\n                        },\n                        \"f:security\": {\n                            \".\": {},\n                            \"f:certificateChain\": {\n                                \".\": {},\n                                \"f:kind\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:clientID\": {},\n                            \"f:trustDomain\": {}\n                        }\n                    }\n                },\n                \"manager\": \"kubectl-client-side-apply\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:38:14Z\"\n            },\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:status\": {\n                        \".\": {},\n                        \"f:discoveryStatus\": {\n                            \".\": {},\n                            \"f:active\": {\n                                \".\": {},\n                                \"k:{\\\"pod\\\":\\\"istiod-fed-export-5fc5d68cd9-cnrgn\\\"}\": {\n                                    \".\": {},\n                                    \"f:pod\": {},\n                                    \"f:remotes\": {\n                                        \".\": {},\n                                        \"k:{\\\"source\\\":\\\"15.128.1.101\\\"}\": {\n                                            \".\": {},\n                                            \"f:connected\": {},\n                                            \"f:lastConnected\": {},\n                                            \"f:lastDisconnect\": {},\n                                            \"f:lastEvent\": {},\n                                            \"f:lastFullSync\": {},\n                                            \"f:source\": {}\n                                        }\n                                    },\n                                    \"f:watch\": {\n                                        \".\": {},\n                                        \"f:connected\": {},\n                                        \"f:lastConnected\": {},\n                                        \"f:lastDisconnectStatus\": {},\n                                        \"f:lastFullSync\": {}\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                \"manager\": \"pilot-discovery\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:39:11Z\"\n            }\n        ],\n        \"name\": \"mesh2\",\n        \"namespace\": \"mesh1-system\",\n        \"resourceVersion\": \"29587938\",\n        \"selfLink\": \"/apis/federation.maistra.io/v1/namespaces/mesh1-system/servicemeshpeers/mesh2\",\n        \"uid\": \"c63ea413-504b-4422-afed-aa8832076581\"\n    },\n    \"spec\": {\n        \"gateways\": {\n            \"egress\": {\n                \"name\": \"mesh2-egress\"\n            },\n            \"ingress\": {\n                \"name\": \"mesh2-ingress\"\n            }\n        },\n        \"remote\": {\n            \"addresses\": [\n                \"mesh1-ingress.mesh2-system.svc.cluster.local\"\n            ],\n            \"discoveryPort\": 8188,\n            \"servicePort\": 15443\n        },\n        \"security\": {\n            \"certificateChain\": {\n                \"kind\": \"ConfigMap\",\n                \"name\": \"mesh2-ca-root-cert\"\n            },\n            \"clientID\": \"mesh2.local/ns/mesh2-system/sa/mesh1-egress-service-account\",\n            \"trustDomain\": \"mesh2.local\"\n        }\n    },\n    \"status\": {\n        \"discoveryStatus\": {\n            \"active\": [\n                {\n                    \"pod\": \"istiod-fed-export-5fc5d68cd9-cnrgn\",\n                    \"remotes\": [\n                        {\n                            \"connected\": true,\n                            \"lastConnected\": \"2022-05-11T19:39:13Z\",\n                            \"lastDisconnect\": \"2022-05-11T19:39:11Z\",\n                            \"lastEvent\": \"2022-05-11T19:38:25Z\",\n                            \"lastFullSync\": \"2022-05-11T19:39:13Z\",\n                            \"source\": \"15.128.1.101\"\n                        }\n                    ],\n                    \"watch\": {\n                        \"connected\": true,\n                        \"lastConnected\": \"2022-05-11T19:37:49Z\",\n                        \"lastDisconnectStatus\": \"503 Service Unavailable\",\n                        \"lastFullSync\": \"2022-05-11T19:37:49Z\"\n                    }\n                }\n            ]\n        }\n    }\n}"
time="2022-05-11T15:44:49-04:00" level=info msg="mesh1-system connected true"
time="2022-05-11T15:44:49-04:00" level=info msg="Verify mesh2 connection status"
time="2022-05-11T15:44:49-04:00" level=info msg="Running command oc -n mesh2-system get servicemeshpeer mesh1 -o json"
time="2022-05-11T15:44:49-04:00" level=info msg="Command output: \n{\n    \"apiVersion\": \"federation.maistra.io/v1\",\n    \"kind\": \"ServiceMeshPeer\",\n    \"metadata\": {\n        \"annotations\": {\n            \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"federation.maistra.io/v1\\\",\\\"kind\\\":\\\"ServiceMeshPeer\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"mesh1\\\",\\\"namespace\\\":\\\"mesh2-system\\\"},\\\"spec\\\":{\\\"gateways\\\":{\\\"egress\\\":{\\\"name\\\":\\\"mesh1-egress\\\"},\\\"ingress\\\":{\\\"name\\\":\\\"mesh1-ingress\\\"}},\\\"remote\\\":{\\\"addresses\\\":[\\\"mesh2-ingress.mesh1-system.svc.cluster.local\\\"],\\\"discoveryPort\\\":8188,\\\"servicePort\\\":15443},\\\"security\\\":{\\\"certificateChain\\\":{\\\"kind\\\":\\\"ConfigMap\\\",\\\"name\\\":\\\"mesh1-ca-root-cert\\\"},\\\"clientID\\\":\\\"mesh1.local/ns/mesh1-system/sa/mesh2-egress-service-account\\\",\\\"trustDomain\\\":\\\"mesh1.local\\\"}}}\\n\"\n        },\n        \"creationTimestamp\": \"2022-05-11T19:37:48Z\",\n        \"generation\": 1,\n        \"managedFields\": [\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:metadata\": {\n                        \"f:annotations\": {\n                            \".\": {},\n                            \"f:kubectl.kubernetes.io/last-applied-configuration\": {}\n                        }\n                    },\n                    \"f:spec\": {\n                        \".\": {},\n                        \"f:gateways\": {\n                            \".\": {},\n                            \"f:egress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:ingress\": {\n                                \".\": {},\n                                \"f:name\": {}\n                            }\n                        },\n                        \"f:remote\": {\n                            \".\": {},\n                            \"f:addresses\": {},\n                            \"f:discoveryPort\": {},\n                            \"f:servicePort\": {}\n                        },\n                        \"f:security\": {\n                            \".\": {},\n                            \"f:certificateChain\": {\n                                \".\": {},\n                                \"f:kind\": {},\n                                \"f:name\": {}\n                            },\n                            \"f:clientID\": {},\n                            \"f:trustDomain\": {}\n                        }\n                    }\n                },\n                \"manager\": \"kubectl-client-side-apply\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:37:48Z\"\n            },\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:status\": {\n                        \".\": {},\n                        \"f:discoveryStatus\": {\n                            \".\": {},\n                            \"f:active\": {\n                                \".\": {},\n                                \"k:{\\\"pod\\\":\\\"istiod-fed-import-7b97dd6cc5-qz6ff\\\"}\": {\n                                    \".\": {},\n                                    \"f:pod\": {},\n                                    \"f:remotes\": {\n                                        \".\": {},\n                                        \"k:{\\\"source\\\":\\\"15.128.1.98\\\"}\": {\n                                            \".\": {},\n                                            \"f:connected\": {},\n                                            \"f:lastConnected\": {},\n                                            \"f:lastFullSync\": {},\n                                            \"f:source\": {}\n                                        }\n                                    },\n                                    \"f:watch\": {\n                                        \".\": {},\n                                        \"f:connected\": {},\n                                        \"f:lastConnected\": {},\n                                        \"f:lastDisconnect\": {},\n                                        \"f:lastDisconnectStatus\": {},\n                                        \"f:lastFullSync\": {}\n                                    }\n                                }\n                            }\n                        }\n                    }\n                },\n                \"manager\": \"pilot-discovery\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:39:41Z\"\n            }\n        ],\n        \"name\": \"mesh1\",\n        \"namespace\": \"mesh2-system\",\n        \"resourceVersion\": \"29587939\",\n        \"selfLink\": \"/apis/federation.maistra.io/v1/namespaces/mesh2-system/servicemeshpeers/mesh1\",\n        \"uid\": \"07f1b891-f6dd-436d-aef4-af518d89f52f\"\n    },\n    \"spec\": {\n        \"gateways\": {\n            \"egress\": {\n                \"name\": \"mesh1-egress\"\n            },\n            \"ingress\": {\n                \"name\": \"mesh1-ingress\"\n            }\n        },\n        \"remote\": {\n            \"addresses\": [\n                \"mesh2-ingress.mesh1-system.svc.cluster.local\"\n            ],\n            \"discoveryPort\": 8188,\n            \"servicePort\": 15443\n        },\n        \"security\": {\n            \"certificateChain\": {\n                \"kind\": \"ConfigMap\",\n                \"name\": \"mesh1-ca-root-cert\"\n            },\n            \"clientID\": \"mesh1.local/ns/mesh1-system/sa/mesh2-egress-service-account\",\n            \"trustDomain\": \"mesh1.local\"\n        }\n    },\n    \"status\": {\n        \"discoveryStatus\": {\n            \"active\": [\n                {\n                    \"pod\": \"istiod-fed-import-7b97dd6cc5-qz6ff\",\n                    \"remotes\": [\n                        {\n                            \"connected\": true,\n                            \"lastConnected\": \"2022-05-11T19:37:49Z\",\n                            \"lastFullSync\": \"2022-05-11T19:37:49Z\",\n                            \"source\": \"15.128.1.98\"\n                        }\n                    ],\n                    \"watch\": {\n                        \"connected\": true,\n                        \"lastConnected\": \"2022-05-11T19:39:13Z\",\n                        \"lastDisconnect\": \"2022-05-11T19:39:13Z\",\n                        \"lastDisconnectStatus\": \"200 OK\",\n                        \"lastFullSync\": \"2022-05-11T19:39:13Z\"\n                    }\n                }\n            ]\n        }\n    }\n}"
time="2022-05-11T15:44:49-04:00" level=info msg="mesh2-system connected true"
time="2022-05-11T15:44:49-04:00" level=info msg="Verify if services from mesh1 are imported into mesh2"
time="2022-05-11T15:44:49-04:00" level=info msg="Running command oc -n mesh2-system get importedservicesets mesh1 -o json"
time="2022-05-11T15:44:50-04:00" level=info msg="Command output: \n{\n    \"apiVersion\": \"federation.maistra.io/v1\",\n    \"kind\": \"ImportedServiceSet\",\n    \"metadata\": {\n        \"annotations\": {\n            \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"federation.maistra.io/v1\\\",\\\"kind\\\":\\\"ImportedServiceSet\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"mesh1\\\",\\\"namespace\\\":\\\"mesh2-system\\\"},\\\"spec\\\":{\\\"importRules\\\":[{\\\"importAsLocal\\\":false,\\\"nameSelector\\\":{\\\"alias\\\":{\\\"namespace\\\":\\\"mesh2-bookinfo\\\"},\\\"namespace\\\":\\\"bookinfo\\\"},\\\"type\\\":\\\"NameSelector\\\"}]}}\\n\"\n        },\n        \"creationTimestamp\": \"2022-05-11T19:37:49Z\",\n        \"generation\": 1,\n        \"managedFields\": [\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:metadata\": {\n                        \"f:annotations\": {\n                            \".\": {},\n                            \"f:kubectl.kubernetes.io/last-applied-configuration\": {}\n                        }\n                    },\n                    \"f:spec\": {\n                        \".\": {},\n                        \"f:importRules\": {}\n                    }\n                },\n                \"manager\": \"kubectl-client-side-apply\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:37:49Z\"\n            },\n            {\n                \"apiVersion\": \"federation.maistra.io/v1\",\n                \"fieldsType\": \"FieldsV1\",\n                \"fieldsV1\": {\n                    \"f:status\": {\n                        \".\": {},\n                        \"f:importedServices\": {\n                            \".\": {},\n                            \"k:{\\\"exportedName\\\":\\\"mongodb.bookinfo.svc.mesh2-exports.local\\\"}\": {\n                                \".\": {},\n                                \"f:exportedName\": {},\n                                \"f:localService\": {\n                                    \".\": {},\n                                    \"f:hostname\": {},\n                                    \"f:name\": {},\n                                    \"f:namespace\": {}\n                                }\n                            },\n                            \"k:{\\\"exportedName\\\":\\\"ratings.bookinfo.svc.mesh2-exports.local\\\"}\": {\n                                \".\": {},\n                                \"f:exportedName\": {},\n                                \"f:localService\": {\n                                    \".\": {},\n                                    \"f:hostname\": {},\n                                    \"f:name\": {},\n                                    \"f:namespace\": {}\n                                }\n                            }\n                        }\n                    }\n                },\n                \"manager\": \"pilot-discovery\",\n                \"operation\": \"Update\",\n                \"time\": \"2022-05-11T19:38:54Z\"\n            }\n        ],\n        \"name\": \"mesh1\",\n        \"namespace\": \"mesh2-system\",\n        \"resourceVersion\": \"29587550\",\n        \"selfLink\": \"/apis/federation.maistra.io/v1/namespaces/mesh2-system/importedservicesets/mesh1\",\n        \"uid\": \"f22bfaef-496b-4773-8afe-56a26f86f850\"\n    },\n    \"spec\": {\n        \"importRules\": [\n            {\n                \"importAsLocal\": false,\n                \"nameSelector\": {\n                    \"alias\": {\n                        \"namespace\": \"mesh2-bookinfo\"\n                    },\n                    \"namespace\": \"bookinfo\"\n                },\n                \"type\": \"NameSelector\"\n            }\n        ]\n    },\n    \"status\": {\n        \"importedServices\": [\n            {\n                \"exportedName\": \"mongodb.bookinfo.svc.mesh2-exports.local\",\n                \"localService\": {\n                    \"hostname\": \"mongodb.mesh2-bookinfo.svc.mesh1-imports.local\",\n                    \"name\": \"mongodb\",\n                    \"namespace\": \"mesh2-bookinfo\"\n                }\n            },\n            {\n                \"exportedName\": \"ratings.bookinfo.svc.mesh2-exports.local\",\n                \"localService\": {\n                    \"hostname\": \"ratings.mesh2-bookinfo.svc.mesh1-imports.local\",\n                    \"name\": \"ratings\",\n                    \"namespace\": \"mesh2-bookinfo\"\n                }\n            }\n        ]\n    }\n}"
time="2022-05-11T15:44:50-04:00" level=info msg="mesh2-system gets both mongodb and ratings services from mesh1"
time="2022-05-11T15:44:50-04:00" level=info msg="Cleanup ..."
time="2022-05-11T15:44:50-04:00" level=info msg="Running command kubectl -n mesh1-system delete secret cacerts"
time="2022-05-11T15:44:50-04:00" level=info msg="Command output: \nsecret \"cacerts\" deleted"
time="2022-05-11T15:44:50-04:00" level=info msg="Running command pushd ../testdata/examples/federation \\\n\t\t\t&& export MESH1_KUBECONFIG=~/.kube/config \\\n\t\t\t&& export MESH2_KUBECONFIG=~/.kube/config \\\n\t\t\t&& ./cleanup.sh"
time="2022-05-11T15:46:52-04:00" level=info msg="Command output: \n~/Downloads/maistra-test-tool/testdata/examples/federation ~/Downloads/maistra-test-tool/tests\n\n##### Using the following kubeconfig files:\nmesh1: /home/noiro/.kube/config\nmesh2: /home/noiro/.kube/config\nservicemeshpeer.federation.maistra.io \"mesh2\" deleted\nservicemeshpeer.federation.maistra.io \"mesh1\" deleted\nproject.project.openshift.io \"mesh1-system\" deleted\nproject.project.openshift.io \"mesh2-system\" deleted\nproject.project.openshift.io \"mesh1-bookinfo\" deleted\nproject.project.openshift.io \"mesh2-bookinfo\" deleted"
--- PASS: T32 (371.07s)
    --- PASS: T32/federation_single_cluster_different_cert_install (228.97s)
=== RUN   T33
time="2022-05-11T15:47:12-04:00" level=info msg="Running command kubectl apply -n bookinfo -f /tmp/kubeapply600327117.yaml"
time="2022-05-11T15:47:16-04:00" level=info msg="Command output: \nI0511 15:47:14.274803   19558 request.go:655] Throttling request took 1.151189459s, request: GET:https://api.openupi.noiro.local:6443/apis/security.istio.io/v1beta1?timeout=32s\ndeployment.apps/sleep-init created"
time="2022-05-11T15:47:16-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep-init -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:47:16-04:00" level=info msg="Command output: \nsleep-init-599f9df66b-jkhcp"
time="2022-05-11T15:47:16-04:00" level=info msg="app=sleep-init pod name: sleep-init-599f9df66b-jkhcp"
time="2022-05-11T15:47:16-04:00" level=info msg="Running command kubectl -n bookinfo get pods sleep-init-599f9df66b-jkhcp --no-headers"
time="2022-05-11T15:47:16-04:00" level=info msg="Command output: \nsleep-init-599f9df66b-jkhcp   0/2   Init:0/1   0     28s"
time="2022-05-11T15:47:16-04:00" level=info msg="sleep-init-599f9df66b-jkhcp in namespace bookinfo is not running: Init:0/1"
time="2022-05-11T15:47:46-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep-init -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:47:46-04:00" level=info msg="Command output: \nsleep-init-599f9df66b-jkhcp"
time="2022-05-11T15:47:46-04:00" level=info msg="app=sleep-init pod name: sleep-init-599f9df66b-jkhcp"
time="2022-05-11T15:47:46-04:00" level=info msg="Running command kubectl -n bookinfo get pods sleep-init-599f9df66b-jkhcp --no-headers"
time="2022-05-11T15:47:47-04:00" level=info msg="Command output: \nsleep-init-599f9df66b-jkhcp   2/2   Running   0     59s"
time="2022-05-11T15:47:47-04:00" level=info msg="Got the pod name=app=sleep-init running!"
time="2022-05-11T15:47:47-04:00" level=info msg="Running command kubectl -n bookinfo get pod -l app=sleep-init -o jsonpath='{.items[0].metadata.name}'"
time="2022-05-11T15:47:47-04:00" level=info msg="Command output: \nsleep-init-599f9df66b-jkhcp"
time="2022-05-11T15:47:47-04:00" level=info msg="app=sleep-init pod name: sleep-init-599f9df66b-jkhcp"
time="2022-05-11T15:47:47-04:00" level=info msg="Running command kubectl --namespace bookinfo logs sleep-init-599f9df66b-jkhcp -c init "
time="2022-05-11T15:47:47-04:00" level=info msg="Running command kubectl delete -n bookinfo -f /tmp/kubedelete841676488.yaml"
--- PASS: T33 (35.71s)
=== RUN   T34
=== RUN   T34/smcp_test_addons_3scale
time="2022-05-11T15:47:48-04:00" level=info msg="Enable 3scale in a CR. Expected validation error."
time="2022-05-11T15:47:48-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"addons\":{\"3scale\":{\"enabled\":true}}}}'"
time="2022-05-11T15:47:48-04:00" level=info msg="Command output: \nError from server (BadRequest): admission webhook \"smcp.validation.maistra.io\" denied the request: support for 3scale has been removed in v2.1; please remove the spec.addons.3scale section from the SMCP and configure the 3scale WebAssembly adapter using a ServiceMeshExtension resource"
time="2022-05-11T15:47:48-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:47:48-04:00" level=info msg="Expected validation error"
time="2022-05-11T15:47:48-04:00" level=info msg="Verify SMCP status"
time="2022-05-11T15:47:48-04:00" level=info msg="Running command oc get -n istio-system smcp/istio-system -o wide"
time="2022-05-11T15:47:48-04:00" level=info msg="Command output: \nNAME           READY   STATUS            PROFILES      VERSION   AGE    IMAGE REGISTRY\nistio-system   10/10   ComponentsReady   [\"default\"]   2.1.2     151m   "
time="2022-05-11T15:47:48-04:00" level=info msg="Running command kubectl patch -n istio-system smcp/istio-system --type merge -p '{\"spec\":{\"addons\":{\"3scale\":{\"enabled\":false}}}}'"
time="2022-05-11T15:47:48-04:00" level=info msg="Command output: \nError from server (BadRequest): admission webhook \"smcp.validation.maistra.io\" denied the request: support for 3scale has been removed in v2.1; please remove the spec.addons.3scale section from the SMCP and configure the 3scale WebAssembly adapter using a ServiceMeshExtension resource"
time="2022-05-11T15:47:48-04:00" level=info msg="Command error: exit status 1"
time="2022-05-11T15:47:48-04:00" level=info msg="Running command oc -n istio-system wait --for condition=Ready smcp/istio-system --timeout 180s"
time="2022-05-11T15:47:49-04:00" level=info msg="Command output: \nservicemeshcontrolplane.maistra.io/istio-system condition met"
--- PASS: T34 (1.19s)
    --- PASS: T34/smcp_test_addons_3scale (1.19s)
FAIL
exit status 1
FAIL	github.com/maistra/maistra-test-tool/tests	9613.886s
